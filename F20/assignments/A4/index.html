
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://cs533.ekstrandom.net/F20/assignments/A4/">
      
      <link rel="icon" href="../../logo.png">
      <meta name="generator" content="mkdocs-1.2.1, mkdocs-material-7.1.8">
    
    
      
        <title>Assignment 4 - Intro to Data Science</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.ca7ac06f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.f1a3b89f.min.css">
        
      
    
    
<link href="../../stylesheets/print.css" rel="stylesheet" media="print">

    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,400i,700%7C&display=fallback">
        <style>:root{--md-text-font-family:"Lato";--md-code-font-family:""}</style>
      
    
    
    
      <link rel="stylesheet" href="../../stylesheets/custom.css">
    
    
      


    
    

    <meta name="robots" content="noindex,noarchive">



  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#revision-log" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Intro to Data Science" class="md-header__button md-logo" aria-label="Intro to Data Science" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M208 352c-2.39 0-4.78.35-7.06 1.09C187.98 357.3 174.35 360 160 360c-14.35 0-27.98-2.7-40.95-6.91-2.28-.74-4.66-1.09-7.05-1.09C49.94 352-.33 402.48 0 464.62.14 490.88 21.73 512 48 512h224c26.27 0 47.86-21.12 48-47.38.33-62.14-49.94-112.62-112-112.62zm-48-32c53.02 0 96-42.98 96-96s-42.98-96-96-96-96 42.98-96 96 42.98 96 96 96zM592 0H208c-26.47 0-48 22.25-48 49.59V96c23.42 0 45.1 6.78 64 17.8V64h352v288h-64v-64H384v64h-76.24c19.1 16.69 33.12 38.73 39.69 64H592c26.47 0 48-22.25 48-49.59V49.59C640 22.25 618.47 0 592 0z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Intro to Data Science
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Assignment 4
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Course Info
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../syllabus/" class="md-tabs__link">
      Syllabus
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../schedule/" class="md-tabs__link">
      Schedule
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../resources/" class="md-tabs__link">
        Resources
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../content/" class="md-tabs__link">
        Content
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Assignments
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Intro to Data Science" class="md-nav__button md-logo" aria-label="Intro to Data Science" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M208 352c-2.39 0-4.78.35-7.06 1.09C187.98 357.3 174.35 360 160 360c-14.35 0-27.98-2.7-40.95-6.91-2.28-.74-4.66-1.09-7.05-1.09C49.94 352-.33 402.48 0 464.62.14 490.88 21.73 512 48 512h224c26.27 0 47.86-21.12 48-47.38.33-62.14-49.94-112.62-112-112.62zm-48-32c53.02 0 96-42.98 96-96s-42.98-96-96-96-96 42.98-96 96 42.98 96 96 96zM592 0H208c-26.47 0-48 22.25-48 49.59V96c23.42 0 45.1 6.78 64 17.8V64h352v288h-64v-64H384v64h-76.24c19.1 16.69 33.12 38.73 39.69 64H592c26.47 0 48-22.25 48-49.59V49.59C640 22.25 618.47 0 592 0z"/></svg>

    </a>
    Intro to Data Science
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Course Info
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../syllabus/" class="md-nav__link">
        Syllabus
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../schedule/" class="md-nav__link">
        Schedule
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Resources
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Resources" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/software/" class="md-nav__link">
        Software Installation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/onyx/" class="md-nav__link">
        Remotely Using Onyx
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/glossary/" class="md-nav__link">
        Glossary
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/notebook-checklist/" class="md-nav__link">
        Notebook Checklist
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/problems/" class="md-nav__link">
        Common Problems
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/probability/" class="md-nav__link">
        Notes on Probability
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/git-resources/" class="md-nav__link">
        Git Resources
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/tutorials/" class="md-nav__link">
        Tutorial Notebooks
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        Content
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Content" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Content
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../content/" class="md-nav__link">
        Course Content
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../content/week1/" class="md-nav__link">
        Week 1 — Question
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../content/week2/" class="md-nav__link">
        Week 2 — Description
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../content/week3/" class="md-nav__link">
        Week 3 — Presentation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../content/week4/" class="md-nav__link">
        Week 4 — Inference
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../content/week5/" class="md-nav__link">
        Week 5 — Filling In
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../content/week6/" class="md-nav__link">
        Week 6 — Two Variables
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../content/week7/" class="md-nav__link">
        Week 7 — Getting Data
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../content/week8/" class="md-nav__link">
        Week 8 — Regression
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../content/week9/" class="md-nav__link">
        Week 9 — Models & Prediction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../content/week10/" class="md-nav__link">
        Week 10 — Classification
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../content/week11/" class="md-nav__link">
        Week 11 — Evaluation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../content/week12/" class="md-nav__link">
        Week 12 — Text
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../content/week13/" class="md-nav__link">
        Week 13 — Unsupervised
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../content/week14/" class="md-nav__link">
        Week 14 — Workflow
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../content/week15/" class="md-nav__link">
        Week 15 — What Next?
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      <label class="md-nav__link" for="__nav_6">
        Assignments
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Assignments" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Assignments
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Index
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_2" type="checkbox" id="__nav_6_2" >
      
      <label class="md-nav__link" for="__nav_6_2">
        Assignment 0
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Assignment 0" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_2">
          <span class="md-nav__icon md-icon"></span>
          Assignment 0
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../A0/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../A0/A0-Notebook/" class="md-nav__link">
        CS 533 Assignment 0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../A0/A0-Solution.pdf" class="md-nav__link">
        PDF
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../A1/" class="md-nav__link">
        Assignment 1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../A2/" class="md-nav__link">
        Assignment 2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../A3/" class="md-nav__link">
        Assignment 3
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Assignment 4
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Assignment 4
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#revision-log" class="md-nav__link">
    Revision Log
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simulation" class="md-nav__link">
    Simulation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generating-random-numbers" class="md-nav__link">
    Generating Random Numbers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#warmup-correlation-10" class="md-nav__link">
    Warmup: Correlation (10%)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linear-regression-40" class="md-nav__link">
    Linear Regression (40%)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nonlinear-data-15" class="md-nav__link">
    Nonlinear Data (15%)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#non-normal-covariates-15" class="md-nav__link">
    Non-Normal Covariates (15%)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiple-regression-10" class="md-nav__link">
    Multiple Regression (10%)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#correlated-predictors-10" class="md-nav__link">
    Correlated Predictors (10%)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reflection-10" class="md-nav__link">
    Reflection (10%)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#expected-time" class="md-nav__link">
    Expected Time
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../A5/" class="md-nav__link">
        Assignment 5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../A6/" class="md-nav__link">
        Assignment 6
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../A7/" class="md-nav__link">
        Assignment 7
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#revision-log" class="md-nav__link">
    Revision Log
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simulation" class="md-nav__link">
    Simulation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generating-random-numbers" class="md-nav__link">
    Generating Random Numbers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#warmup-correlation-10" class="md-nav__link">
    Warmup: Correlation (10%)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linear-regression-40" class="md-nav__link">
    Linear Regression (40%)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nonlinear-data-15" class="md-nav__link">
    Nonlinear Data (15%)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#non-normal-covariates-15" class="md-nav__link">
    Non-Normal Covariates (15%)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiple-regression-10" class="md-nav__link">
    Multiple Regression (10%)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#correlated-predictors-10" class="md-nav__link">
    Correlated Predictors (10%)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reflection-10" class="md-nav__link">
    Reflection (10%)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#expected-time" class="md-nav__link">
    Expected Time
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              



                
                
                <h1 id="assignment-4">Assignment 4</h1>
<p>Assignment 4 has two purposes:</p>
<ul>
<li>To give you more experience with linear regression</li>
<li>To introduce simulation as a means of studying the behavior of statistical techniques</li>
</ul>
<p>This assignment is due <strong>October 25, 2020</strong> at the end of the day.</p>
<div class="admonition note notation">
<p class="admonition-title">Note</p>
<p>In this writeup, I will use capital letters (e.g. <span class="arithmatex">\(X\)</span>) for random variables, and lowercase variables (e.g. <span class="arithmatex">\(x\)</span>) for individual samples (or <em>draws</em>) from those random variables.</p>
</div>
<p>You will find the <a href="../../resources/probability/">probability notes</a> useful for understanding the derivations in this assignment.</p>
<h2 id="revision-log">Revision Log</h2>
<dl>
<dt>October 19, 2020</dt>
<dd>Added clarifying notes to Warmup.</dd>
</dl>
<h2 id="simulation">Simulation</h2>
<p>One common way to understand the behavior of statistical techniques is to use <em>simulation</em> (often called <em>Monte Carlo simulation</em>).
In a simulation, we use a psuedorandom number generator to make up data that follows particular patterns (or lack of patterns).
We call this data <em>synthetic data</em>.</p>
<p>We then apply a statistical technique, such as correlation coefficient or a linear regression, to the synthetic data, and see how closely its results match the parameters we put in to our simulation.
If the analysis reliably estimates the simulation's parameters, we say it <em>recovers</em> the parameters.
We can do this many times to estimate that reliability — we can run the simulation 1000 times, for example, and examine the <em>distribution</em> of the error of its parameter estimates to see if it is unbiased, and how broad the errors are.</p>
<p>This technique is commonly used in statistics research (that is, research about statistics itself, rather than research that uses statistics to study other topics) in order to examine the behavior of statistical methods.
By simulating samples of different sizes from a population with known parameters, we can compare the results of analyzing those samples with the actual values the statistical method is supposed to estimate.
Further, by mapping its behavior over a <em>range</em> of scenarios, we can gain insight into what a statistical technique is likely doing with the particular data we have in front of us.</p>
<p>This is distinct from bootstrapping.
In bootstrapping, we are resampling our sample to try to estimate the sampling distribution of a statistic with respect to the population our sample was drawn from; we have actual data, but do not know the actual population parameters.
In simulation, we know the population parameters, and do not have any actual data because we make it all up with the random number generator.</p>
<h2 id="generating-random-numbers">Generating Random Numbers</h2>
<p>NumPy's <a href="https://numpy.org/doc/stable/reference/random/generator.html"><code>Generator</code></a> class is the starting point for generating random numbers.
It has methods for generating numbers from a range of distributions.
For more sophisticated distributions, the various distributions in the <a href="https://docs.scipy.org/doc/scipy/reference/stats.html"><code>scipy.stats</code></a> also support random draws.</p>
<p>Random number generators have a <em>seed</em> that is the starting point for picking numbers.
Two identical generators with the same seed will produce the same sequence of values.</p>
<p>We can create a generator with <code>np.random.default_rng</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">20201014</span><span class="p">)</span>
</code></pre></div>
<p>In my class examples, I have been using the current date as my seed.
If you do not specify a seed, it will pick a fresh one every time you start the program; for reproducibility, it is advised to pick a seed for any particular analysis.
It's also useful to re-run the analysis with a different seed and double-check that none of the conclusions changed.</p>
<p>We can then use the random number generator to generate random numbers from various distributions.
It's important to note that <em>random</em> does not mean <em>uniform</em> — then uniform distribution is just one kind of random distribution.</p>
<p>For example, we can draw 100 samples from the standard normal distribution (<span class="arithmatex">\(\mu = 0\)</span>, <span class="arithmatex">\(\sigma = 1\)</span>):</p>
<div class="highlight"><pre><span></span><code><span class="n">xs</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div>
<h2 id="warmup-correlation-10">Warmup: Correlation (10%)</h2>
<p>If two variables are independent, their correlation should be zero, right?
We can simulate this by drawing two arrays of 100 standard normal variables each, and computing their correlation coefficient:</p>
<div class="highlight"><pre><span></span><code><span class="n">xs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="n">xs</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
</code></pre></div>
<div class="admonition note code meaning">
<p class="admonition-title">Note</p>
<p>This code takes <em>100 draws</em> (or samples) from the standard normal, twice (once for <code>xs</code> and again for <code>ys</code>).</p>
</div>
<p>Mathematically, we write this using <span class="arithmatex">\(\sim\)</span> as the operator “drawn from”:</p>
<div class="arithmatex">\[\begin{align*}
x &amp; \sim \mathrm{Normal}(0, 1) \\
y &amp; \sim \mathrm{Normal}(0, 1) \\
\end{align*}\]</div>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg></span> Run 1000 iterations of this simulation to compute 1000 correlation coefficients.  What is the mean and variance of these simulated coefficients? Plot their distribution.  Are the results what you expect for computing correlations of uncorrelated variables?</p>
<div class="admonition tip looping">
<p class="admonition-title">Tip</p>
<p>What you need to do for this is to run the code example above — that computes the correlation between two 100-item samples — one thousand times.
This will draw a total of 200,000 numbers (100 each for <code>x</code> and <code>y</code>, in each simulation iteration).</p>
</div>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg></span> Repeat the previous simulation, but using 1000 draws per iteration instead of 100.  How does this change the mean and variance of the resulting coefficients?</p>
<div class="admonition tip draw count">
<p class="admonition-title">Tip</p>
<p>Now you need to modify the code to draw 1000 normals for <code>x</code> and 1000 normals for <code>y</code> in each iteration.
Remember that the example above is drawing 100 normals for each variable.</p>
</div>
<p>Remember the <strong>covariance</strong> of two variables is defined as:</p>
<div class="arithmatex">\[\Cov(X, Y) = \E[(X - \E[X]) (Y - \E[Y])] = \frac{1}{n} \sum_{i} (x_i - \bar{x}) (y_i - \bar{y})\]</div>
<p>And the <strong>correlation</strong> is:</p>
<div class="arithmatex">\[r = \frac{\Cov(X, Y)}{\sigma_X \sigma_Y} = \frac{\Cov(X, Y)}{\sqrt{\Cov(X, X)} \sqrt{\Cov(Y, Y)}}\]</div>
<p>If we want to generate <em>correlated variables</em>, we can do so by combining two random variables to form a third:</p>
<div class="arithmatex">\[\begin{align*}
x &amp; \sim \mathrm{Normal}(0, 1) \\
y &amp; \sim \mathrm{Normal}(0, 1) \\
z &amp; = x + y
\end{align*}\]</div>
<p>We can draw them with:</p>
<div class="highlight"><pre><span></span><code><span class="n">xs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="n">zs</span> <span class="o">=</span> <span class="n">xs</span> <span class="o">+</span> <span class="n">ys</span>
</code></pre></div>
<p>With these variables, we have:</p>
<div class="arithmatex">\[\begin{align*}
\sigma_X &amp; = 1 \\
\E[X] &amp; = 0 \\
\sigma_{Y} &amp; = 1 \\
\E[Y] &amp; = 0 \\
\E[Z] &amp; = \E[X + Y] = \E[X] + \E[Y] = 0
\end{align*}\]</div>
<p>This last identity is from a property called <em>linearity of expectation</em>.
We can now determine the covariance between <span class="arithmatex">\(X\)</span> and <span class="arithmatex">\(Z\)</span>.
As a preliminary, since <span class="arithmatex">\(X\)</span> and <span class="arithmatex">\(Y\)</span> are independent, their covariance <span class="arithmatex">\(\Cov(X, Y) = 0\)</span>.
Further, their independence implies that <span class="arithmatex">\(\E[X Y] = \E[X]\E[Y]\)</span>, which from the equations above is <span class="arithmatex">\(0\)</span>.</p>
<p>With that:</p>
<div class="arithmatex">\[\begin{align*}
\Cov(X, Z) &amp; = \E[(X - \E[X])(Z - \E[Z])] \\
&amp; = \E[X (X + Y)] \\
&amp; = \E[X^2 + XY] \\
&amp; = \E[X^2] + \E[X Y] \\
&amp; = \E[X^2] \\
&amp; = \Var[X] &amp; \text{since $\E[X] = 0$} \\
&amp; = \sigma_X^2 = 1
\end{align*}\]</div>
<p>The correlation coefficient depends on <span class="arithmatex">\(\Cov(X,Z) = 1\)</span>, <span class="arithmatex">\(\Var(X) = 1\)</span>, and <span class="arithmatex">\(\Var(Z)\)</span>.
We can derive <span class="arithmatex">\(\Var(Y)\)</span> as follows:</p>
<div class="arithmatex">\[\begin{align*}
\Var(Z) &amp; = \E[(Z - \E[Z])^2] \\
&amp; = \E[Z^2] \\
&amp; = \E[(X + Y)^2] \\
&amp; = \E[X^2 + 2 X Y + Y^2] \\
&amp; = \E[X^2] + 2 \E[X Y] + \E[Y^2] \\
&amp; = \Var(X) + \Var(Y) &amp; \text{since both variables' means are 0} \\
&amp; = \sigma_X^2 + \sigma_{Y}^2 = 2
\end{align*}\]</div>
<p>Therefore we have <span class="arithmatex">\(\sigma_X = 1\)</span> (from its distribution), and <span class="arithmatex">\(\sigma_Z = \sqrt{2}\)</span>, and so the correlation</p>
<div class="arithmatex">\[r_{XZ} = \frac{\Cov(X,Z)}{\sigma_X \sigma_Z} = \frac{1}{1 \cdot \sqrt{2}} = 0.707\]</div>
<div class="admonition note">
<p class="admonition-title">Covariance</p>
<p>You can compute the covariance with the Pandas <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.cov.html"><code>.cov</code></a> method.
It's instructive to also plot that!</p>
</div>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg></span> Run 1000 iterations simulating these correlated variables to compute 1000 correlation coefficients (<code>xs.corr(zs)</code>).  Compute the mean and variance of these coefficients, and plot their distributions.  Does this match what we expect from the analytic results?  What happens when we compute correlations of 1000-element arrays in each iteration? What about 10000-element arrays?</p>
<h2 id="linear-regression-40">Linear Regression (40%)</h2>
<p>If we want to simulate a single-variable linear regression:</p>
<div class="arithmatex">\[y = \alpha + \beta x + \epsilon\]</div>
<p>there are four things we need to control:</p>
<ul>
<li>the distribution of <span class="arithmatex">\(x\)</span></li>
<li>the intercept <span class="arithmatex">\(\alpha\)</span></li>
<li>the slope <span class="arithmatex">\(\beta\)</span></li>
<li>the variance of errors <span class="arithmatex">\(\sigma_\epsilon^2\)</span></li>
</ul>
<p>Remember that the linear regression model assumes errors are i.i.d. normal, and the OLS model will result in a mean error of 0; thus we have <span class="arithmatex">\(\epsilon \sim \mathrm{Normal}(0, \sigma_\epsilon)\)</span>.
Sampling data for this model involves the following steps:</p>
<ol>
<li>Sample <span class="arithmatex">\(x\)</span></li>
<li>Sample <span class="arithmatex">\(\epsilon\)</span></li>
<li>Compute <span class="arithmatex">\(y = \alpha + \beta x + \epsilon\)</span></li>
</ol>
<p>Let's start with a very simple example: <span class="arithmatex">\(x\)</span> is drawn from a standard normal, <span class="arithmatex">\(\alpha=0\)</span>, <span class="arithmatex">\(\beta=1\)</span>, and <span class="arithmatex">\(\sigma_\epsilon^2 = 1\)</span>.</p>
<div class="highlight"><pre><span></span><code><span class="n">xs</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">errs</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">xs</span> <span class="o">+</span> <span class="n">errs</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">xs</span><span class="p">,</span>
    <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="n">ys</span>
<span class="p">})</span>
</code></pre></div>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg></span> Fit a linear model to this data, predicting <span class="arithmatex">\(Y\)</span> with <span class="arithmatex">\(X\)</span>. What are the intercept and slope? What is <span class="arithmatex">\(R^2\)</span>? Are these values what you expect?
Plot residuals vs. fitted and a Q-Q plot of residuals to check the model assumptions - do they hold?</p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg></span> Repeat the simulation 1000 times, fitting a linear model each time.  Show the mean, variance, and a distribution plot of the intercept, slope, and <span class="arithmatex">\(R^2\)</span>.</p>
<div class="admonition tip">
<p class="admonition-title">Extracting Parameters</p>
<p>The <a href="https://www.statsmodels.org/stable/generated/statsmodels.regression.linear_model.RegressionResults.html#statsmodels.regression.linear_model.RegressionResults"><code>RegressionResults</code></a> class returned by <code>.fit()</code> contains the model parameters. The <code>.params</code> field has the coefficients (including intercept), and <code>.rsquared</code> has the <span class="arithmatex">\(R^2\)</span> value:</p>
<div class="highlight"><pre><span></span><code><span class="n">fit</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span>
</code></pre></div>
</div>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg></span> Fit a model to data with <span class="arithmatex">\(\alpha=1\)</span> and <span class="arithmatex">\(\beta=4\)</span>. Are the resulting model parameters what you expect? How did <span class="arithmatex">\(R^2\)</span> change, and why? Do the linear model assumptions still hold? What are the distributions of the slope, intercept, and <span class="arithmatex">\(R^2\)</span> if you do this 1000 times?</p>
<h2 id="nonlinear-data-15">Nonlinear Data (15%)</h2>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg></span> Generate 1000 data points with the following distributions and formula:</p>
<div class="arithmatex">\[\begin{align*}
x &amp; \sim \mathrm{Normal}(0, 1) \\
\epsilon &amp; \sim \mathrm{Normal}(0, 5) \\
y &amp; = 10 + 5 e^x + \epsilon
\end{align*}\]</div>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg></span> Fit a linear model predicting <span class="arithmatex">\(y\)</span> with <span class="arithmatex">\(x\)</span>. How well does the model fit? Do the assumptions hold?</p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg></span> Draw a scatter plot of <span class="arithmatex">\(x\)</span> and <span class="arithmatex">\(y\)</span>.</p>
<div class="admonition tip">
<p class="admonition-title">Drawing Normals</p>
<p>You can draw from <span class="arithmatex">\(\mathrm{Normal}(0, 5)\)</span> either by using the <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.normal.html"><code>normal</code></a> method of <code>Generator</code>, or by drawing an array of standard normals and multiplying it by 5.</p>
</div>
<div class="admonition tip exponentiation">
<p class="admonition-title">Tip</p>
<p>The NumPy function <a href="https://numpy.org/doc/stable/reference/generated/numpy.exp.html"><code>np.exp</code></a> computes <span class="arithmatex">\(e^x\)</span>.</p>
</div>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg></span> Repeat with <span class="arithmatex">\(y = -2 + 3 x^3 + \epsilon\)</span></p>
<h2 id="non-normal-covariates-15">Non-Normal Covariates (15%)</h2>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg></span> Generate 1000 data points with the model:</p>
<div class="arithmatex">\[\begin{align*}
y &amp; = 10 + 0.1x + \epsilon \\
\epsilon &amp; \sim \mathrm{Normal}(0, 1) \\
x &amp; \sim \mathrm{Gamma}(2, 1)
\end{align*}\]</div>
<ul>
<li>Plot the distributions of <span class="arithmatex">\(X\)</span> and <span class="arithmatex">\(Y\)</span></li>
<li>Fit a linear model predicting <span class="arithmatex">\(y\)</span> with <span class="arithmatex">\(x\)</span></li>
<li>How well does this model fit? Do the assumptions hold?</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Gamma Distributions</p>
<p>You can draw 1000 from the <span class="arithmatex">\(Gamma(2, 1)\)</span> by:</p>
<div class="highlight"><pre><span></span><code><span class="n">rng</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</code></pre></div>
</div>
<h2 id="multiple-regression-10">Multiple Regression (10%)</h2>
<p>Now we're going to look at regression with two or more independent variables.</p>
<p>We will use the following data generating process:</p>
<div class="arithmatex">\[\begin{align*}
x_1 &amp; \sim \mathrm{Normal}(10, 2) \\
x_2 &amp; \sim \mathrm{Normal}(-2, 5) \\
\epsilon &amp; \sim \mathrm{Normal}(0, 1) \\
y &amp; = 1 + 0.5 x_1 + 3 x_2 + \epsilon
\end{align*}\]</div>
<div class="admonition tip scale-location distribution">
<p class="admonition-title">Tip</p>
<p>To draw from <span class="arithmatex">\(\mathrm{Normal}(\mu, \sigma)\)</span>, you can draw <code>xs</code> from a standard normal and compute <code>xs * σ + μ</code>.</p>
</div>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg></span> Fit a linear model <code>y ~ x1 + x2</code> on 1000 data points drawn from this model.  What are the intercept and coefficients from the model? Are they what you expect?
Check the model assumptions — do they hold?</p>
<div class="admonition note multivariate normals">
<p class="admonition-title">Note</p>
<p>You can draw both <span class="arithmatex">\(x_1\)</span> and <span class="arithmatex">\(x_2\)</span> simultaneously with:</p>
<div class="highlight"><pre><span></span><code><span class="n">xs</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]],</span> <span class="mi">100</span><span class="p">)</span>
<span class="c1"># turn into a data frame</span>
<span class="n">xdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">,</span> <span class="s1">&#39;X2&#39;</span><span class="p">])</span>
</code></pre></div>
<p>The multivariate normal distribution is parameterized by a list (or array) of means, and a positive symmetric covariance matrix defined as follows:</p>
<div class="arithmatex">\[\begin{bmatrix}
\Var(X_1) &amp; \Cov(X_1, X_2) \\
\Cov(X_2, X_1) &amp; \Var(X_2)
\end{bmatrix}\]</div>
<p>That is, the diagonals of them matrix are the variances of the individual variables, and the other cells are the covariances between pairs of variables.
The example code sets up the following matrix:</p>
<div class="arithmatex">\[\begin{bmatrix}
2 &amp; 0 \\
0 &amp; 5
\end{bmatrix}\]</div>
</div>
<h2 id="correlated-predictors-10">Correlated Predictors (10%)</h2>
<p>Now we're going to see what happens when we have correlated predictor variables.
Remember I said those were a problem?</p>
<p>We're going to use the <em>multivariate normal</em> from the hint in the previous part to draw <em>correlated</em> variables <span class="arithmatex">\(X_1\)</span> and <span class="arithmatex">\(X_2\)</span> to use as predictors.
We will use the following procedure:</p>
<ol>
<li>
<p>Draw 1000 samples of variables <span class="arithmatex">\(X_1\)</span> and <span class="arithmatex">\(X_2\)</span> from a normal with means <span class="arithmatex">\(\langle 1, 3 \rangle\)</span>, variances of 1, and a covariance <span class="arithmatex">\(\Cov(X_1, X_2) = 0.85\)</span>:</p>
<div class="highlight"><pre><span></span><code><span class="n">xs</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.85</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="mi">1000</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p>Draw <span class="arithmatex">\(\epsilon \sim \mathrm{Normal}(0, 2)\)</span></p>
</li>
<li>
<p>Compute <span class="arithmatex">\(y = 3 + 2 x_1 + 3 x_2 + \epsilon\)</span></p>
</li>
</ol>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg></span> Show a pairplot of our variables <span class="arithmatex">\(X_1\)</span>, <span class="arithmatex">\(X_2\)</span>, and <span class="arithmatex">\(Y\)</span>.  What do we see about their distributions and relationships?</p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg></span> Fit a linear regression for <code>y ~ x1 + x2</code>.  How well does it fit?  Do its assumptions hold?</p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg></span> Run this simulation (drawing 1000 variables and fitting a linear model) 100 times.  Show the mean, variance, and distribution plots of the estimated intercepts and coefficients (for <code>x1</code> and <code>x2</code>).</p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg></span> Repeat the repeated simulation for a variety of different covariances from 0 to 1 (including at least 0, 1, 0.9, and 0.99).
Create line plots (or a single plot with multiple colors) that show how the <em>variance</em> of the estimated regression parameters (intercept and <span class="arithmatex">\(x_1\)</span> and <span class="arithmatex">\(x_2\)</span> coefficients) change as you increase the correlation (covariance) between <span class="arithmatex">\(X_1\)</span> and <span class="arithmatex">\(X_2\)</span>.</p>
<h2 id="reflection-10">Reflection (10%)</h2>
<p>Write a couple of paragraphs about what you learned from this assignment.</p>
<h2 id="expected-time">Expected Time</h2>
<p>As in A3, I'm providing here some estimates of how long I expect each part might take you.</p>
<ol>
<li>Warmup: 1 hour</li>
<li>Linear Regression: 2 hours</li>
<li>Nonlinear Data: 30 minutes</li>
<li>Non-normal Covariates: 30 minutes</li>
<li>Multiple Regression: 1 hour</li>
<li>Correlated Predictors: 2 hours</li>
<li>Reflection: 1 hour</li>
</ol>
                
              

              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../A3/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Assignment 3" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Assignment 3
            </div>
          </div>
        </a>
      
      
        
        <a href="../A5/" class="md-footer__link md-footer__link--next" aria-label="Next: Assignment 5" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Assignment 5
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright ⓒ 2020 Michael D. Ekstrand. All rights reserved.
No part of this site may be copied or redistributed without the
written consent of the author.

          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.b0710199.min.js", "version": {"provider": "mike"}}</script>
    
<!-- <script src="../../js/katex.mjs" type="module" async></script> -->
<script src="../../js/frobnicate.js" async></script>
<script data-goatcounter="https://cs533.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>

    
      <script src="../../assets/javascripts/bundle.76f349be.min.js"></script>
      
        <script src="../../js/math-config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>