
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Assignment 4 &#8212; CS 533 Fall 2021</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/fonts.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/tabinsert.js"></script>
    <script src="../../_static/urlclean.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "mdekstrand/cs533-web");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"E": "\\mathrm{E}", "Field": "\\mathcal{F}", "P": "\\mathrm{P}", "Cov": "\\mathrm{Cov}", "Cor": "\\mathrm{Cor}", "Var": "\\mathrm{Var}", "log": "\\operatorname{log}", "Odds": "\\operatorname{Odds}", "OR": "\\operatorname{OR}", "IND": "\\mathbb{I}", "Reals": "\\mathbb{R}"}}, "HTML-CSS": {"fonts": ["TeX"]}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../_static/logo.png"/>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="copyright" title="Copyright" href="../../copyright/" />
    <link rel="next" title="Assignment 5" href="../A5/" />
    <link rel="prev" title="Assignment 3" href="../A3/" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../">
      
      
      
      <h1 class="site-logo" id="site-title">CS 533 Fall 2021</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search/" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../">
   CS 533 Homepage
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course Info
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../syllabus/">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../schedule/">
   Schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../glossary/">
   Glossary
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Content
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../week0/">
   Week 0 — Pre-Class Welcome
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../week1/">
   Week 1 — Questions (8/23–27)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../week1/DemoNotebook/">
     Demo Notebook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../week1/1-7-types-operations/">
     Data Types and Operations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../week2/">
   Week 2 — Description (8/30–9/3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../week2/2-2-PandasBasics/">
     Introducing Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../week2/2-4-AggregatesAndGroups/">
     Aggregates and Groups
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../week2/2-6-DescribingDistributions/">
     Describing Distributions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../week3/">
   Week 3 — Presentation (9/6–10)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../week3/3-6-ChartsFromTheGroundUp/">
     Drawing Charts
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../week4/">
   Week 4 — Inference (9/13–17)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../week5/">
   Week 5 — Filling In (9/20–24)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../week6/">
   Week 6 — Two Variables (Sep. 27–Oct. 1)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../week7/">
   Week 7 — Getting Data (Oct. 4–8)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../week8/">
   Week 8 — Regression (Oct. 11–15)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../week9/">
   Week 9 — Models &amp; Prediction (Oct. 18–22)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../week10/">
   Week 10 — Classification (10/25–29)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../week11/">
   Week 11 — More Modeling (11/1–5)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../week12/">
   Week 12 — Text (11/8–12)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../week13/">
   Week 13 — Unsupervised (11/15–19)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../week14/">
   Week 14 — Workflow (11/29–12/3)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../week15/">
   Week 15 — What Next? (12/6–10)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../">
   Rubric
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../A0/">
   Assignment 0
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../A0/A0-Notebook/">
     CS 533 Assignment 0
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../A1/">
   Assignment 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../A2/">
   Assignment 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../A3/">
   Assignment 3
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Assignment 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../A5/">
   Assignment 5
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../A6/">
   Assignment 6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../A7/">
   Assignment 7
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../resources/software/">
   Software and Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resources/documentation/">
   Documentation &amp; Reading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resources/data/">
   Data Sets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resources/notebook-checklist/">
   Notebook Checklist &amp; Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resources/probability/">
   Notes on Probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resources/problems/">
   Common Problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resources/onyx/">
   Remotely Using Onyx
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resources/git-resources/">
   Git Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resources/environments/">
   Software Environments
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../resources/tutorials/">
   Tutorials
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/AdvancedPipeline/">
     Advanced Pipeline Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/BooleanSeries/">
     Tricks with Boolean Series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/BuildingData/">
     Building Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/ChartFinishingTouches/">
     Finishing Touches
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/Charting/">
     Drawing Charts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/ClusteringExample/">
     Clustering Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/Correlation/">
     Correlation and Basic Linear Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/CriticScores/">
     Charting Movie Scores
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/Distributions/">
     Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/EmpiricalProbabilities/">
     Empirical Probabilities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/FetchCHIPapers/">
     Bibliography Fetch
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/FunWithNumbers/">
     Fun with Numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/Functions/">
     Writing Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/Indexing/">
     Indexing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/LogitRegressionDemo/">
     Logistic Regression Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/MLTimeSeries/">
     MovieLens Time Series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/MinimizeRegression/">
     Rebuilding Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/MissingData/">
     Missing Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/MovieDecomp/">
     Movie Matrix Decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/OneSample/">
     One Sample
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/OverfittingSimulation/">
     Overfitting Simulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/PCADemo/">
     PCA Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/PenguinSamples/">
     Sampling and Testing the Penguins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/Regressions/">
     Regressions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/Reshaping/">
     Reshaping Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/SamplingDists/">
     Sampling Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/SciKitLogistic/">
     SciKit Logistic Regression Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/SciKitPipeline/">
     SciKit Pipeline and Transform Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/SciKitRegression/">
     SciKit-Learn Linear Regression Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/SciKitTransform/">
     SciKit Transformations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/Selection/">
     Selecting Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/Sessions/">
     Sessionization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/SpamFilter/">
     Spam Detector Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/TuningExample/">
     Tuning Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/tutorials/UsingTheCensus/">
     Using Census Data
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Site Details
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../copyright/">
   Copyright and License
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/assignments/A4/index.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/mdekstrand/cs533-web"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/mdekstrand/cs533-web/issues/new?title=Issue%20on%20page%20%2Fassignments/A4/index.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/mdekstrand/cs533-web/edit/main/assignments/A4/index.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#revision-log">
   Revision Log
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulation">
   Simulation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generating-random-numbers">
   Generating Random Numbers
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#warmup-correlation-10">
   Warmup: Correlation (10%)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-regression-35">
   Linear Regression (35%)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nonlinear-data-15">
   Nonlinear Data (15%)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#non-normal-covariates-15">
   Non-Normal Covariates (15%)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-regression-10">
   Multiple Regression (10%)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#correlated-predictors-10">
   Correlated Predictors (10%)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reflection-5">
   Reflection (5%)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#expected-time">
   Expected Time
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="assignment-4">
<h1>Assignment 4<a class="headerlink" href="#assignment-4" title="Permalink to this headline">¶</a></h1>
<p>Assignment 4 has two purposes:</p>
<ul class="simple">
<li><p>To give you more experience with linear regression</p></li>
<li><p>To introduce simulation as a means of studying the behavior of statistical techniques</p></li>
</ul>
<p>This assignment is due <strong>October 24, 2020</strong> at the end of the day.  Upload your <code class="docutils literal notranslate"><span class="pre">.ipynb</span></code> and <code class="docutils literal notranslate"><span class="pre">.pdf</span></code> files to Canvas.</p>
<div class="tip admonition">
<p class="admonition-title">Notation</p>
<p>In this writeup, I will use capital letters (e.g. <span class="math notranslate nohighlight">\(X\)</span>) for random variables, and lowercase variables (e.g. <span class="math notranslate nohighlight">\(x\)</span>) for individual samples (or <em>draws</em>) from those random variables.</p>
</div>
<p>You will find the <a class="reference internal" href="../../resources/probability/"><span class="doc std std-doc">probability notes</span></a> useful for understanding the
derivations in this assignment, and the various tutorial notebooks will be helpful for writing the
code.</p>
<div class="tip admonition">
<p class="admonition-title">Reading</p>
<p><strong>Read the assignment very carefully.</strong>
There are quite a few moving parts, and you need to carefully follow the instructions in order to complete
it successfully.</p>
<p>For many of the tasks I ask several questions. You need to answer these questions in your assignment writeup.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Repeating</p>
<p>Several of the tasks have you <em>repeat a simulation</em> so that you can see the distribution (mean, variance, perhaps histogram) of
a computational result across many repetitions of an experiment.  The general structure of this code looks like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialize data structures for storing repitition outcomes</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ITER_COUNT</span><span class="p">):</span>
    <span class="c1"># draw the synthetic data</span>
    <span class="c1"># fit the model / compute the results</span>
    <span class="c1"># extract parameters / statistics from model &amp; store in data structures</span>
</pre></div>
</div>
<p>You can use either Python lists or NumPy arrays for storing your results from repetitions.</p>
</div>
<div class="section" id="revision-log">
<h2>Revision Log<a class="headerlink" href="#revision-log" title="Permalink to this headline">¶</a></h2>
<dl class="simple myst">
<dt>Oct. 12, 2021</dt><dd><p>Clarified the <a class="reference internal" href="#a4-correlated"><span class="std std-ref">last task</span></a> of the <a class="reference internal" href="#a4-warmup"><span class="std std-ref">warmup section</span></a> to document it needs 100-, 1000-, and 10000-draw simulations.</p>
</dd>
</dl>
</div>
<div class="section" id="simulation">
<h2>Simulation<a class="headerlink" href="#simulation" title="Permalink to this headline">¶</a></h2>
<p>One common way to understand the behavior of statistical techniques is to use <em>simulation</em> (often called <em>Monte Carlo simulation</em>).
In a simulation, we use a psuedorandom number generator to make up data that follows particular patterns (or lack of patterns).
We call this data <em>synthetic data</em>.</p>
<p>We then apply a statistical technique, such as correlation coefficient or a linear regression, to the synthetic data, and see how closely its results match the parameters we put in to our simulation.
If the analysis reliably estimates the simulation’s parameters, we say it <em>recovers</em> the parameters.
We can do this many times to estimate that reliability — we can run the simulation 1000 times, for example, and examine the <em>distribution</em> of the error of its parameter estimates to see if it is unbiased, and how broad the errors are.</p>
<p>This technique is commonly used in statistics research (that is, research about statistics itself, rather than research that uses statistics to study other topics) in order to examine the behavior of statistical methods.
By simulating samples of different sizes from a population with known parameters, we can compare the results of analyzing those samples with the actual values the statistical method is supposed to estimate.
Further, by mapping its behavior over a <em>range</em> of scenarios, we can gain insight into what a statistical technique is likely doing with the particular data we have in front of us.</p>
<p>This is distinct from bootstrapping.
In bootstrapping, we are resampling our sample to try to estimate the sampling distribution of a statistic with respect to the population our sample was drawn from; we have actual data, but do not know the actual population parameters.
In simulation, we know the population parameters, and do not have any actual data because we make it all up with the random number generator.</p>
</div>
<div class="section" id="generating-random-numbers">
<h2>Generating Random Numbers<a class="headerlink" href="#generating-random-numbers" title="Permalink to this headline">¶</a></h2>
<p>NumPy’s <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a> class is the starting point for generating random numbers.
It has methods for generating numbers from a range of distributions.
For more sophisticated distributions, the various distributions in the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a> also support random draws.</p>
<p>Random number generators have a <em>seed</em> that is the starting point for picking numbers.
Two identical generators with the same seed will produce the same sequence of values.</p>
<p>We can create a generator with <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.default_rng" title="(in NumPy v1.23)"><code class="xref py py-func docutils literal notranslate"><span class="pre">np.random.default_rng</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">20201014</span><span class="p">)</span>
</pre></div>
</div>
<p>This will return a <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.random.Generator</span></code></a>, just like <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.default_rng" title="(in NumPy v1.23)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.random.default_rng()</span></code></a>.</p>
<p>In my class examples, I have been using the current date as my seed.
If you do not specify a seed, it will pick a fresh one every time you start the program; for reproducibility, it is advised to pick a seed for any particular analysis.
It’s also useful to re-run the analysis with a different seed and double-check that none of the conclusions changed.</p>
<p>We can then use the random number generator to generate random numbers from various distributions.
It’s important to note that <em>random</em> does not mean <em>uniform</em> — then uniform distribution is just one kind of random distribution.</p>
<p>For example, we can draw 100 samples from the standard normal distribution (<span class="math notranslate nohighlight">\(\mu = 0\)</span>, <span class="math notranslate nohighlight">\(\sigma = 1\)</span>)
using <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.standard_normal.html#numpy.random.Generator.standard_normal" title="(in NumPy v1.23)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">standard_normal()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<div class="note dropdown admonition">
<p class="admonition-title">SeedBank</p>
<p>If you wish to use SeedBank to manage your RNG seeds, you can do:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">seedbank</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="mi">20201014</span><span class="p">)</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">seedbank</span><span class="o">.</span><span class="n">numpy_rng</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="warmup-correlation-10">
<span id="a4-warmup"></span><h2>Warmup: Correlation (10%)<a class="headerlink" href="#warmup-correlation-10" title="Permalink to this headline">¶</a></h2>
<p>If two variables are independent, their correlation should be zero, right?
We can simulate this by drawing two arrays of 100 standard normal variables each, and computing their correlation coefficient:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="n">xs</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
</pre></div>
</div>
<div class="tip admonition">
<p class="admonition-title">Code Meaning</p>
<p>This code takes <em>100 draws</em> (or samples) from the standard normal, twice (once for <code class="docutils literal notranslate"><span class="pre">xs</span></code> and again for <code class="docutils literal notranslate"><span class="pre">ys</span></code>).</p>
</div>
<p>Mathematically, we write this using <span class="math notranslate nohighlight">\(\sim\)</span> as the operator “drawn from”:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
x &amp; \sim \mathrm{Normal}(0, 1) \\
y &amp; \sim \mathrm{Normal}(0, 1) \\
\end{align*}\end{split}\]</div>
<p>✅ Run 1000 iterations of this simulation to compute 1000 correlation coefficients.  What is the mean and variance of these simulated coefficients? Plot their distribution.  Are the results what you expect for computing correlations of uncorrelated variables?</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>What you need to do for this is to run the code example above — that computes the correlation between two 100-item samples — one thousand times.
This will draw a total of 200,000 numbers (100 each for <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>, in each simulation iteration).</p>
</div>
<p>✅ Repeat the previous simulation, but using 1000 draws per iteration instead of 100.  How does this change the mean and variance of the resulting coefficients?</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Now you need to modify the code to draw 1000 normals for <code class="docutils literal notranslate"><span class="pre">x</span></code> and 1000 normals for <code class="docutils literal notranslate"><span class="pre">y</span></code> in each iteration.
Remember that the example above is drawing 100 normals for each variable.</p>
</div>
<p id="a4-covariance">Remember the <strong><a class="reference internal" href="../../glossary/#term-covariance"><span class="xref std std-term">covariance</span></a></strong> of two variables is defined as:</p>
<div class="math notranslate nohighlight">
\[\Cov(X, Y) = \E[(X - \E[X]) (Y - \E[Y])] = \frac{1}{n} \sum_{i} (x_i - \bar{x}) (y_i - \bar{y})\]</div>
<p>And the <strong><a class="reference internal" href="../../glossary/#term-correlation"><span class="xref std std-term">correlation</span></a></strong> is:</p>
<div class="math notranslate nohighlight">
\[r = \frac{\Cov(X, Y)}{\sigma_X \sigma_Y} = \frac{\Cov(X, Y)}{\sqrt{\Cov(X, X)} \sqrt{\Cov(Y, Y)}}\]</div>
<p>If we want to generate <em>correlated variables</em>, we can do so by combining two random variables to form a third:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
x &amp; \sim \mathrm{Normal}(0, 1) \\
y &amp; \sim \mathrm{Normal}(0, 1) \\
z &amp; = x + y
\end{align*}\end{split}\]</div>
<p>We can draw them with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="n">zs</span> <span class="o">=</span> <span class="n">xs</span> <span class="o">+</span> <span class="n">ys</span>
</pre></div>
</div>
<p>With these variables, we have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\sigma_X &amp; = 1 \\
\E[X] &amp; = 0 \\
\sigma_{Y} &amp; = 1 \\
\E[Y] &amp; = 0 \\
\E[Z] &amp; = \E[X + Y] = \E[X] + \E[Y] = 0
\end{align*}\end{split}\]</div>
<p>This last identity is from a property called <em>linearity of expectation</em>.
We can now determine the covariance between <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span>.
As a preliminary, since <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> are independent, their covariance <span class="math notranslate nohighlight">\(\Cov(X, Y) = 0\)</span>.
Further, their independence implies that <span class="math notranslate nohighlight">\(\E[X Y] = \E[X]\E[Y]\)</span>, which from the equations above is <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>With that:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\Cov(X, Z) &amp; = \E[(X - \E[X])(Z - \E[Z])] \\
&amp; = \E[X (X + Y)] &amp; \text{since $\E[X] = \E[Z] = 0$} \\
&amp; = \E[X^2 + XY] \\
&amp; = \E[X^2] + \E[X Y] \\
&amp; = \E[X^2] \\
&amp; = \Var[X] &amp; \text{since $\E[X] = 0$} \\
&amp; = \sigma_X^2 = 1
\end{align*}\end{split}\]</div>
<p>The correlation coefficient depends on <span class="math notranslate nohighlight">\(\Cov(X,Z) = 1\)</span>, <span class="math notranslate nohighlight">\(\Var(X) = 1\)</span>, and <span class="math notranslate nohighlight">\(\Var(Z)\)</span>.
We can derive <span class="math notranslate nohighlight">\(\Var(Z))\)</span> as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\Var(Z) &amp; = \E[(Z - \E[Z])^2] \\
&amp; = \E[Z^2] &amp; \text{since $\E[Z] = 0$} \\
&amp; = \E[(X + Y)^2] \\
&amp; = \E[X^2 + 2 X Y + Y^2] \\
&amp; = \E[X^2] + 2 \E[X Y] + \E[Y^2] &amp; \text{by linearity of expectation} \\
&amp; = \Var(X) + \Var(Y) &amp; \text{since both variables' means are 0} \\
&amp; = \sigma_X^2 + \sigma_{Y}^2 = 2
\end{align*}\end{split}\]</div>
<p>Therefore we have <span class="math notranslate nohighlight">\(\sigma_X = 1\)</span> (from its distribution), and <span class="math notranslate nohighlight">\(\sigma_Z = \sqrt{2}\)</span>, and so the correlation</p>
<div class="math notranslate nohighlight">
\[r_{XZ} = \frac{\Cov(X,Z)}{\sigma_X \sigma_Z} = \frac{1}{1 \cdot \sqrt{2}} = 0.707\]</div>
<div class="note admonition">
<p class="admonition-title">Covariance</p>
<p>You can compute the covariance with the <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.cov.html#pandas.Series.cov" title="(in pandas v1.4.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.cov()</span></code></a> method.
It’s instructive to also plot that!</p>
</div>
<p id="a4-correlated">✅ Run 1000 iterations simulating these correlated variables to compute 1000 correlation coefficients (<code class="docutils literal notranslate"><span class="pre">xs.corr(zs)</span></code>), with 100 draws of each variable per iteration.  Compute the mean and variance of these coefficients, and plot their distributions.  Does this match what we expect from the analytic results?  What happens when we compute correlations of 1000 draws in each iteration? What about 10000 draws?</p>
</div>
<div class="section" id="linear-regression-35">
<h2>Linear Regression (35%)<a class="headerlink" href="#linear-regression-35" title="Permalink to this headline">¶</a></h2>
<p>If we want to simulate a single-variable linear regression:</p>
<div class="math notranslate nohighlight">
\[y = \alpha + \beta x + \epsilon\]</div>
<p>there are four things we need to control:</p>
<ul class="simple">
<li><p>the distribution of <span class="math notranslate nohighlight">\(x\)</span></p></li>
<li><p>the intercept <span class="math notranslate nohighlight">\(\alpha\)</span></p></li>
<li><p>the slope <span class="math notranslate nohighlight">\(\beta\)</span></p></li>
<li><p>the variance of errors <span class="math notranslate nohighlight">\(\sigma_\epsilon^2\)</span></p></li>
</ul>
<p>Remember that the linear regression model assumes errors are i.i.d. normal, and the OLS model will result in a mean error of 0; thus we have <span class="math notranslate nohighlight">\(\epsilon \sim \mathrm{Normal}(0, \sigma_\epsilon)\)</span>.
Sampling data for this model involves the following steps:</p>
<ol class="simple">
<li><p>Sample <span class="math notranslate nohighlight">\(x\)</span></p></li>
<li><p>Sample <span class="math notranslate nohighlight">\(\epsilon\)</span></p></li>
<li><p>Compute <span class="math notranslate nohighlight">\(y = \alpha + \beta x + \epsilon\)</span></p></li>
</ol>
<p>Let’s start with a very simple example: <span class="math notranslate nohighlight">\(x\)</span> is drawn from a standard normal, <span class="math notranslate nohighlight">\(\alpha=0\)</span>, <span class="math notranslate nohighlight">\(\beta=1\)</span>, and <span class="math notranslate nohighlight">\(\sigma_\epsilon^2 = 1\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">errs</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">xs</span> <span class="o">+</span> <span class="n">errs</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">xs</span><span class="p">,</span>
    <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="n">ys</span>
<span class="p">})</span>
</pre></div>
</div>
<p>✅ Fit a linear model to this data, predicting <span class="math notranslate nohighlight">\(Y\)</span> with <span class="math notranslate nohighlight">\(X\)</span>. What are the intercept and slope? What is <span class="math notranslate nohighlight">\(R^2\)</span>? Are these values what you expect?
Plot residuals vs. fitted and a Q-Q plot of residuals to check the model assumptions - do they hold?</p>
<p>✅ Repeat the simulation 1000 times, fitting a linear model each time.  Show the mean, variance, and a distribution plot of the intercept, slope, and <span class="math notranslate nohighlight">\(R^2\)</span> from these simulations.</p>
<div class="tip admonition">
<p class="admonition-title">Extracting Parameters</p>
<p>The <a class="reference external" href="https://www.statsmodels.org/stable/generated/statsmodels.regression.linear_model.RegressionResults.html#statsmodels.regression.linear_model.RegressionResults" title="(in statsmodels vv0.13.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">RegressionResults</span></code></a> class returned by
<a class="reference external" href="https://www.statsmodels.org/stable/generated/statsmodels.regression.linear_model.OLS.fit.html#statsmodels.regression.linear_model.OLS.fit" title="(in statsmodels vv0.13.2)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OLS.fit()</span></code></a> contains the model parameters. The <code class="docutils literal notranslate"><span class="pre">.params</span></code> field has the coefficients (including intercept), and <code class="docutils literal notranslate"><span class="pre">.rsquared</span></code> has the <span class="math notranslate nohighlight">\(R^2\)</span> value:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fit</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>✅ Fit a model to data with <span class="math notranslate nohighlight">\(\alpha=1\)</span> and <span class="math notranslate nohighlight">\(\beta=4\)</span>. Are the resulting model parameters what you expect? How did <span class="math notranslate nohighlight">\(R^2\)</span> change, and why? Do the linear model assumptions still hold? What are the distributions of the slope, intercept, and <span class="math notranslate nohighlight">\(R^2\)</span> if you do this 1000 times?</p>
</div>
<div class="section" id="nonlinear-data-15">
<h2>Nonlinear Data (15%)<a class="headerlink" href="#nonlinear-data-15" title="Permalink to this headline">¶</a></h2>
<p>✅ Generate 1000 data points with the following distributions and formula:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
x &amp; \sim \mathrm{Normal}(0, 1) \\
\epsilon &amp; \sim \mathrm{Normal}(0, 5) \\
y &amp; = 10 + 5 e^x + \epsilon
\end{align*}\end{split}\]</div>
<p>✅ Fit a linear model predicting <span class="math notranslate nohighlight">\(y\)</span> with <span class="math notranslate nohighlight">\(x\)</span>. How well does the model fit? Do the assumptions seem to hold?</p>
<p>✅ Draw a scatter plot of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>.</p>
<div class="tip admonition">
<p class="admonition-title">Drawing Normals</p>
<p>You can draw from <span class="math notranslate nohighlight">\(\mathrm{Normal}(0, 5)\)</span> either by using tbe <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.normal.html#numpy.random.Generator.normal" title="(in NumPy v1.23)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">normal()</span></code></a>
method of <code class="docutils literal notranslate"><span class="pre">Generator</span></code>, or by drawing an array of standard normals and multiplying it by 5.
This is because the normal distribution is in the <em>scale-location family</em> of distributions.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Exponentiation</p>
<p>The NumPy function <code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.exp()</span></code> computes <span class="math notranslate nohighlight">\(e^x\)</span>.</p>
</div>
<p>✅ Repeat with <span class="math notranslate nohighlight">\(y = -2 + 3 x^3 + \epsilon\)</span></p>
</div>
<div class="section" id="non-normal-covariates-15">
<h2>Non-Normal Covariates (15%)<a class="headerlink" href="#non-normal-covariates-15" title="Permalink to this headline">¶</a></h2>
<p>✅ Generate 1000 data points with the model:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
y &amp; = 10 + 0.3x + \epsilon \\
\epsilon &amp; \sim \mathrm{Normal}(0, 1) \\
x &amp; \sim \mathrm{Gamma}(2, 1)
\end{align*}\end{split}\]</div>
<ul class="simple">
<li><p>Plot the distributions of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span></p></li>
<li><p>Fit a linear model predicting <span class="math notranslate nohighlight">\(y\)</span> with <span class="math notranslate nohighlight">\(x\)</span></p></li>
<li><p>How well does this model fit? How much of the variance does it explain? Do the assumptions seem to hold?  Does the linear regression seem appropriate to the data?</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Gamma Distributions</p>
<p>You can draw 1000 samples from the <span class="math notranslate nohighlight">\(\mathrm{Gamma}(2, 1)\)</span> distribution with <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.gamma.html#numpy.random.Generator.gamma" title="(in NumPy v1.23)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">numpy.random.Generator.gamma()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="multiple-regression-10">
<h2>Multiple Regression (10%)<a class="headerlink" href="#multiple-regression-10" title="Permalink to this headline">¶</a></h2>
<p>Now we’re going to look at regression with two or more independent variables.</p>
<p>We will use the following data generating process:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
x_1 &amp; \sim \mathrm{Normal}(10, 2) \\
x_2 &amp; \sim \mathrm{Normal}(-2, 5) \\
\epsilon &amp; \sim \mathrm{Normal}(0, 1) \\
y &amp; = 1 + 0.5 x_1 + 3 x_2 + \epsilon
\end{align*}\end{split}\]</div>
<div class="tip admonition">
<p class="admonition-title">Scale-Location Distribution</p>
<p>To draw from <span class="math notranslate nohighlight">\(\mathrm{Normal}(\mu, \sigma)\)</span>, you can draw <code class="docutils literal notranslate"><span class="pre">xs</span></code> from a standard normal and compute <code class="docutils literal notranslate"><span class="pre">xs</span> <span class="pre">*</span> <span class="pre">σ</span> <span class="pre">+</span> <span class="pre">μ</span></code>.</p>
</div>
<p>✅ Fit a linear model <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">~</span> <span class="pre">x1</span> <span class="pre">+</span> <span class="pre">x2</span></code> on 1000 data points drawn from this model.  What are the intercept and coefficients from the model? Are they what you expect?
Check the model assumptions — do they hold?</p>
<div class="tip admonition">
<p class="admonition-title">Multivariate Normals</p>
<p>You can draw both <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> simultaneously with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]],</span> <span class="mi">1000</span><span class="p">)</span>
<span class="c1"># turn into a data frame</span>
<span class="n">xdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">,</span> <span class="s1">&#39;X2&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>The multivariate normal distribution is parameterized by a list (or array) of means, and a positive symmetric covariance matrix defined as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
\Var(X_1) &amp; \Cov(X_1, X_2) \\
\Cov(X_2, X_1) &amp; \Var(X_2)
\end{bmatrix}\end{split}\]</div>
<p>That is, the diagonals of the matrix are the variances of the individual variables, and the other cells are the covariances between pairs of variables.
The example code sets up the following matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
2 &amp; 0 \\
0 &amp; 5
\end{bmatrix}\end{split}\]</div>
</div>
</div>
<div class="section" id="correlated-predictors-10">
<h2>Correlated Predictors (10%)<a class="headerlink" href="#correlated-predictors-10" title="Permalink to this headline">¶</a></h2>
<p>Now we’re going to see what happens when we have correlated predictor variables.
Remember I said those were a problem?</p>
<p>We’re going to use the <em>multivariate normal</em> from the hint in the previous part to draw <em>correlated</em> variables <span class="math notranslate nohighlight">\(X_1\)</span> and <span class="math notranslate nohighlight">\(X_2\)</span> to use as predictors.
We will use the following procedure:</p>
<ol>
<li><p>Draw 1000 samples of variables <span class="math notranslate nohighlight">\(X_1\)</span> and <span class="math notranslate nohighlight">\(X_2\)</span> from a multivariate normal with means <span class="math notranslate nohighlight">\(\langle 1, 3 \rangle\)</span>, variances of 1, and a covariance <span class="math notranslate nohighlight">\(\Cov(X_1, X_2) = 0.85\)</span>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.85</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Draw <span class="math notranslate nohighlight">\(\epsilon \sim \mathrm{Normal}(0, 2)\)</span></p></li>
<li><p>Compute <span class="math notranslate nohighlight">\(y = 3 + 2 x_1 + 3 x_2 + \epsilon\)</span></p></li>
</ol>
<p>✅ Show a pairplot of our variables <span class="math notranslate nohighlight">\(X_1\)</span>, <span class="math notranslate nohighlight">\(X_2\)</span>, and <span class="math notranslate nohighlight">\(Y\)</span>.  What do we see about their distributions and relationships?</p>
<p>✅ Fit a linear regression for <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">~</span> <span class="pre">x1</span> <span class="pre">+</span> <span class="pre">x2</span></code>.  How well does it fit?  Do its assumptions hold?</p>
<p>✅ Run this simulation (drawing 1000 variables and fitting a linear model) 100 times.  Show the mean, variance, and appropriate distribution plots of the estimated intercepts and coefficients (for <code class="docutils literal notranslate"><span class="pre">x1</span></code> and <code class="docutils literal notranslate"><span class="pre">x2</span></code>).</p>
<p>✅ Repeat the repeated simulation for a variety of different covariances from 0 to 1
(including at least 0, 0.9, 0.99, and 0.999). Create line plots (or a single line plot with multiple
colors) that show how the <em>variance</em> of the estimated regression parameters (intercept and <span class="math notranslate nohighlight">\(x_1\)</span> and
<span class="math notranslate nohighlight">\(x_2\)</span> coefficients) change as you increase the correlation (covariance) between <span class="math notranslate nohighlight">\(X_1\)</span> and <span class="math notranslate nohighlight">\(X_2\)</span>.</p>
<div class="tip admonition">
<p class="admonition-title">Repeated Repeats</p>
<p>One iteration of the simulation is the following steps:</p>
<ol class="simple">
<li><p>draw variables</p></li>
<li><p>compute result (linear model intercept &amp; coefficients)</p></li>
</ol>
<p>Repeating that is performing this simulation 100 times, so we can compute the variance of our linear model’s estimate.</p>
<p>To repeat the repeated simulation, you need to do <em>that</em> multiple times:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">real_cov</span> <span class="ow">in</span> <span class="n">COV_LIST</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">rep</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="c1"># draw numbers</span>
        <span class="c1"># fit parameters</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>I didn’t ask you to include 1 in your selected covariances - what happens if you do?  How does that plot differ from
a plot that only goes up to 0.999 or 0.9999?</p>
</div>
</div>
<div class="section" id="reflection-5">
<h2>Reflection (5%)<a class="headerlink" href="#reflection-5" title="Permalink to this headline">¶</a></h2>
<p>Write a couple of paragraphs about what you learned from this assignment.</p>
</div>
<div class="section" id="expected-time">
<h2>Expected Time<a class="headerlink" href="#expected-time" title="Permalink to this headline">¶</a></h2>
<p>I’m providing here some estimates of how long I expect each part might take you.</p>
<ol class="simple">
<li><p>Warmup: 1 hour</p></li>
<li><p>Linear Regression: 2.5 hours</p></li>
<li><p>Nonlinear Data: 1 hour</p></li>
<li><p>Non-normal Covariates: 1 hour</p></li>
<li><p>Multiple Regression: 1 hour</p></li>
<li><p>Correlated Predictors: 2 hours</p></li>
<li><p>Cleanup and Reflection: 1 hour</p></li>
</ol>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./assignments\A4"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../A3/" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Assignment 3</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../A5/" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Assignment 5</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Michael D. Ekstrand<br/>
        
            &copy; <a href="../../copyright/">Copyright</a> 2021.<br/>
          <div class="extra_footer">
            <script data-goatcounter="https://cs533.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>