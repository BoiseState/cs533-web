
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Indexing &#8212; CS 533 Fall 2021</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/fonts.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/tabinsert.js"></script>
    <script src="../../../_static/urlclean.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "mdekstrand/cs533-web");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "ðŸ’¬ comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"E": "\\mathrm{E}", "Field": "\\mathcal{F}", "P": "\\mathrm{P}", "Cov": "\\mathrm{Cov}", "Cor": "\\mathrm{Cor}", "Var": "\\mathrm{Var}", "log": "\\operatorname{log}", "Odds": "\\operatorname{Odds}", "OR": "\\operatorname{OR}", "IND": "\\mathbb{I}", "Reals": "\\mathbb{R}"}}, "HTML-CSS": {"fonts": ["TeX"]}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../../_static/logo.png"/>
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />
    <link rel="copyright" title="Copyright" href="../../../copyright/" />
    <link rel="next" title="Logistic Regression Demo" href="../LogitRegressionDemo/" />
    <link rel="prev" title="Writing Functions" href="../Functions/" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../">
      
      
      
      <h1 class="site-logo" id="site-title">CS 533 Fall 2021</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search/" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../">
   CS 533 Homepage
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course Info
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../syllabus/">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../schedule/">
   Schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../glossary/">
   Glossary
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Content
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week0/">
   Week 0 â€” Pre-Class Welcome
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../week1/">
   Week 1 â€” Questions (8/23â€“27)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../week1/DemoNotebook/">
     Demo Notebook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../week1/1-7-types-operations/">
     Data Types and Operations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../week2/">
   Week 2 â€” Description (8/30â€“9/3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../week2/2-2-PandasBasics/">
     Introducing Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../week2/2-4-AggregatesAndGroups/">
     Aggregates and Groups
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../week2/2-6-DescribingDistributions/">
     Describing Distributions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../week3/">
   Week 3 â€” Presentation (9/6â€“10)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../week3/3-6-ChartsFromTheGroundUp/">
     Drawing Charts
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week4/">
   Week 4 â€” Inference (9/13â€“17)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week5/">
   Week 5 â€” Filling In (9/20â€“24)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week6/">
   Week 6 â€” Two Variables (Sep. 27â€“Oct. 1)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week7/">
   Week 7 â€” Getting Data (Oct. 4â€“8)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week8/">
   Week 8 â€” Regression (Oct. 11â€“15)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week9/">
   Week 9 â€” Models &amp; Prediction (Oct. 18â€“22)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week10/">
   Week 10 â€” Classification (10/25â€“29)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week11/">
   Week 11 â€” More Modeling (11/1â€“5)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week12/">
   Week 12 â€” Text (11/8â€“12)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week13/">
   Week 13 â€” Unsupervised (11/15â€“19)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week14/">
   Week 14 â€” Workflow (11/29â€“12/3)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week15/">
   Week 15 â€” What Next? (12/6â€“10)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/">
   Rubric
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../assignments/A0/">
   Assignment 0
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../assignments/A0/A0-Notebook/">
     CS 533 Assignment 0
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A1/">
   Assignment 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A2/">
   Assignment 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A3/">
   Assignment 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A4/">
   Assignment 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A5/">
   Assignment 5
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A6/">
   Assignment 6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A7/">
   Assignment 7
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Resources
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../software/">
   Software and Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../documentation/">
   Documentation &amp; Reading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../data/">
   Data Sets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebook-checklist/">
   Notebook Checklist &amp; Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../probability/">
   Notes on Probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../problems/">
   Common Problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../onyx/">
   Remotely Using Onyx
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../git-resources/">
   Git Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../environments/">
   Software Environments
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../">
   Tutorials
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../AdvancedPipeline/">
     Advanced Pipeline Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../BooleanSeries/">
     Tricks with Boolean Series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../BuildingData/">
     Building Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ChartFinishingTouches/">
     Finishing Touches
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Charting/">
     Drawing Charts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ClusteringExample/">
     Clustering Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Correlation/">
     Correlation and Basic Linear Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../CriticScores/">
     Charting Movie Scores
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Distributions/">
     Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../EmpiricalProbabilities/">
     Empirical Probabilities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../FetchCHIPapers/">
     Bibliography Fetch
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../FunWithNumbers/">
     Fun with Numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Functions/">
     Writing Functions
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Indexing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../LogitRegressionDemo/">
     Logistic Regression Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MLTimeSeries/">
     MovieLens Time Series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MinimizeRegression/">
     Rebuilding Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MissingData/">
     Missing Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MovieDecomp/">
     Movie Matrix Decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../OneSample/">
     One Sample
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../OverfittingSimulation/">
     Overfitting Simulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../PCADemo/">
     PCA Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../PenguinSamples/">
     Sampling and Testing the Penguins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Regressions/">
     Regressions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reshaping/">
     Reshaping Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SamplingDists/">
     Sampling Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SciKitLogistic/">
     SciKit Logistic Regression Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SciKitPipeline/">
     SciKit Pipeline and Transform Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SciKitRegression/">
     SciKit-Learn Linear Regression Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SciKitTransform/">
     SciKit Transformations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Selection/">
     Selecting Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sessions/">
     Sessionization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SpamFilter/">
     Spam Detector Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../TuningExample/">
     Tuning Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../UsingTheCensus/">
     Using Census Data
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Site Details
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../copyright/">
   Copyright and License
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/resources/tutorials/Indexing.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/mdekstrand/cs533-web"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/mdekstrand/cs533-web/issues/new?title=Issue%20on%20page%20%2Fresources/tutorials/Indexing.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/mdekstrand/cs533-web/edit/main/resources/tutorials/Indexing.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-an-index">
   What Is an Index?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#range-index">
   Range Index
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setting-an-index">
   Setting an Index
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#index-properties-and-operations">
   Index Properties and Operations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#arrays-and-keys">
     Arrays and Keys
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#index-characteristics">
     Index Characteristics
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hierarchical-indexing">
   Hierarchical Indexing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sorting-and-realigning">
   Sorting and Realigning
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sorting">
     Sorting
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reindexing">
     Reindexing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#alignment">
     Alignment
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#index-gotchas">
   Index Gotchas
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#learning-more">
   Learning More
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="indexing">
<h1>Indexing<a class="headerlink" href="#indexing" title="Permalink to this headline">Â¶</a></h1>
<p>This notebook discusses Pandas indexing operations, and pitfalls.</p>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">Â¶</a></h2>
<p>First our Python modules:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy.linalg</span> <span class="k">as</span> <span class="nn">spla</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<p>And then the movie data, as usual.  Movies:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hetrec2011-ml/movies.dat&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">N&#39;</span><span class="p">])</span>
<span class="n">movies</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>title</th>
      <th>imdbID</th>
      <th>spanishTitle</th>
      <th>imdbPictureURL</th>
      <th>year</th>
      <th>rtID</th>
      <th>rtAllCriticsRating</th>
      <th>rtAllCriticsNumReviews</th>
      <th>rtAllCriticsNumFresh</th>
      <th>...</th>
      <th>rtAllCriticsScore</th>
      <th>rtTopCriticsRating</th>
      <th>rtTopCriticsNumReviews</th>
      <th>rtTopCriticsNumFresh</th>
      <th>rtTopCriticsNumRotten</th>
      <th>rtTopCriticsScore</th>
      <th>rtAudienceRating</th>
      <th>rtAudienceNumRatings</th>
      <th>rtAudienceScore</th>
      <th>rtPictureURL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Toy story</td>
      <td>114709</td>
      <td>Toy story (juguetes)</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTMwNDU0...</td>
      <td>1995</td>
      <td>toy_story</td>
      <td>9.0</td>
      <td>73.0</td>
      <td>73.0</td>
      <td>...</td>
      <td>100.0</td>
      <td>8.5</td>
      <td>17.0</td>
      <td>17.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>3.7</td>
      <td>102338.0</td>
      <td>81.0</td>
      <td>http://content7.flixster.com/movie/10/93/63/10...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Jumanji</td>
      <td>113497</td>
      <td>Jumanji</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMzM5NjE1...</td>
      <td>1995</td>
      <td>1068044-jumanji</td>
      <td>5.6</td>
      <td>28.0</td>
      <td>13.0</td>
      <td>...</td>
      <td>46.0</td>
      <td>5.8</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>40.0</td>
      <td>3.2</td>
      <td>44587.0</td>
      <td>61.0</td>
      <td>http://content8.flixster.com/movie/56/79/73/56...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Grumpy Old Men</td>
      <td>107050</td>
      <td>Dos viejos gruÃ±ones</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTI5MTgy...</td>
      <td>1993</td>
      <td>grumpy_old_men</td>
      <td>5.9</td>
      <td>36.0</td>
      <td>24.0</td>
      <td>...</td>
      <td>66.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>83.0</td>
      <td>3.2</td>
      <td>10489.0</td>
      <td>66.0</td>
      <td>http://content6.flixster.com/movie/25/60/25602...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Waiting to Exhale</td>
      <td>114885</td>
      <td>Esperando un respiro</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTczMTMy...</td>
      <td>1995</td>
      <td>waiting_to_exhale</td>
      <td>5.6</td>
      <td>25.0</td>
      <td>14.0</td>
      <td>...</td>
      <td>56.0</td>
      <td>5.5</td>
      <td>11.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>45.0</td>
      <td>3.3</td>
      <td>5666.0</td>
      <td>79.0</td>
      <td>http://content9.flixster.com/movie/10/94/17/10...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Father of the Bride Part II</td>
      <td>113041</td>
      <td>Vuelve el padre de la novia (Ahora tambiÃ©n abu...</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTg1NDc2...</td>
      <td>1995</td>
      <td>father_of_the_bride_part_ii</td>
      <td>5.3</td>
      <td>19.0</td>
      <td>9.0</td>
      <td>...</td>
      <td>47.0</td>
      <td>5.4</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>20.0</td>
      <td>3.0</td>
      <td>13761.0</td>
      <td>64.0</td>
      <td>http://content8.flixster.com/movie/25/54/25542...</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 21 columns</p>
</div></div></div>
</div>
<p>And ratings:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hetrec2011-ml/user_ratedmovies-timestamps.dat&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span><span class="p">)</span>
<span class="n">ratings</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userID</th>
      <th>movieID</th>
      <th>rating</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>75</td>
      <td>3</td>
      <td>1.0</td>
      <td>1162160236000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>75</td>
      <td>32</td>
      <td>4.5</td>
      <td>1162160624000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>75</td>
      <td>110</td>
      <td>4.0</td>
      <td>1162161008000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>75</td>
      <td>160</td>
      <td>2.0</td>
      <td>1162160212000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>75</td>
      <td>163</td>
      <td>4.0</td>
      <td>1162160970000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>And letâ€™s load tags:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tags</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hetrec2011-ml/tags.dat&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span><span class="p">)</span>
<span class="n">tags</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>earth</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>police</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>boxing</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>painter</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>whale</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="what-is-an-index">
<h2>What Is an Index?<a class="headerlink" href="#what-is-an-index" title="Permalink to this headline">Â¶</a></h2>
<p>An index is what we use to locate rows or columns in a Pandas data structure.  (While conceptually we can think of a data frame as a dictionary of columns, the name-to-column mapping is actually done with an index.)</p>
<p>An index is two things in one data structure:</p>
<ul class="simple">
<li><p>An array of key values (given a position, we can get the key value)</p></li>
<li><p>A hash map to look up row position(s) for a given key value</p></li>
</ul>
<p>Indexes keys can be any (immutable) data type.  Pandas has special support for indexing over <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> objects, for <em>time series</em>.</p>
</div>
<div class="section" id="range-index">
<h2>Range Index<a class="headerlink" href="#range-index" title="Permalink to this headline">Â¶</a></h2>
<p>When we load the data from the CSV file, it by default it is loaded with a <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.RangeIndex.html"><code class="docutils literal notranslate"><span class="pre">RangeIndex</span></code></a>, in which the keys and the positions are the same.  These indexes are very memory-efficient, because they donâ€™t actually need to store key values.
Letâ€™s see the movie index:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RangeIndex(start=0, stop=10197, step=1)
</pre></div>
</div>
</div>
</div>
<p>With a range index, <code class="docutils literal notranslate"><span class="pre">loc</span></code> and <code class="docutils literal notranslate"><span class="pre">iloc</span></code> do the same thing (for rows):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id          6
title    Heat
Name: 5, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id          6
title    Heat
Name: 5, dtype: object
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="setting-an-index">
<h2>Setting an Index<a class="headerlink" href="#setting-an-index" title="Permalink to this headline">Â¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">set_index</span></code> method makes a column into the index.  It will <strong>replace</strong> the current index; if the current index is a range index, that is usually fine.</p>
<p>There are two versions:</p>
<ul class="simple">
<li><p>By default, it returns a <em>new</em> data frame with the new index, and leaves the original unchanged.  The frame shares underlying data with the original, so it doesnâ€™t take up that much memory.</p></li>
<li><p>With <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>, it modifies the data frame to have the new index.</p></li>
</ul>
<p>Both are useful.  Be <strong>very</strong> careful with <code class="docutils literal notranslate"><span class="pre">inplace</span></code> in a function; the caller probably doesnâ€™t expect the data frame to be modified!</p>
<p>Letâ€™s index the <code class="docutils literal notranslate"><span class="pre">movies</span></code> frame by movie ID:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span> <span class="o">=</span> <span class="n">movies</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
<span class="n">movies</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Int64Index([    1,     2,     3,     4,     5,     6,     7,     8,     9,
               10,
            ...
            64997, 64999, 65006, 65011, 65037, 65088, 65091, 65126, 65130,
            65133],
           dtype=&#39;int64&#39;, name=&#39;id&#39;, length=10197)
</pre></div>
</div>
</div>
</div>
<p>The new index is also reflected in <code class="docutils literal notranslate"><span class="pre">.info()</span></code>, and the <code class="docutils literal notranslate"><span class="pre">id</span></code> column is gone:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 10197 entries, 1 to 65133
Data columns (total 20 columns):
 #   Column                  Non-Null Count  Dtype  
---  ------                  --------------  -----  
 0   title                   10197 non-null  object 
 1   imdbID                  10197 non-null  int64  
 2   spanishTitle            10197 non-null  object 
 3   imdbPictureURL          10016 non-null  object 
 4   year                    10197 non-null  int64  
 5   rtID                    9886 non-null   object 
 6   rtAllCriticsRating      9967 non-null   float64
 7   rtAllCriticsNumReviews  9967 non-null   float64
 8   rtAllCriticsNumFresh    9967 non-null   float64
 9   rtAllCriticsNumRotten   9967 non-null   float64
 10  rtAllCriticsScore       9967 non-null   float64
 11  rtTopCriticsRating      9967 non-null   float64
 12  rtTopCriticsNumReviews  9967 non-null   float64
 13  rtTopCriticsNumFresh    9967 non-null   float64
 14  rtTopCriticsNumRotten   9967 non-null   float64
 15  rtTopCriticsScore       9967 non-null   float64
 16  rtAudienceRating        9967 non-null   float64
 17  rtAudienceNumRatings    9967 non-null   float64
 18  rtAudienceScore         9967 non-null   float64
 19  rtPictureURL            9967 non-null   object 
dtypes: float64(13), int64(2), object(5)
memory usage: 1.9+ MB
</pre></div>
</div>
</div>
</div>
<p>We now have an index that lets us up by 64-bit integer keys. We can now look up <em>Heat</em> by movie ID:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>title                                                                  Heat
imdbID                                                               113277
spanishTitle                                                           Heat
imdbPictureURL            http://ia.media-imdb.com/images/M/MV5BMTM1NDc4...
year                                                                   1995
rtID                                                           1068182-heat
rtAllCriticsRating                                                      7.7
rtAllCriticsNumReviews                                                   58
rtAllCriticsNumFresh                                                     50
rtAllCriticsNumRotten                                                     8
rtAllCriticsScore                                                        86
rtTopCriticsRating                                                      7.2
rtTopCriticsNumReviews                                                   17
rtTopCriticsNumFresh                                                     14
rtTopCriticsNumRotten                                                     3
rtTopCriticsScore                                                        82
rtAudienceRating                                                        3.9
rtAudienceNumRatings                                                  42785
rtAudienceScore                                                          92
rtPictureURL              http://content9.flixster.com/movie/26/80/26809...
Name: 6, dtype: object
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">iloc</span></code> still returns this at position 5:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>title                                                                  Heat
imdbID                                                               113277
spanishTitle                                                           Heat
imdbPictureURL            http://ia.media-imdb.com/images/M/MV5BMTM1NDc4...
year                                                                   1995
rtID                                                           1068182-heat
rtAllCriticsRating                                                      7.7
rtAllCriticsNumReviews                                                   58
rtAllCriticsNumFresh                                                     50
rtAllCriticsNumRotten                                                     8
rtAllCriticsScore                                                        86
rtTopCriticsRating                                                      7.2
rtTopCriticsNumReviews                                                   17
rtTopCriticsNumFresh                                                     14
rtTopCriticsNumRotten                                                     3
rtTopCriticsScore                                                        82
rtAudienceRating                                                        3.9
rtAudienceNumRatings                                                  42785
rtAudienceScore                                                          92
rtPictureURL              http://content9.flixster.com/movie/26/80/26809...
Name: 6, dtype: object
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">reset_index</span></code> method will turn the index back into a column, and put a range index back in place:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10197 entries, 0 to 10196
Data columns (total 21 columns):
 #   Column                  Non-Null Count  Dtype  
---  ------                  --------------  -----  
 0   id                      10197 non-null  int64  
 1   title                   10197 non-null  object 
 2   imdbID                  10197 non-null  int64  
 3   spanishTitle            10197 non-null  object 
 4   imdbPictureURL          10016 non-null  object 
 5   year                    10197 non-null  int64  
 6   rtID                    9886 non-null   object 
 7   rtAllCriticsRating      9967 non-null   float64
 8   rtAllCriticsNumReviews  9967 non-null   float64
 9   rtAllCriticsNumFresh    9967 non-null   float64
 10  rtAllCriticsNumRotten   9967 non-null   float64
 11  rtAllCriticsScore       9967 non-null   float64
 12  rtTopCriticsRating      9967 non-null   float64
 13  rtTopCriticsNumReviews  9967 non-null   float64
 14  rtTopCriticsNumFresh    9967 non-null   float64
 15  rtTopCriticsNumRotten   9967 non-null   float64
 16  rtTopCriticsScore       9967 non-null   float64
 17  rtAudienceRating        9967 non-null   float64
 18  rtAudienceNumRatings    9967 non-null   float64
 19  rtAudienceScore         9967 non-null   float64
 20  rtPictureURL            9967 non-null   object 
dtypes: float64(13), int64(3), object(5)
memory usage: 1.6+ MB
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="index-properties-and-operations">
<h2>Index Properties and Operations<a class="headerlink" href="#index-properties-and-operations" title="Permalink to this headline">Â¶</a></h2>
<p>We can do quite a few things with an <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.Index.html"><code class="docutils literal notranslate"><span class="pre">Index</span></code></a>.</p>
<p>First, it has a name:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;id&#39;
</pre></div>
</div>
</div>
</div>
<p>We could change the name if we wanted to, by assigning to it:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>movies.index.name = &#39;movieId&#39;
</pre></div>
</div>
<p>But we wonâ€™t actually do that right now.</p>
<div class="section" id="arrays-and-keys">
<h3>Arrays and Keys<a class="headerlink" href="#arrays-and-keys" title="Permalink to this headline">Â¶</a></h3>
<p>The index is also an array - we can get the key at a certain position:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6
</pre></div>
</div>
</div>
</div>
<p>To go the other way â€” find the location or position for a key value â€” we can use the <code class="docutils literal notranslate"><span class="pre">get_loc</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<p>If we look for a nonexistent key, it fails:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="mi">30481080</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">~\Anaconda3\lib\site-packages\pandas\core\indexes\base.py</span> in <span class="ni">get_loc</span><span class="nt">(self, key, method, tolerance)</span>
<span class="g g-Whitespace">   </span><span class="mi">2645</span>             <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2646</span>                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2647</span>             <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>

<span class="nn">pandas\_libs\index.pyx</span> in <span class="ni">pandas._libs.index.IndexEngine.get_loc</span><span class="nt">()</span>

<span class="nn">pandas\_libs\index.pyx</span> in <span class="ni">pandas._libs.index.IndexEngine.get_loc</span><span class="nt">()</span>

<span class="nn">pandas\_libs\hashtable_class_helper.pxi</span> in <span class="ni">pandas._libs.hashtable.Int64HashTable.get_item</span><span class="nt">()</span>

<span class="nn">pandas\_libs\hashtable_class_helper.pxi</span> in <span class="ni">pandas._libs.hashtable.Int64HashTable.get_item</span><span class="nt">()</span>

<span class="ne">KeyError</span>: 30481080

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">17</span><span class="o">-</span><span class="mi">937</span><span class="n">b631c964d</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">movies</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="mi">30481080</span><span class="p">)</span>

<span class="nn">~\Anaconda3\lib\site-packages\pandas\core\indexes\base.py</span> in <span class="ni">get_loc</span><span class="nt">(self, key, method, tolerance)</span>
<span class="g g-Whitespace">   </span><span class="mi">2646</span>                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2647</span>             <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2648</span>                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_maybe_cast_indexer</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">2649</span>         <span class="n">indexer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_indexer</span><span class="p">([</span><span class="n">key</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">tolerance</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2650</span>         <span class="k">if</span> <span class="n">indexer</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">indexer</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>

<span class="nn">pandas\_libs\index.pyx</span> in <span class="ni">pandas._libs.index.IndexEngine.get_loc</span><span class="nt">()</span>

<span class="nn">pandas\_libs\index.pyx</span> in <span class="ni">pandas._libs.index.IndexEngine.get_loc</span><span class="nt">()</span>

<span class="nn">pandas\_libs\hashtable_class_helper.pxi</span> in <span class="ni">pandas._libs.hashtable.Int64HashTable.get_item</span><span class="nt">()</span>

<span class="nn">pandas\_libs\hashtable_class_helper.pxi</span> in <span class="ni">pandas._libs.hashtable.Int64HashTable.get_item</span><span class="nt">()</span>

<span class="ne">KeyError</span>: 30481080
</pre></div>
</div>
</div>
</div>
<p>This is a <code class="docutils literal notranslate"><span class="pre">KeyError</span></code>, meaning we tried to look up a key that does not exist.</p>
<p>Internally, the index uses a NumPy <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> to store the keys. We can access this array as <code class="docutils literal notranslate"><span class="pre">.values</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([    1,     2,     3, ..., 65126, 65130, 65133], dtype=int64)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="index-characteristics">
<h3>Index Characteristics<a class="headerlink" href="#index-characteristics" title="Permalink to this headline">Â¶</a></h3>
<p>There are a few useful characteristics an index can have.  It may be <em>unique</em>, or it may have duplicates.  This is a unique index:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_unique</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">has_duplicates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>An index can also be <em>monotonic</em>, or sorted; the <code class="docutils literal notranslate"><span class="pre">is_monotonic</span></code> accessor is a shortcut for <code class="docutils literal notranslate"><span class="pre">is_monotonic_increasing</span></code> and returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if the index is sorted in nondecreasing order:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_monotonic</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Since this index is both monotonic and unique, it is sorted in <strong>strictly increasing</strong> order.</p>
<p>Since it is monotonic, we can also use ranges for key-based lookup:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>imdbID</th>
      <th>spanishTitle</th>
      <th>imdbPictureURL</th>
      <th>year</th>
      <th>rtID</th>
      <th>rtAllCriticsRating</th>
      <th>rtAllCriticsNumReviews</th>
      <th>rtAllCriticsNumFresh</th>
      <th>rtAllCriticsNumRotten</th>
      <th>rtAllCriticsScore</th>
      <th>rtTopCriticsRating</th>
      <th>rtTopCriticsNumReviews</th>
      <th>rtTopCriticsNumFresh</th>
      <th>rtTopCriticsNumRotten</th>
      <th>rtTopCriticsScore</th>
      <th>rtAudienceRating</th>
      <th>rtAudienceNumRatings</th>
      <th>rtAudienceScore</th>
      <th>rtPictureURL</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>Heat</td>
      <td>113277</td>
      <td>Heat</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTM1NDc4...</td>
      <td>1995</td>
      <td>1068182-heat</td>
      <td>7.7</td>
      <td>58.0</td>
      <td>50.0</td>
      <td>8.0</td>
      <td>86.0</td>
      <td>7.2</td>
      <td>17.0</td>
      <td>14.0</td>
      <td>3.0</td>
      <td>82.0</td>
      <td>3.9</td>
      <td>42785.0</td>
      <td>92.0</td>
      <td>http://content9.flixster.com/movie/26/80/26809...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Sabrina</td>
      <td>47437</td>
      <td>Sabrina</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTYyNDM1...</td>
      <td>1954</td>
      <td>1018047-sabrina</td>
      <td>7.4</td>
      <td>31.0</td>
      <td>28.0</td>
      <td>3.0</td>
      <td>90.0</td>
      <td>7.2</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>3.8</td>
      <td>12812.0</td>
      <td>87.0</td>
      <td>http://content7.flixster.com/movie/10/93/36/10...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Tom and Huck</td>
      <td>112302</td>
      <td>Tom y Huck</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTUxNDYz...</td>
      <td>1995</td>
      <td>tom_and_huck</td>
      <td>4.2</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>25.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>50.0</td>
      <td>2.7</td>
      <td>2649.0</td>
      <td>45.0</td>
      <td>http://content9.flixster.com/movie/26/16/26169...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Sudden Death</td>
      <td>114576</td>
      <td>Sudden Death: muerte sÃºbita</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTcwMTU2...</td>
      <td>1995</td>
      <td>1068470-sudden_death</td>
      <td>5.2</td>
      <td>32.0</td>
      <td>17.0</td>
      <td>15.0</td>
      <td>53.0</td>
      <td>5.6</td>
      <td>9.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>55.0</td>
      <td>2.6</td>
      <td>3626.0</td>
      <td>40.0</td>
      <td>http://content8.flixster.com/movie/27/91/27912...</td>
    </tr>
    <tr>
      <th>10</th>
      <td>GoldenEye</td>
      <td>113189</td>
      <td>GoldenEye</td>
      <td>http://ia.media-imdb.com/images/M/MV5BNTE1OTEx...</td>
      <td>1995</td>
      <td>goldeneye</td>
      <td>6.8</td>
      <td>41.0</td>
      <td>33.0</td>
      <td>8.0</td>
      <td>80.0</td>
      <td>6.2</td>
      <td>11.0</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>63.0</td>
      <td>3.4</td>
      <td>28260.0</td>
      <td>78.0</td>
      <td>http://content9.flixster.com/movie/26/66/26669...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note that range-based indexing in <code class="docutils literal notranslate"><span class="pre">.loc</span></code> <em>includes both ends</em>, unlike slices in almost any other part of Python.</p>
<p><strong>Unsorted Indexes:</strong> While we might expect slice-based key indexing to get things in the range, that is <em>not</em> what it does. It locates the positions of the start and end keys, and returns everything between them.  If the index is not sorted, this is usually not useful.  Only use key slices on sorted indexes.</p>
</div>
</div>
<div class="section" id="hierarchical-indexing">
<h2>Hierarchical Indexing<a class="headerlink" href="#hierarchical-indexing" title="Permalink to this headline">Â¶</a></h2>
<p>Pandas supports <em>hierarchical indexes</em>, with <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.MultiIndex.html"><code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code></a>.
Create a hierarchical index by passing multiple columns to <code class="docutils literal notranslate"><span class="pre">set_index</span></code>.</p>
<p>For example, letâ€™s make a series that indexes ratings by user and item IDs:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx_ratings</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;userID&#39;</span><span class="p">,</span> <span class="s1">&#39;movieID&#39;</span><span class="p">])</span>
<span class="n">idx_ratings</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>rating</th>
      <th>timestamp</th>
    </tr>
    <tr>
      <th>userID</th>
      <th>movieID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">75</th>
      <th>3</th>
      <td>1.0</td>
      <td>1162160236000</td>
    </tr>
    <tr>
      <th>32</th>
      <td>4.5</td>
      <td>1162160624000</td>
    </tr>
    <tr>
      <th>110</th>
      <td>4.0</td>
      <td>1162161008000</td>
    </tr>
    <tr>
      <th>160</th>
      <td>2.0</td>
      <td>1162160212000</td>
    </tr>
    <tr>
      <th>163</th>
      <td>4.0</td>
      <td>1162160970000</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">71534</th>
      <th>44555</th>
      <td>4.0</td>
      <td>1196647538000</td>
    </tr>
    <tr>
      <th>46578</th>
      <td>4.0</td>
      <td>1196647004000</td>
    </tr>
    <tr>
      <th>48516</th>
      <td>4.5</td>
      <td>1196646826000</td>
    </tr>
    <tr>
      <th>61075</th>
      <td>5.0</td>
      <td>1223625365000</td>
    </tr>
    <tr>
      <th>62049</th>
      <td>4.5</td>
      <td>1223625490000</td>
    </tr>
  </tbody>
</table>
<p>855598 rows Ã— 2 columns</p>
</div></div></div>
</div>
<p>We see on the left that there are two levels to the index: <code class="docutils literal notranslate"><span class="pre">userID</span></code> and <code class="docutils literal notranslate"><span class="pre">movieID</span></code>.  We can see this with <code class="docutils literal notranslate"><span class="pre">.names</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx_ratings</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FrozenList([&#39;userID&#39;, &#39;movieID&#39;])
</pre></div>
</div>
</div>
</div>
<p>The multi-level index lets us look up values by just the outermost index, getting all rows with that outer index value.  For example, to get all ratings by user 190:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx_ratings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">190</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rating</th>
      <th>timestamp</th>
    </tr>
    <tr>
      <th>movieID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>4.5</td>
      <td>1057778398000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.0</td>
      <td>1053457414000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2.0</td>
      <td>1049823937000</td>
    </tr>
    <tr>
      <th>32</th>
      <td>3.0</td>
      <td>1151336652000</td>
    </tr>
    <tr>
      <th>95</th>
      <td>2.0</td>
      <td>1078019174000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>54001</th>
      <td>4.5</td>
      <td>1185219688000</td>
    </tr>
    <tr>
      <th>54259</th>
      <td>4.0</td>
      <td>1217875029000</td>
    </tr>
    <tr>
      <th>58559</th>
      <td>4.5</td>
      <td>1217258754000</td>
    </tr>
    <tr>
      <th>59315</th>
      <td>4.0</td>
      <td>1210627067000</td>
    </tr>
    <tr>
      <th>64497</th>
      <td>3.0</td>
      <td>1230991072000</td>
    </tr>
  </tbody>
</table>
<p>296 rows Ã— 2 columns</p>
</div></div></div>
</div>
<p>Since we are looking up <em>one</em> user, it drops the user level from the index.  If we looked up multiple users, it would not:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx_ratings</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">75</span><span class="p">,</span> <span class="mi">190</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>rating</th>
      <th>timestamp</th>
    </tr>
    <tr>
      <th>userID</th>
      <th>movieID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">75</th>
      <th>3</th>
      <td>1.0</td>
      <td>1162160236000</td>
    </tr>
    <tr>
      <th>32</th>
      <td>4.5</td>
      <td>1162160624000</td>
    </tr>
    <tr>
      <th>110</th>
      <td>4.0</td>
      <td>1162161008000</td>
    </tr>
    <tr>
      <th>160</th>
      <td>2.0</td>
      <td>1162160212000</td>
    </tr>
    <tr>
      <th>163</th>
      <td>4.0</td>
      <td>1162160970000</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">190</th>
      <th>54001</th>
      <td>4.5</td>
      <td>1185219688000</td>
    </tr>
    <tr>
      <th>54259</th>
      <td>4.0</td>
      <td>1217875029000</td>
    </tr>
    <tr>
      <th>58559</th>
      <td>4.5</td>
      <td>1217258754000</td>
    </tr>
    <tr>
      <th>59315</th>
      <td>4.0</td>
      <td>1210627067000</td>
    </tr>
    <tr>
      <th>64497</th>
      <td>3.0</td>
      <td>1230991072000</td>
    </tr>
  </tbody>
</table>
<p>351 rows Ã— 2 columns</p>
</div></div></div>
</div>
<p>Multi-indexes are one place where Python makes a distinction between lists and tuples.  If we look up <code class="docutils literal notranslate"><span class="pre">(75,</span> <span class="pre">32)</span></code>, it will look up user 75â€™s rating for item 32:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx_ratings</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="mi">75</span><span class="p">,</span> <span class="mi">32</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>rating       4.500000e+00
timestamp    1.162161e+12
Name: (75, 32), dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We can index by a list of tuples:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx_ratings</span><span class="o">.</span><span class="n">loc</span><span class="p">[[(</span><span class="mi">75</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="p">(</span><span class="mi">190</span><span class="p">,</span> <span class="mi">58559</span><span class="p">)]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>rating</th>
      <th>timestamp</th>
    </tr>
    <tr>
      <th>userID</th>
      <th>movieID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>75</th>
      <th>32</th>
      <td>4.5</td>
      <td>1162160624000</td>
    </tr>
    <tr>
      <th>190</th>
      <th>58559</th>
      <td>4.5</td>
      <td>1217258754000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>So we have the following principle:</p>
<ul class="simple">
<li><p>The index locator can be a key, or a list or array of keys</p></li>
<li><p>A key can be a single value, looking up in the outermost index level; or a tuple of values, looking up by multiple levels simultaneously</p></li>
</ul>
<p><strong>Be careful:</strong> hierarchical indexes are not as useful as they look.  They are great for lookups, and joins, but they often have problems too.
In particular, if you have a large data frame with a hiearchical index, there are several operations â€” including groupby â€” that will cause memory explosion.  If you call <code class="docutils literal notranslate"><span class="pre">melt</span></code> with multiple ID columns, it will turn them into a hierarchical index.</p>
<p>I usually use hierarchical indexes for two purpose:</p>
<ul class="simple">
<li><p>Storing data for multidimensional lookup, like the user-and-item ratings</p></li>
<li><p>Joining on mulitiple simultaneous columns</p></li>
</ul>
<p>In both cases, once I have the data I need, I usually strip away the multi-index before moving forward (with <code class="docutils literal notranslate"><span class="pre">reset_index</span></code>, or with a join or lookup operation that leaves the data frame with a normal one-level index) to reduce the risk of unexpected memory explosion.</p>
</div>
<div class="section" id="sorting-and-realigning">
<h2>Sorting and Realigning<a class="headerlink" href="#sorting-and-realigning" title="Permalink to this headline">Â¶</a></h2>
<p>We can rearrange data frames based on their indexes.</p>
<div class="section" id="sorting">
<h3>Sorting<a class="headerlink" href="#sorting" title="Permalink to this headline">Â¶</a></h3>
<p>One useful operation to realign a data frame (or series) with respect to its index is to <em>sort the index</em>.  Our index is already sorted by ID, but what if we wanted to use IMDB IDs?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imdb_movies</span> <span class="o">=</span> <span class="n">movies</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;imdbID&#39;</span><span class="p">)</span>
<span class="n">imdb_movies</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>title</th>
      <th>spanishTitle</th>
      <th>imdbPictureURL</th>
      <th>year</th>
      <th>rtID</th>
      <th>rtAllCriticsRating</th>
      <th>rtAllCriticsNumReviews</th>
      <th>rtAllCriticsNumFresh</th>
      <th>rtAllCriticsNumRotten</th>
      <th>rtAllCriticsScore</th>
      <th>rtTopCriticsRating</th>
      <th>rtTopCriticsNumReviews</th>
      <th>rtTopCriticsNumFresh</th>
      <th>rtTopCriticsNumRotten</th>
      <th>rtTopCriticsScore</th>
      <th>rtAudienceRating</th>
      <th>rtAudienceNumRatings</th>
      <th>rtAudienceScore</th>
      <th>rtPictureURL</th>
    </tr>
    <tr>
      <th>imdbID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>114709</th>
      <td>1</td>
      <td>Toy story</td>
      <td>Toy story (juguetes)</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTMwNDU0...</td>
      <td>1995</td>
      <td>toy_story</td>
      <td>9.0</td>
      <td>73.0</td>
      <td>73.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>8.5</td>
      <td>17.0</td>
      <td>17.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>3.7</td>
      <td>102338.0</td>
      <td>81.0</td>
      <td>http://content7.flixster.com/movie/10/93/63/10...</td>
    </tr>
    <tr>
      <th>113497</th>
      <td>2</td>
      <td>Jumanji</td>
      <td>Jumanji</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMzM5NjE1...</td>
      <td>1995</td>
      <td>1068044-jumanji</td>
      <td>5.6</td>
      <td>28.0</td>
      <td>13.0</td>
      <td>15.0</td>
      <td>46.0</td>
      <td>5.8</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>40.0</td>
      <td>3.2</td>
      <td>44587.0</td>
      <td>61.0</td>
      <td>http://content8.flixster.com/movie/56/79/73/56...</td>
    </tr>
    <tr>
      <th>107050</th>
      <td>3</td>
      <td>Grumpy Old Men</td>
      <td>Dos viejos gruÃ±ones</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTI5MTgy...</td>
      <td>1993</td>
      <td>grumpy_old_men</td>
      <td>5.9</td>
      <td>36.0</td>
      <td>24.0</td>
      <td>12.0</td>
      <td>66.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>83.0</td>
      <td>3.2</td>
      <td>10489.0</td>
      <td>66.0</td>
      <td>http://content6.flixster.com/movie/25/60/25602...</td>
    </tr>
    <tr>
      <th>114885</th>
      <td>4</td>
      <td>Waiting to Exhale</td>
      <td>Esperando un respiro</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTczMTMy...</td>
      <td>1995</td>
      <td>waiting_to_exhale</td>
      <td>5.6</td>
      <td>25.0</td>
      <td>14.0</td>
      <td>11.0</td>
      <td>56.0</td>
      <td>5.5</td>
      <td>11.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>45.0</td>
      <td>3.3</td>
      <td>5666.0</td>
      <td>79.0</td>
      <td>http://content9.flixster.com/movie/10/94/17/10...</td>
    </tr>
    <tr>
      <th>113041</th>
      <td>5</td>
      <td>Father of the Bride Part II</td>
      <td>Vuelve el padre de la novia (Ahora tambiÃ©n abu...</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTg1NDc2...</td>
      <td>1995</td>
      <td>father_of_the_bride_part_ii</td>
      <td>5.3</td>
      <td>19.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>47.0</td>
      <td>5.4</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>20.0</td>
      <td>3.0</td>
      <td>13761.0</td>
      <td>64.0</td>
      <td>http://content8.flixster.com/movie/25/54/25542...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>960731</th>
      <td>65088</td>
      <td>Bedtime Stories</td>
      <td>MÃ¡s allÃ¡ de los sueÃ±os</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMjA5Njk5...</td>
      <td>2008</td>
      <td>bedtime_stories</td>
      <td>4.4</td>
      <td>104.0</td>
      <td>26.0</td>
      <td>78.0</td>
      <td>25.0</td>
      <td>4.7</td>
      <td>26.0</td>
      <td>6.0</td>
      <td>20.0</td>
      <td>23.0</td>
      <td>3.5</td>
      <td>108877.0</td>
      <td>63.0</td>
      <td>http://content6.flixster.com/movie/10/94/33/10...</td>
    </tr>
    <tr>
      <th>25464</th>
      <td>65091</td>
      <td>Manhattan Melodrama</td>
      <td>El enemigo pÃºblico nÃºmero 1</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTUyODE3...</td>
      <td>1934</td>
      <td>manhattan_melodrama</td>
      <td>7.0</td>
      <td>12.0</td>
      <td>10.0</td>
      <td>2.0</td>
      <td>83.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>50.0</td>
      <td>3.7</td>
      <td>344.0</td>
      <td>71.0</td>
      <td>http://content9.flixster.com/movie/66/44/64/66...</td>
    </tr>
    <tr>
      <th>1024715</th>
      <td>65126</td>
      <td>Choke</td>
      <td>Choke</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTMxMDI4...</td>
      <td>2008</td>
      <td>choke</td>
      <td>5.6</td>
      <td>135.0</td>
      <td>73.0</td>
      <td>62.0</td>
      <td>54.0</td>
      <td>4.9</td>
      <td>26.0</td>
      <td>8.0</td>
      <td>18.0</td>
      <td>30.0</td>
      <td>3.3</td>
      <td>13893.0</td>
      <td>55.0</td>
      <td>http://content6.flixster.com/movie/10/85/09/10...</td>
    </tr>
    <tr>
      <th>959337</th>
      <td>65130</td>
      <td>Revolutionary Road</td>
      <td>Revolutionary Road</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTI2MzY2...</td>
      <td>2008</td>
      <td>revolutionary_road</td>
      <td>6.7</td>
      <td>194.0</td>
      <td>133.0</td>
      <td>61.0</td>
      <td>68.0</td>
      <td>6.9</td>
      <td>36.0</td>
      <td>25.0</td>
      <td>11.0</td>
      <td>69.0</td>
      <td>3.5</td>
      <td>46044.0</td>
      <td>70.0</td>
      <td>http://content8.flixster.com/movie/10/88/40/10...</td>
    </tr>
    <tr>
      <th>212579</th>
      <td>65133</td>
      <td>Blackadder Back &amp; Forth</td>
      <td>Blackadder Back &amp; Forth</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMjA5MjU4...</td>
      <td>1999</td>
      <td>blackadder-back-forth</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>http://content7.flixster.com/movie/34/10/69/34...</td>
    </tr>
  </tbody>
</table>
<p>10197 rows Ã— 20 columns</p>
</div></div></div>
</div>
<p>Now letâ€™s sort and show again:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imdb_movies</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">imdb_movies</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>title</th>
      <th>spanishTitle</th>
      <th>imdbPictureURL</th>
      <th>year</th>
      <th>rtID</th>
      <th>rtAllCriticsRating</th>
      <th>rtAllCriticsNumReviews</th>
      <th>rtAllCriticsNumFresh</th>
      <th>rtAllCriticsNumRotten</th>
      <th>rtAllCriticsScore</th>
      <th>rtTopCriticsRating</th>
      <th>rtTopCriticsNumReviews</th>
      <th>rtTopCriticsNumFresh</th>
      <th>rtTopCriticsNumRotten</th>
      <th>rtTopCriticsScore</th>
      <th>rtAudienceRating</th>
      <th>rtAudienceNumRatings</th>
      <th>rtAudienceScore</th>
      <th>rtPictureURL</th>
    </tr>
    <tr>
      <th>imdbID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>439</th>
      <td>6990</td>
      <td>The Great Train Robbery</td>
      <td>Asalto y robo al tren</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTk3OTQy...</td>
      <td>1903</td>
      <td>the-great-train-robbery1903</td>
      <td>7.6</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>http://content7.flixster.com/movie/10/87/70/10...</td>
    </tr>
    <tr>
      <th>4972</th>
      <td>7065</td>
      <td>The Birth of a Nation</td>
      <td>El nacimiento de una naciÃ³n</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMjI2MzU4...</td>
      <td>1915</td>
      <td>birth_of_a_nation</td>
      <td>8.0</td>
      <td>31.0</td>
      <td>31.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>3.3</td>
      <td>1249.0</td>
      <td>58.0</td>
      <td>http://content9.flixster.com/movie/10/88/58/10...</td>
    </tr>
    <tr>
      <th>6864</th>
      <td>7243</td>
      <td>Intolerance: Love's Struggle Throughout the Ages</td>
      <td>Intolerancia</td>
      <td>http://ia.media-imdb.com/images/M/MV5BODEyNDUy...</td>
      <td>1916</td>
      <td>1010644-intolerance</td>
      <td>7.8</td>
      <td>23.0</td>
      <td>22.0</td>
      <td>1.0</td>
      <td>95.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>3.8</td>
      <td>1397.0</td>
      <td>77.0</td>
      <td>http://content6.flixster.com/movie/31/14/31140...</td>
    </tr>
    <tr>
      <th>8133</th>
      <td>8511</td>
      <td>The Immigrant</td>
      <td>Charlot emigrante</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMjExNDE5...</td>
      <td>1917</td>
      <td>immigrant</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>http://content7.flixster.com/movie/10/85/69/10...</td>
    </tr>
    <tr>
      <th>8395</th>
      <td>48374</td>
      <td>Otets Sergiy</td>
      <td>El padre Sergio</td>
      <td>NaN</td>
      <td>1917</td>
      <td>otets-sergiy-father-sergius</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>http://content7.flixster.com/movie/10/91/43/10...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1229827</th>
      <td>4260</td>
      <td>Jonas Brothers: The 3D Concert Experience</td>
      <td>Jonas Brothers: The 3D Concert Experience</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTU3NzE4...</td>
      <td>2009</td>
      <td>jonas_brothers_3d</td>
      <td>4.2</td>
      <td>71.0</td>
      <td>16.0</td>
      <td>55.0</td>
      <td>22.0</td>
      <td>4.6</td>
      <td>22.0</td>
      <td>7.0</td>
      <td>15.0</td>
      <td>31.0</td>
      <td>3.3</td>
      <td>74109.0</td>
      <td>64.0</td>
      <td>http://content7.flixster.com/movie/10/92/39/10...</td>
    </tr>
    <tr>
      <th>1233247</th>
      <td>757</td>
      <td>Dung che sai duk</td>
      <td>Este contraveneno del Oeste</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTc0NzMx...</td>
      <td>1994</td>
      <td>ashes_of_time_redux</td>
      <td>6.6</td>
      <td>69.0</td>
      <td>54.0</td>
      <td>15.0</td>
      <td>78.0</td>
      <td>6.7</td>
      <td>18.0</td>
      <td>14.0</td>
      <td>4.0</td>
      <td>77.0</td>
      <td>3.6</td>
      <td>2166.0</td>
      <td>71.0</td>
      <td>http://content8.flixster.com/movie/10/93/19/10...</td>
    </tr>
    <tr>
      <th>1233381</th>
      <td>63698</td>
      <td>ÃœÃ§ maymun</td>
      <td>Tres monos</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTMwNjM3...</td>
      <td>2008</td>
      <td>three_monkeys</td>
      <td>6.7</td>
      <td>56.0</td>
      <td>43.0</td>
      <td>13.0</td>
      <td>76.0</td>
      <td>7.7</td>
      <td>13.0</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>92.0</td>
      <td>3.6</td>
      <td>1239.0</td>
      <td>72.0</td>
      <td>http://content8.flixster.com/movie/11/13/29/11...</td>
    </tr>
    <tr>
      <th>1275532</th>
      <td>4457</td>
      <td>Bianca Beauchamp All Access 2: Rubberized</td>
      <td>Bianca Beauchamp All Access 2: Rubberized</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTI1ODQ1...</td>
      <td>2008</td>
      <td>bianca-beauchamp-all-access-2-rubberized</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>http://content6.flixster.com/movie/10/88/44/10...</td>
    </tr>
    <tr>
      <th>1349938</th>
      <td>418</td>
      <td>Being Human</td>
      <td>Being Human</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMjA1MzIw...</td>
      <td>2008</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>10197 rows Ã— 20 columns</p>
</div></div></div>
</div>
<p>Now the index reports that itâ€™s sorted too:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imdb_movies</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_monotonic</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="reindexing">
<h3>Reindexing<a class="headerlink" href="#reindexing" title="Permalink to this headline">Â¶</a></h3>
<p>Another operation on an index is a <em>reindex</em>.  When we reindex a data frame or series, we give it an array of key values, and it rearranges elements to correspond to the new array.  It will insert missing values for keys that donâ€™t exist in the original frame.</p>
<p>So letâ€™s reindex the movie frame (we are <em>not</em> passing <code class="docutils literal notranslate"><span class="pre">inplace</span></code>, so itâ€™s going to return a new frame):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">2038401</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>imdbID</th>
      <th>spanishTitle</th>
      <th>imdbPictureURL</th>
      <th>year</th>
      <th>rtID</th>
      <th>rtAllCriticsRating</th>
      <th>rtAllCriticsNumReviews</th>
      <th>rtAllCriticsNumFresh</th>
      <th>rtAllCriticsNumRotten</th>
      <th>rtAllCriticsScore</th>
      <th>rtTopCriticsRating</th>
      <th>rtTopCriticsNumReviews</th>
      <th>rtTopCriticsNumFresh</th>
      <th>rtTopCriticsNumRotten</th>
      <th>rtTopCriticsScore</th>
      <th>rtAudienceRating</th>
      <th>rtAudienceNumRatings</th>
      <th>rtAudienceScore</th>
      <th>rtPictureURL</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Toy story</td>
      <td>114709.0</td>
      <td>Toy story (juguetes)</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTMwNDU0...</td>
      <td>1995.0</td>
      <td>toy_story</td>
      <td>9.0</td>
      <td>73.0</td>
      <td>73.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>8.5</td>
      <td>17.0</td>
      <td>17.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>3.7</td>
      <td>102338.0</td>
      <td>81.0</td>
      <td>http://content7.flixster.com/movie/10/93/63/10...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Heat</td>
      <td>113277.0</td>
      <td>Heat</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTM1NDc4...</td>
      <td>1995.0</td>
      <td>1068182-heat</td>
      <td>7.7</td>
      <td>58.0</td>
      <td>50.0</td>
      <td>8.0</td>
      <td>86.0</td>
      <td>7.2</td>
      <td>17.0</td>
      <td>14.0</td>
      <td>3.0</td>
      <td>82.0</td>
      <td>3.9</td>
      <td>42785.0</td>
      <td>92.0</td>
      <td>http://content9.flixster.com/movie/26/80/26809...</td>
    </tr>
    <tr>
      <th>101</th>
      <td>Bottle Rocket</td>
      <td>115734.0</td>
      <td>LadrÃ³n que roba a otro ladrÃ³n</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTk1ODI3...</td>
      <td>1996.0</td>
      <td>bottle_rocket</td>
      <td>6.6</td>
      <td>42.0</td>
      <td>33.0</td>
      <td>9.0</td>
      <td>78.0</td>
      <td>6.1</td>
      <td>9.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>55.0</td>
      <td>3.7</td>
      <td>16217.0</td>
      <td>80.0</td>
      <td>http://content6.flixster.com/movie/26/73/26732...</td>
    </tr>
    <tr>
      <th>2038401</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>There is no movie 2038401, so it fills in <code class="docutils literal notranslate"><span class="pre">NaN</span></code> everywhere.</p>
</div>
<div class="section" id="alignment">
<h3>Alignment<a class="headerlink" href="#alignment" title="Permalink to this headline">Â¶</a></h3>
<p>Another useful operation is <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.align.html"><code class="docutils literal notranslate"><span class="pre">align</span></code></a>.
It reindexes <em>two</em> series so that their indexes match, and we can then perform more operations on them.
When you do vectorized operations on two series, Pandas first aligns their indexes and then does the operation on the corresponding values.</p>
<p>For example, we can treat usersâ€™ ratings as item-dimensional <em>vectors</em>, and compute the cosine as a measure of how similar their ratings are.</p>
<div class="math notranslate nohighlight">
\[\mathrm{cos}(\vec{x}, \vec{y}) = \frac{\vec{x} \cdot \vec{y}}{\|\vec{x}\|_2 \|\vec{x}\|_2}\]</div>
<p>First, letâ€™s get the rating vectors for two users:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u1_rates</span> <span class="o">=</span> <span class="n">idx_ratings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">75</span><span class="p">,</span> <span class="s1">&#39;rating&#39;</span><span class="p">]</span>
<span class="n">u2_rates</span> <span class="o">=</span> <span class="n">idx_ratings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">190</span><span class="p">,</span> <span class="s1">&#39;rating&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Letâ€™s multiply their ratings - Pandas will automatically align them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u12_mult</span> <span class="o">=</span> <span class="n">u1_rates</span> <span class="o">*</span> <span class="n">u2_rates</span>
<span class="n">u12_mult</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    22.000000
mean     13.534091
std       6.139400
min       2.250000
25%      12.062500
50%      15.375000
75%      17.500000
max      22.500000
Name: rating, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u12_mult</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>movieID
1         NaN
2         NaN
3         NaN
7         NaN
32       13.5
         ... 
54001     NaN
54259     NaN
58559     NaN
59315     NaN
64497     NaN
Name: rating, Length: 329, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>There are 22 values that arenâ€™t <code class="docutils literal notranslate"><span class="pre">NaN</span></code> - those are the values where both users have a rating.  This is because the alignment fills in NaN, and NaN times a rating value is NaN.</p>
<p>To finish the cosine, we can compute the sum of this, and the norms of the two vectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">u12_mult</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">spla</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">u1_rates</span><span class="p">)</span> <span class="o">*</span> <span class="n">spla</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">u2_rates</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.19577120060037112
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">scipy.linalg.norm</span></code> function computes the Euclidean norm <span class="math notranslate nohighlight">\(\| \cdot \|_2\)</span>.</p>
<p>But what does this alignment do?  We can do it ourselves with <code class="docutils literal notranslate"><span class="pre">.align</span></code>. First letâ€™s look at our vectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u1_rates</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>movieID
3        1.0
32       4.5
110      4.0
160      2.0
163      4.0
165      4.5
173      3.5
296      5.0
353      3.5
420      2.0
589      4.0
653      3.0
832      4.5
920      0.5
996      4.5
1036     4.0
1127     3.5
1215     4.5
1233     4.0
1304     2.5
1370     4.0
1374     4.0
1485     4.0
1527     4.5
1917     2.5
2011     2.0
2054     1.5
2058     4.0
2490     4.0
2571     4.5
2640     3.0
2688     3.0
2700     4.5
2762     3.5
2959     4.5
3258     1.5
3793     3.0
3889     3.0
3994     3.5
4993     3.5
5107     3.0
5833     2.5
5952     3.5
6213     4.0
6225     0.5
6333     4.0
7000     3.5
7007     4.5
7153     3.5
32029    4.5
32587    5.0
33437    3.5
39052    3.5
45431    3.5
45722    4.5
Name: rating, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u2_rates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>movieID
1        4.5
2        4.0
7        2.0
32       3.0
95       2.0
        ... 
54001    4.5
54259    4.0
58559    4.5
59315    4.0
64497    3.0
Name: rating, Length: 296, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">align</span></code> method returns a tuple of the aligned series:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u1a</span><span class="p">,</span> <span class="n">u2a</span> <span class="o">=</span> <span class="n">u1_rates</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">u2_rates</span><span class="p">)</span>
<span class="n">u1a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>movieID
1        NaN
2        NaN
3        1.0
7        NaN
32       4.5
        ... 
54001    NaN
54259    NaN
58559    NaN
59315    NaN
64497    NaN
Name: rating, Length: 329, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u2a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>movieID
1        4.5
2        4.0
3        NaN
7        2.0
32       3.0
        ... 
54001    4.5
54259    4.0
58559    4.5
59315    4.0
64497    3.0
Name: rating, Length: 329, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>They now have the same index, and the values are put in place.  Missing values are filled in with <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.  These vectors are now ready to be multipled, or have other operations applied!</p>
</div>
</div>
<div class="section" id="index-gotchas">
<h2>Index Gotchas<a class="headerlink" href="#index-gotchas" title="Permalink to this headline">Â¶</a></h2>
<p>Indexes do <em>not</em> have to be unique - the same key can be in multiple rows.</p>
<p>I donâ€™t recommend using non-unique indexes.  They often arenâ€™t terribly useful, and they very quickly get <em>slow</em>.</p>
<p>As described above, hierarchical indexes also have problems, particularly with <code class="docutils literal notranslate"><span class="pre">groupby</span></code>.  They can eat an incredible amount of memory, send your system deep into swap, and slow it to a crawl.</p>
</div>
<div class="section" id="learning-more">
<h2>Learning More<a class="headerlink" href="#learning-more" title="Permalink to this headline">Â¶</a></h2>
<ul class="simple">
<li><p>The textbook</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/user_guide/indexing.html">Indexing and Selecting Data</a> in the Pandas user guide</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/user_guide/advanced.html">MultiIndex / Advanced Indexing</a> in the Pandas user guide</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./resources\tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../Functions/" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Writing Functions</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../LogitRegressionDemo/" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Logistic Regression Demo</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Michael D. Ekstrand<br/>
        
            &copy; <a href="../../../copyright/">Copyright</a> 2021.<br/>
          <div class="extra_footer">
            <script data-goatcounter="https://cs533.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>