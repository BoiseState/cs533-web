
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reshaping Data &#8212; CS 533 Fall 2021</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/fonts.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/tabinsert.js"></script>
    <script src="../../../_static/urlclean.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "mdekstrand/cs533-web");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../../_static/logo.png"/>
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />
    <link rel="copyright" title="Copyright" href="../../../copyright/" />
    <link rel="next" title="Sampling Distributions" href="../SamplingDists/" />
    <link rel="prev" title="Regressions" href="../Regressions/" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../">
      
      
      
      <h1 class="site-logo" id="site-title">CS 533 Fall 2021</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search/" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../">
   CS 533 Homepage
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course Info
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../syllabus/">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../schedule/">
   Schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../glossary/">
   Glossary
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Content
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week0/">
   Week 0 — Pre-Class Welcome
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../week1/">
   Week 1 — Questions (8/23–27)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../week1/DemoNotebook/">
     Demo Notebook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../week1/1-7-types-operations/">
     Data Types and Operations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../week2/">
   Week 2 — Description (8/30–9/3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../week2/2-2-PandasBasics/">
     Introducing Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../week2/2-4-AggregatesAndGroups/">
     Aggregates and Groups
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../week2/2-6-DescribingDistributions/">
     Describing Distributions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../week3/">
   Week 3 — Presentation (9/6–10)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../week3/3-6-ChartsFromTheGroundUp/">
     Drawing Charts
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week4/">
   Week 4 — Inference (9/13–17)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week5/">
   Week 5 — Filling In (9/20–24)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week6/">
   Week 6 — Two Variables (Sep. 27–Oct. 1)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week7/">
   Week 7 — Getting Data (Oct. 4–8)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week8/">
   Week 8 — Regression (Oct. 11–15)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week9/">
   Week 9 — Models &amp; Prediction (Oct. 18–22)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week10/">
   Week 10 — Classification (10/25–29)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week11/">
   Week 11 — More Modeling (11/1–5)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week12/">
   Week 12 — Text (11/8–12)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week13/">
   Week 13 — Unsupervised (11/15–19)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week14/">
   Week 14 — Workflow (11/29–12/3)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../week15/">
   Week 15 — What Next? (12/6–10)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/">
   Rubric
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../assignments/A0/">
   Assignment 0
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../assignments/A0/A0-Notebook/">
     CS 533 Assignment 0
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A1/">
   Assignment 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A2/">
   Assignment 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A3/">
   Assignment 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A4/">
   Assignment 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A5/">
   Assignment 5
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A6/">
   Assignment 6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../assignments/A7/">
   Assignment 7
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Resources
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../software/">
   Software and Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../documentation/">
   Documentation &amp; Reading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../data/">
   Data Sets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebook-checklist/">
   Notebook Checklist &amp; Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../probability/">
   Notes on Probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../problems/">
   Common Problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../onyx/">
   Remotely Using Onyx
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../git-resources/">
   Git Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../environments/">
   Software Environments
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../">
   Tutorials
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../AdvancedPipeline/">
     Advanced Pipeline Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../BooleanSeries/">
     Tricks with Boolean Series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../BuildingData/">
     Building Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ChartFinishingTouches/">
     Finishing Touches
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Charting/">
     Drawing Charts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ClusteringExample/">
     Clustering Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Correlation/">
     Correlation and Basic Linear Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../CriticScores/">
     Charting Movie Scores
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Distributions/">
     Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../EmpiricalProbabilities/">
     Empirical Probabilities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../FetchCHIPapers/">
     Bibliography Fetch
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../FunWithNumbers/">
     Fun with Numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Functions/">
     Writing Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Indexing/">
     Indexing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../LogitRegressionDemo/">
     Logistic Regression Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MLTimeSeries/">
     MovieLens Time Series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MinimizeRegression/">
     Rebuilding Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MissingData/">
     Missing Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MovieDecomp/">
     Movie Matrix Decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../OneSample/">
     One Sample
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../OverfittingSimulation/">
     Overfitting Simulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../PCADemo/">
     PCA Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../PenguinSamples/">
     Sampling and Testing the Penguins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Regressions/">
     Regressions
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Reshaping Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SamplingDists/">
     Sampling Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SciKitLogistic/">
     SciKit Logistic Regression Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SciKitPipeline/">
     SciKit Pipeline and Transform Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SciKitRegression/">
     SciKit-Learn Linear Regression Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SciKitTransform/">
     SciKit Transformations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Selection/">
     Selecting Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sessions/">
     Sessionization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SpamFilter/">
     Spam Detector Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../TuningExample/">
     Tuning Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../UsingTheCensus/">
     Using Census Data
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Site Details
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../copyright/">
   Copyright and License
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/resources/tutorials/Reshaping.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/mdekstrand/cs533-web"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/mdekstrand/cs533-web/issues/new?title=Issue%20on%20page%20%2Fresources/tutorials/Reshaping.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/mdekstrand/cs533-web/edit/main/resources/tutorials/Reshaping.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#movies">
     Movies
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#movie-info">
     Movie Info
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ratings">
     Ratings
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grouping-and-aggregating">
   Grouping and Aggregating
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#aggregate-to-series">
     Aggregate to Series
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiple-aggregates">
     Multiple Aggregates
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#counting-values">
     Counting Values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiple-columns">
     Multiple Columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-grouping-modes">
     Other Grouping Modes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#joining-frames">
   Joining Frames
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#column-join">
     Column Join
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#column-index-join">
     Column/Index Join
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#index-index-join">
     Index/Index Join
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#join-types">
     Join Types
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#join-tips">
     Join Tips
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tall-and-wide">
   Tall and Wide
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tall-to-wide">
     Tall to Wide
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stacking-frames">
   Stacking Frames
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wide-to-tall">
     Wide to Tall
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="reshaping-data">
<h1>Reshaping Data<a class="headerlink" href="#reshaping-data" title="Permalink to this headline">¶</a></h1>
<p>This notebook discusses operations to <em>reshape</em> data:</p>
<ol class="simple">
<li><p>Collapsing rows through aggregates</p></li>
<li><p>Joining data frames together (basic joins)</p></li>
<li><p>Pivoting between wide and long formats</p></li>
</ol>
<p>The <a class="reference internal" href="../Selection/"><span class="doc std std-doc">Selection</span></a> notebook discussed how to select subsets of rows or columns; these operations will change what the rows and columns are, or add new items.</p>
<p>This notebook uses the “MovieLens + IMDB/RottenTomatoes” data from the <a class="reference external" href="https://grouplens.org/datasets/hetrec-2011/">HETREC data</a>.</p>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>First we will import our modules:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<p>Then import the HETREC MovieLens data.  A few notes:</p>
<ul class="simple">
<li><p>Tab-separated data</p></li>
<li><p>Not UTF-8 - latin-1 encoding seems to work</p></li>
<li><p>Missing data encoded as <code class="docutils literal notranslate"><span class="pre">\N</span></code> (there’s a good chance that what we have is a PostgreSQL data dump!)</p></li>
</ul>
<div class="section" id="movies">
<h3>Movies<a class="headerlink" href="#movies" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hetrec2011-ml/movies.dat&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">N&#39;</span><span class="p">])</span>
<span class="n">movies</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>title</th>
      <th>imdbID</th>
      <th>spanishTitle</th>
      <th>imdbPictureURL</th>
      <th>year</th>
      <th>rtID</th>
      <th>rtAllCriticsRating</th>
      <th>rtAllCriticsNumReviews</th>
      <th>rtAllCriticsNumFresh</th>
      <th>...</th>
      <th>rtAllCriticsScore</th>
      <th>rtTopCriticsRating</th>
      <th>rtTopCriticsNumReviews</th>
      <th>rtTopCriticsNumFresh</th>
      <th>rtTopCriticsNumRotten</th>
      <th>rtTopCriticsScore</th>
      <th>rtAudienceRating</th>
      <th>rtAudienceNumRatings</th>
      <th>rtAudienceScore</th>
      <th>rtPictureURL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Toy story</td>
      <td>114709</td>
      <td>Toy story (juguetes)</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTMwNDU0...</td>
      <td>1995</td>
      <td>toy_story</td>
      <td>9.0</td>
      <td>73.0</td>
      <td>73.0</td>
      <td>...</td>
      <td>100.0</td>
      <td>8.5</td>
      <td>17.0</td>
      <td>17.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>3.7</td>
      <td>102338.0</td>
      <td>81.0</td>
      <td>http://content7.flixster.com/movie/10/93/63/10...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Jumanji</td>
      <td>113497</td>
      <td>Jumanji</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMzM5NjE1...</td>
      <td>1995</td>
      <td>1068044-jumanji</td>
      <td>5.6</td>
      <td>28.0</td>
      <td>13.0</td>
      <td>...</td>
      <td>46.0</td>
      <td>5.8</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>40.0</td>
      <td>3.2</td>
      <td>44587.0</td>
      <td>61.0</td>
      <td>http://content8.flixster.com/movie/56/79/73/56...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Grumpy Old Men</td>
      <td>107050</td>
      <td>Dos viejos gruñones</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTI5MTgy...</td>
      <td>1993</td>
      <td>grumpy_old_men</td>
      <td>5.9</td>
      <td>36.0</td>
      <td>24.0</td>
      <td>...</td>
      <td>66.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>83.0</td>
      <td>3.2</td>
      <td>10489.0</td>
      <td>66.0</td>
      <td>http://content6.flixster.com/movie/25/60/25602...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Waiting to Exhale</td>
      <td>114885</td>
      <td>Esperando un respiro</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTczMTMy...</td>
      <td>1995</td>
      <td>waiting_to_exhale</td>
      <td>5.6</td>
      <td>25.0</td>
      <td>14.0</td>
      <td>...</td>
      <td>56.0</td>
      <td>5.5</td>
      <td>11.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>45.0</td>
      <td>3.3</td>
      <td>5666.0</td>
      <td>79.0</td>
      <td>http://content9.flixster.com/movie/10/94/17/10...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Father of the Bride Part II</td>
      <td>113041</td>
      <td>Vuelve el padre de la novia (Ahora también abu...</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTg1NDc2...</td>
      <td>1995</td>
      <td>father_of_the_bride_part_ii</td>
      <td>5.3</td>
      <td>19.0</td>
      <td>9.0</td>
      <td>...</td>
      <td>47.0</td>
      <td>5.4</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>20.0</td>
      <td>3.0</td>
      <td>13761.0</td>
      <td>64.0</td>
      <td>http://content8.flixster.com/movie/25/54/25542...</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10197 entries, 0 to 10196
Data columns (total 21 columns):
 #   Column                  Non-Null Count  Dtype  
---  ------                  --------------  -----  
 0   id                      10197 non-null  int64  
 1   title                   10197 non-null  object 
 2   imdbID                  10197 non-null  int64  
 3   spanishTitle            10197 non-null  object 
 4   imdbPictureURL          10016 non-null  object 
 5   year                    10197 non-null  int64  
 6   rtID                    9886 non-null   object 
 7   rtAllCriticsRating      9967 non-null   float64
 8   rtAllCriticsNumReviews  9967 non-null   float64
 9   rtAllCriticsNumFresh    9967 non-null   float64
 10  rtAllCriticsNumRotten   9967 non-null   float64
 11  rtAllCriticsScore       9967 non-null   float64
 12  rtTopCriticsRating      9967 non-null   float64
 13  rtTopCriticsNumReviews  9967 non-null   float64
 14  rtTopCriticsNumFresh    9967 non-null   float64
 15  rtTopCriticsNumRotten   9967 non-null   float64
 16  rtTopCriticsScore       9967 non-null   float64
 17  rtAudienceRating        9967 non-null   float64
 18  rtAudienceNumRatings    9967 non-null   float64
 19  rtAudienceScore         9967 non-null   float64
 20  rtPictureURL            9967 non-null   object 
dtypes: float64(13), int64(3), object(5)
memory usage: 1.6+ MB
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="movie-info">
<h3>Movie Info<a class="headerlink" href="#movie-info" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movie_genres</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hetrec2011-ml/movie_genres.dat&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span><span class="p">)</span>
<span class="n">movie_genres</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movieID</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Adventure</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Animation</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Children</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Comedy</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Fantasy</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movie_tags</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hetrec2011-ml/movie_tags.dat&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span><span class="p">)</span>
<span class="n">movie_tags</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movieID</th>
      <th>tagID</th>
      <th>tagWeight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>13</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>25</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>55</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>60</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tags</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hetrec2011-ml/tags.dat&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span><span class="p">)</span>
<span class="n">tags</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>earth</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>police</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>boxing</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>painter</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>whale</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="ratings">
<h3>Ratings<a class="headerlink" href="#ratings" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hetrec2011-ml/user_ratedmovies-timestamps.dat&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span><span class="p">)</span>
<span class="n">ratings</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userID</th>
      <th>movieID</th>
      <th>rating</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>75</td>
      <td>3</td>
      <td>1.0</td>
      <td>1162160236000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>75</td>
      <td>32</td>
      <td>4.5</td>
      <td>1162160624000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>75</td>
      <td>110</td>
      <td>4.0</td>
      <td>1162161008000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>75</td>
      <td>160</td>
      <td>2.0</td>
      <td>1162160212000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>75</td>
      <td>163</td>
      <td>4.0</td>
      <td>1162160970000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="grouping-and-aggregating">
<h2>Grouping and Aggregating<a class="headerlink" href="#grouping-and-aggregating" title="Permalink to this headline">¶</a></h2>
<p>The group and aggregate operations allow us to collapse multiple rows, that share a common value in one or more columns (the <em>grouping key</em>), into a single row.
There are three pieces of a group-aggregate operation:</p>
<ul class="simple">
<li><p>The grouping key — one or more columns that are used to identify which rows are in the same group</p></li>
<li><p>The column(s) to aggregate</p></li>
<li><p>The aggregate function(s) to apply</p></li>
</ul>
<p>A group/aggregate operation transforms a data frames using thes columns as follows:</p>
<ul class="simple">
<li><p>Each <em>unique combination</em> of values in the <strong>grouping key</strong> becomes <em>one row</em>.  If the grouping key is one column, this means each distinct value of the grouping column will yield one row in the final results.</p></li>
<li><p>The <strong>columns to aggregate</strong> are collapsed into a single value using the specified aggregate function(s).</p></li>
<li><p>Other columns are ignored and do not appear in the output.</p></li>
</ul>
<div class="section" id="aggregate-to-series">
<h3>Aggregate to Series<a class="headerlink" href="#aggregate-to-series" title="Permalink to this headline">¶</a></h3>
<p><strong>If we have:</strong> a data frame<br />
<strong>And we have:</strong> a column identifying each observation’s group membership<br />
<strong>And we want:</strong> a series with an entry for each group, whose value is an aggregate function of another column<br />
<strong>Then we can:</strong> use <code class="docutils literal notranslate"><span class="pre">groupby</span></code> with one column and the aggregate function.</p>
<p>For example, if we want to find the timestamp of the first rating for each movie, we can group the ratings table by <code class="docutils literal notranslate"><span class="pre">movieID</span></code> and take the <code class="docutils literal notranslate"><span class="pre">min</span></code> of the <code class="docutils literal notranslate"><span class="pre">timestamp</span></code> column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratings</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;movieID&#39;</span><span class="p">)[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>movieID
1         876894948000
2         891835167000
3         931525286000
4         951680805000
5         874593700000
             ...      
65088    1230851753000
65091    1230918649000
65126    1231028759000
65130    1231061731000
65133    1231034528000
Name: timestamp, Length: 10109, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>This breaks down into a few pieces.  The <code class="docutils literal notranslate"><span class="pre">groupby</span></code> method returns a group-by object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratings</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;movieID&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x00000270239AA7F0&gt;
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> is a iterable over <code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">df)</span></code> tuples, where <code class="docutils literal notranslate"><span class="pre">key</span></code> is a single value of the grouping key, and <code class="docutils literal notranslate"><span class="pre">df</span></code> is a data frame containing the group’s data (the <code class="docutils literal notranslate"><span class="pre">next</span></code> function gets the next value of an iterable):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">ratings</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;movieID&#39;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1,
         userID  movieID  rating      timestamp
 556        170        1     3.0  1162208198000
 639        175        1     4.0  1133674606000
 915        190        1     4.5  1057778398000
 1211       267        1     2.5  1084284499000
 1643       325        1     4.0  1134939391000
 ...        ...      ...     ...            ...
 850646   71420        1     5.0   948256089000
 852838   71483        1     4.0  1035837220000
 853507   71497        1     5.0  1188256917000
 853757   71509        1     4.0  1018636872000
 855327   71529        1     4.5  1162098801000
 
 [1263 rows x 4 columns])
</pre></div>
</div>
</div>
</div>
<p>The column selection yields a <code class="docutils literal notranslate"><span class="pre">SeriesGroupBy</span></code>, which is a group-by for a series instead of a frame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratings</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;movieID&#39;</span><span class="p">)[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.generic.SeriesGroupBy object at 0x00000270239AAD30&gt;
</pre></div>
</div>
</div>
</div>
<p>Finally, calling <code class="docutils literal notranslate"><span class="pre">min</span></code> on this will apply the <code class="docutils literal notranslate"><span class="pre">min</span></code> function to each group, and put the results together into a series.</p>
</div>
<div class="section" id="multiple-aggregates">
<h3>Multiple Aggregates<a class="headerlink" href="#multiple-aggregates" title="Permalink to this headline">¶</a></h3>
<p><strong>If we have:</strong> a data frame<br />
<strong>And we have:</strong> a column identifying each observation’s group membership<br />
<strong>And we want:</strong> a data frame with an entry for each group, with a column for each of one or more aggregate functions of a column<br />
<strong>Then we can:</strong> use <code class="docutils literal notranslate"><span class="pre">groupby</span></code> with one column and the <code class="docutils literal notranslate"><span class="pre">.agg</span></code> method with aggregate function names</p>
<p>For example, if we want to find the timestamp of the first rating and last ratings for each movie, we can group the ratings table by <code class="docutils literal notranslate"><span class="pre">movieID</span></code> and take the <code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code> of the <code class="docutils literal notranslate"><span class="pre">timestamp</span></code> column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratings</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;movieID&#39;</span><span class="p">)[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min</th>
      <th>max</th>
    </tr>
    <tr>
      <th>movieID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>876894948000</td>
      <td>1231030405000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>891835167000</td>
      <td>1231030891000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>931525286000</td>
      <td>1231099805000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>951680805000</td>
      <td>1229214105000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>874593700000</td>
      <td>1230915209000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>65088</th>
      <td>1230851753000</td>
      <td>1230851753000</td>
    </tr>
    <tr>
      <th>65091</th>
      <td>1230918649000</td>
      <td>1230918649000</td>
    </tr>
    <tr>
      <th>65126</th>
      <td>1231028759000</td>
      <td>1231097168000</td>
    </tr>
    <tr>
      <th>65130</th>
      <td>1231061731000</td>
      <td>1231061731000</td>
    </tr>
    <tr>
      <th>65133</th>
      <td>1231034528000</td>
      <td>1231129793000</td>
    </tr>
  </tbody>
</table>
<p>10109 rows × 2 columns</p>
</div></div></div>
</div>
<p>Note that in both cases, the resulting frame or series is indexed by the grouping column.</p>
<blockquote>
<div><p><em>Practice: compute the mean and count of the ratings for each movie</em></p>
</div></blockquote>
</div>
<div class="section" id="counting-values">
<h3>Counting Values<a class="headerlink" href="#counting-values" title="Permalink to this headline">¶</a></h3>
<p>There’s a useful special case of grouped aggregation - counting how many times each distinct value in a column appears.</p>
<p><strong>If we have:</strong> a series<br />
<strong>And we want:</strong> a series whose index keys are the values of the original series, and whose values are the number of times each value appeared in the original series<br />
<strong>Then we can:</strong> use the <code class="docutils literal notranslate"><span class="pre">value_counts</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratings</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.0    215773
3.0    155918
3.5    150582
4.5     88652
5.0     71680
2.5     62454
2.0     57188
1.0     21535
1.5     18328
0.5     13488
Name: rating, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We can also sort the results with the <code class="docutils literal notranslate"><span class="pre">sort_index</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratings</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5     13488
1.0     21535
1.5     18328
2.0     57188
2.5     62454
3.0    155918
3.5    150582
4.0    215773
4.5     88652
5.0     71680
Name: rating, dtype: int64
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">sort_index</span></code> applies to both series and data frames.</p>
</div>
<div class="section" id="multiple-columns">
<h3>Multiple Columns<a class="headerlink" href="#multiple-columns" title="Permalink to this headline">¶</a></h3>
<p>We can also compute an aggregate over multiple columns at the same time.  For example, if we want to look at the mean critic and audience scores of movies over time, we can group movies by year and take the mean of multiple columns.</p>
<p><strong>If we have:</strong> a data frame<br />
<strong>And we have:</strong> one or more columns identifying group membership<br />
<strong>And we want:</strong> a data frame with the same aggregate computed over all other columns in the frame<br />
<strong>Then we can:</strong> apply <code class="docutils literal notranslate"><span class="pre">groupby</span></code> and the aggregate function without selecting columns.</p>
<p>We’re first going to select and rename columns, like we did at the end of the <a class="reference internal" href="../Selection/"><span class="doc std std-doc">Selection notebook</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movie_scores</span> <span class="o">=</span> <span class="n">movies</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)[[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;rtAllCriticsRating&#39;</span><span class="p">,</span> <span class="s1">&#39;rtTopCriticsRating&#39;</span><span class="p">,</span> <span class="s1">&#39;rtAudienceRating&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;rtAllCriticsRating&#39;</span><span class="p">:</span> <span class="s1">&#39;All Critics&#39;</span><span class="p">,</span>
    <span class="s1">&#39;rtTopCriticsRating&#39;</span><span class="p">:</span> <span class="s1">&#39;Top Critics&#39;</span><span class="p">,</span>
    <span class="s1">&#39;rtAudienceRating&#39;</span><span class="p">:</span> <span class="s1">&#39;Audience&#39;</span>
<span class="p">})</span>
<span class="n">movie_scores</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>All Critics</th>
      <th>Top Critics</th>
      <th>Audience</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1995</td>
      <td>9.0</td>
      <td>8.5</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1995</td>
      <td>5.6</td>
      <td>5.8</td>
      <td>3.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1993</td>
      <td>5.9</td>
      <td>7.0</td>
      <td>3.2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1995</td>
      <td>5.6</td>
      <td>5.5</td>
      <td>3.3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1995</td>
      <td>5.3</td>
      <td>5.4</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>65088</th>
      <td>2008</td>
      <td>4.4</td>
      <td>4.7</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>65091</th>
      <td>1934</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>65126</th>
      <td>2008</td>
      <td>5.6</td>
      <td>4.9</td>
      <td>3.3</td>
    </tr>
    <tr>
      <th>65130</th>
      <td>2008</td>
      <td>6.7</td>
      <td>6.9</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>65133</th>
      <td>1999</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>10197 rows × 4 columns</p>
</div></div></div>
</div>
<p>Now we’re going to do the group-by operation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year_scores</span> <span class="o">=</span> <span class="n">movie_scores</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">year_scores</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>All Critics</th>
      <th>Top Critics</th>
      <th>Audience</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1903</th>
      <td>7.600000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1915</th>
      <td>8.000000</td>
      <td>0.000000</td>
      <td>3.300000</td>
    </tr>
    <tr>
      <th>1916</th>
      <td>7.800000</td>
      <td>0.000000</td>
      <td>3.800000</td>
    </tr>
    <tr>
      <th>1917</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1918</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2007</th>
      <td>5.141278</td>
      <td>4.769042</td>
      <td>3.062162</td>
    </tr>
    <tr>
      <th>2008</th>
      <td>4.699357</td>
      <td>4.383280</td>
      <td>2.853698</td>
    </tr>
    <tr>
      <th>2009</th>
      <td>4.850000</td>
      <td>4.700000</td>
      <td>3.192308</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2011</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>98 rows × 3 columns</p>
</div></div></div>
</div>
<p>There are two other equivalents to this operation.  First, the <code class="docutils literal notranslate"><span class="pre">agg</span></code> function can take one name instead of a list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movie_scores</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>All Critics</th>
      <th>Top Critics</th>
      <th>Audience</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1903</th>
      <td>7.600000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1915</th>
      <td>8.000000</td>
      <td>0.000000</td>
      <td>3.300000</td>
    </tr>
    <tr>
      <th>1916</th>
      <td>7.800000</td>
      <td>0.000000</td>
      <td>3.800000</td>
    </tr>
    <tr>
      <th>1917</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1918</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2007</th>
      <td>5.141278</td>
      <td>4.769042</td>
      <td>3.062162</td>
    </tr>
    <tr>
      <th>2008</th>
      <td>4.699357</td>
      <td>4.383280</td>
      <td>2.853698</td>
    </tr>
    <tr>
      <th>2009</th>
      <td>4.850000</td>
      <td>4.700000</td>
      <td>3.192308</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2011</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>98 rows × 3 columns</p>
</div></div></div>
</div>
<p>Second, the <code class="docutils literal notranslate"><span class="pre">agg</span></code> function can actually take a <em>function</em> as its argument:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movie_scores</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>All Critics</th>
      <th>Top Critics</th>
      <th>Audience</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1903</th>
      <td>7.600000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1915</th>
      <td>8.000000</td>
      <td>0.000000</td>
      <td>3.300000</td>
    </tr>
    <tr>
      <th>1916</th>
      <td>7.800000</td>
      <td>0.000000</td>
      <td>3.800000</td>
    </tr>
    <tr>
      <th>1917</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1918</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2007</th>
      <td>5.141278</td>
      <td>4.769042</td>
      <td>3.062162</td>
    </tr>
    <tr>
      <th>2008</th>
      <td>4.699357</td>
      <td>4.383280</td>
      <td>2.853698</td>
    </tr>
    <tr>
      <th>2009</th>
      <td>4.850000</td>
      <td>4.700000</td>
      <td>3.192308</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2011</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>98 rows × 3 columns</p>
</div></div></div>
</div>
<p>No matter which method we used, we can then quickly do a line plot, which will default to plotting each column as a different colored line, with the index on the <em>x</em> axis:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year_scores</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Mean Average Score&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Reshaping_40_0.png" src="../../../_images/Reshaping_40_0.png" />
</div>
</div>
</div>
<div class="section" id="other-grouping-modes">
<h3>Other Grouping Modes<a class="headerlink" href="#other-grouping-modes" title="Permalink to this headline">¶</a></h3>
<p>There are a couple of other ways you can use <code class="docutils literal notranslate"><span class="pre">groupby</span></code> and aggregates:</p>
<ul class="simple">
<li><p>Select multiple columns from the data frame grouper, by using a list of columns.</p></li>
<li><p>Apply a different aggregate to each function by passing a dictionary to <code class="docutils literal notranslate"><span class="pre">agg</span></code>.</p></li>
<li><p>Apply multiple aggregates to multiple columns by passing a list to <code class="docutils literal notranslate"><span class="pre">agg</span></code> <em>and</em> selecting a list of columns.  The resulting data frame has a <em>hierarchical index</em> for its columns, which is honestly a little annoying to actually use.</p></li>
<li><p>Group by multiple columns, resulting in a hierarchical index for the rows</p></li>
</ul>
<p>Experiment with these on your own!</p>
<p><strong>Note:</strong> if you use multiple columns, <em>and</em> one or more of the columns of the frame is a <code class="docutils literal notranslate"><span class="pre">Categorical</span></code>, groupby will produce a row for each <em>possible</em> value, even if one is never observed for that combination of the other grouping keys.  To turn this off, pass the <code class="docutils literal notranslate"><span class="pre">observed=True</span></code> option to <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html"><code class="docutils literal notranslate"><span class="pre">groupby</span></code></a>.</p>
</div>
</div>
<div class="section" id="joining-frames">
<h2>Joining Frames<a class="headerlink" href="#joining-frames" title="Permalink to this headline">¶</a></h2>
<p>We can <em>join</em> two frames together based on common values of one or more of their columns, possibly using indexes as well.</p>
<p>The simplest way to join two frames without any indexes is with <code class="docutils literal notranslate"><span class="pre">pd.merge</span></code>.</p>
<div class="section" id="column-join">
<h3>Column Join<a class="headerlink" href="#column-join" title="Permalink to this headline">¶</a></h3>
<p><strong>If we have:</strong> two data frames with at least one column in common<br />
<strong>And we want:</strong> a data frame with rows based on matching the column values<br />
<strong>Then we can:</strong> use <code class="docutils literal notranslate"><span class="pre">pd.merge</span></code> to join the frames.</p>
<p>For example, to combine genres with titles:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">movies</span><span class="p">[[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;movieID&#39;</span><span class="p">}),</span>
         <span class="n">movie_genres</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;movieID&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movieID</th>
      <th>title</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Toy story</td>
      <td>Adventure</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Toy story</td>
      <td>Animation</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Toy story</td>
      <td>Children</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Toy story</td>
      <td>Comedy</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Toy story</td>
      <td>Fantasy</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>20804</th>
      <td>65126</td>
      <td>Choke</td>
      <td>Comedy</td>
    </tr>
    <tr>
      <th>20805</th>
      <td>65126</td>
      <td>Choke</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>20806</th>
      <td>65130</td>
      <td>Revolutionary Road</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>20807</th>
      <td>65130</td>
      <td>Revolutionary Road</td>
      <td>Romance</td>
    </tr>
    <tr>
      <th>20808</th>
      <td>65133</td>
      <td>Blackadder Back &amp; Forth</td>
      <td>Comedy</td>
    </tr>
  </tbody>
</table>
<p>20809 rows × 3 columns</p>
</div></div></div>
</div>
<p>If there is more than one row in one table with a match for a value in the other table, it <em>duplicates</em> the other row.  So we can see that “Toy story” is duplicated, once for each genre it appears in.</p>
<p>Pull out the selection &amp; rename on <code class="docutils literal notranslate"><span class="pre">movies</span></code> into a new cell for practice, and to see what it does.</p>
</div>
<div class="section" id="column-index-join">
<h3>Column/Index Join<a class="headerlink" href="#column-index-join" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">join</span></code> method can do index-index and column-index joins.</p>
<p><strong>If we have:</strong> a data frame<br />
<strong>And we have:</strong> another data frame whose index is values appearing in a column of the first frame<br />
<strong>And we want:</strong> a frame that merges the two frames by matching column values in the first with the index keys of the second<br />
<strong>Then we can:</strong> use <code class="docutils literal notranslate"><span class="pre">.join</span></code> with the <code class="docutils literal notranslate"><span class="pre">on</span></code> option.</p>
<p>To set this up, we want something with a suitable index.  Let’s create a frame that has mean &amp; count of MovieLens user ratings:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movie_stats</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;movieID&#39;</span><span class="p">)[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">])</span>
<span class="n">movie_stats</span> <span class="o">=</span> <span class="n">movie_stats</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="s1">&#39;MeanRating&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="s1">&#39;RatingCount&#39;</span><span class="p">})</span>
<span class="n">movie_stats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MeanRating</th>
      <th>RatingCount</th>
    </tr>
    <tr>
      <th>movieID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>3.735154</td>
      <td>1263</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.976471</td>
      <td>765</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.873016</td>
      <td>252</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.577778</td>
      <td>45</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.753333</td>
      <td>225</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>65088</th>
      <td>3.500000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>65091</th>
      <td>4.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>65126</th>
      <td>3.250000</td>
      <td>2</td>
    </tr>
    <tr>
      <th>65130</th>
      <td>2.500000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>65133</th>
      <td>4.000000</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>10109 rows × 2 columns</p>
</div></div></div>
</div>
<p>This frame is indexed by movieID. Let’s combine that with movie title &amp; year info:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="p">[[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">movie_stats</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>title</th>
      <th>year</th>
      <th>MeanRating</th>
      <th>RatingCount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Toy story</td>
      <td>1995</td>
      <td>3.735154</td>
      <td>1263.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Jumanji</td>
      <td>1995</td>
      <td>2.976471</td>
      <td>765.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Grumpy Old Men</td>
      <td>1993</td>
      <td>2.873016</td>
      <td>252.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Waiting to Exhale</td>
      <td>1995</td>
      <td>2.577778</td>
      <td>45.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Father of the Bride Part II</td>
      <td>1995</td>
      <td>2.753333</td>
      <td>225.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>10192</th>
      <td>65088</td>
      <td>Bedtime Stories</td>
      <td>2008</td>
      <td>3.500000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>10193</th>
      <td>65091</td>
      <td>Manhattan Melodrama</td>
      <td>1934</td>
      <td>4.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>10194</th>
      <td>65126</td>
      <td>Choke</td>
      <td>2008</td>
      <td>3.250000</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>10195</th>
      <td>65130</td>
      <td>Revolutionary Road</td>
      <td>2008</td>
      <td>2.500000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>10196</th>
      <td>65133</td>
      <td>Blackadder Back &amp; Forth</td>
      <td>1999</td>
      <td>4.000000</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
<p>10197 rows × 5 columns</p>
</div></div></div>
</div>
<p>Note that we used the <code class="docutils literal notranslate"><span class="pre">id</span></code> column, which is in the <code class="docutils literal notranslate"><span class="pre">movies</span></code> table, as the <code class="docutils literal notranslate"><span class="pre">on</span></code> option.  Join automatically matches it with the index in <code class="docutils literal notranslate"><span class="pre">movie_stats</span></code>.</p>
</div>
<div class="section" id="index-index-join">
<h3>Index/Index Join<a class="headerlink" href="#index-index-join" title="Permalink to this headline">¶</a></h3>
<p>Let’s now see an index-index join.</p>
<p><strong>If we have:</strong> two data frames with matching indexes<br />
<strong>And we want:</strong> a frame that merges the two frames matching their index values<br />
<strong>Then we can:</strong> use <code class="docutils literal notranslate"><span class="pre">.join</span></code> with no extra options.</p>
<p>Remember that <code class="docutils literal notranslate"><span class="pre">set_index</span></code> will set an index on the <code class="docutils literal notranslate"><span class="pre">movies</span></code> frame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>imdbID</th>
      <th>spanishTitle</th>
      <th>imdbPictureURL</th>
      <th>year</th>
      <th>rtID</th>
      <th>rtAllCriticsRating</th>
      <th>rtAllCriticsNumReviews</th>
      <th>rtAllCriticsNumFresh</th>
      <th>rtAllCriticsNumRotten</th>
      <th>rtAllCriticsScore</th>
      <th>rtTopCriticsRating</th>
      <th>rtTopCriticsNumReviews</th>
      <th>rtTopCriticsNumFresh</th>
      <th>rtTopCriticsNumRotten</th>
      <th>rtTopCriticsScore</th>
      <th>rtAudienceRating</th>
      <th>rtAudienceNumRatings</th>
      <th>rtAudienceScore</th>
      <th>rtPictureURL</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Toy story</td>
      <td>114709</td>
      <td>Toy story (juguetes)</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTMwNDU0...</td>
      <td>1995</td>
      <td>toy_story</td>
      <td>9.0</td>
      <td>73.0</td>
      <td>73.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>8.5</td>
      <td>17.0</td>
      <td>17.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>3.7</td>
      <td>102338.0</td>
      <td>81.0</td>
      <td>http://content7.flixster.com/movie/10/93/63/10...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jumanji</td>
      <td>113497</td>
      <td>Jumanji</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMzM5NjE1...</td>
      <td>1995</td>
      <td>1068044-jumanji</td>
      <td>5.6</td>
      <td>28.0</td>
      <td>13.0</td>
      <td>15.0</td>
      <td>46.0</td>
      <td>5.8</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>40.0</td>
      <td>3.2</td>
      <td>44587.0</td>
      <td>61.0</td>
      <td>http://content8.flixster.com/movie/56/79/73/56...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Grumpy Old Men</td>
      <td>107050</td>
      <td>Dos viejos gruñones</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTI5MTgy...</td>
      <td>1993</td>
      <td>grumpy_old_men</td>
      <td>5.9</td>
      <td>36.0</td>
      <td>24.0</td>
      <td>12.0</td>
      <td>66.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>83.0</td>
      <td>3.2</td>
      <td>10489.0</td>
      <td>66.0</td>
      <td>http://content6.flixster.com/movie/25/60/25602...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Waiting to Exhale</td>
      <td>114885</td>
      <td>Esperando un respiro</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTczMTMy...</td>
      <td>1995</td>
      <td>waiting_to_exhale</td>
      <td>5.6</td>
      <td>25.0</td>
      <td>14.0</td>
      <td>11.0</td>
      <td>56.0</td>
      <td>5.5</td>
      <td>11.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>45.0</td>
      <td>3.3</td>
      <td>5666.0</td>
      <td>79.0</td>
      <td>http://content9.flixster.com/movie/10/94/17/10...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Father of the Bride Part II</td>
      <td>113041</td>
      <td>Vuelve el padre de la novia (Ahora también abu...</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTg1NDc2...</td>
      <td>1995</td>
      <td>father_of_the_bride_part_ii</td>
      <td>5.3</td>
      <td>19.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>47.0</td>
      <td>5.4</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>20.0</td>
      <td>3.0</td>
      <td>13761.0</td>
      <td>64.0</td>
      <td>http://content8.flixster.com/movie/25/54/25542...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>65088</th>
      <td>Bedtime Stories</td>
      <td>960731</td>
      <td>Más allá de los sueños</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMjA5Njk5...</td>
      <td>2008</td>
      <td>bedtime_stories</td>
      <td>4.4</td>
      <td>104.0</td>
      <td>26.0</td>
      <td>78.0</td>
      <td>25.0</td>
      <td>4.7</td>
      <td>26.0</td>
      <td>6.0</td>
      <td>20.0</td>
      <td>23.0</td>
      <td>3.5</td>
      <td>108877.0</td>
      <td>63.0</td>
      <td>http://content6.flixster.com/movie/10/94/33/10...</td>
    </tr>
    <tr>
      <th>65091</th>
      <td>Manhattan Melodrama</td>
      <td>25464</td>
      <td>El enemigo público número 1</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTUyODE3...</td>
      <td>1934</td>
      <td>manhattan_melodrama</td>
      <td>7.0</td>
      <td>12.0</td>
      <td>10.0</td>
      <td>2.0</td>
      <td>83.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>50.0</td>
      <td>3.7</td>
      <td>344.0</td>
      <td>71.0</td>
      <td>http://content9.flixster.com/movie/66/44/64/66...</td>
    </tr>
    <tr>
      <th>65126</th>
      <td>Choke</td>
      <td>1024715</td>
      <td>Choke</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTMxMDI4...</td>
      <td>2008</td>
      <td>choke</td>
      <td>5.6</td>
      <td>135.0</td>
      <td>73.0</td>
      <td>62.0</td>
      <td>54.0</td>
      <td>4.9</td>
      <td>26.0</td>
      <td>8.0</td>
      <td>18.0</td>
      <td>30.0</td>
      <td>3.3</td>
      <td>13893.0</td>
      <td>55.0</td>
      <td>http://content6.flixster.com/movie/10/85/09/10...</td>
    </tr>
    <tr>
      <th>65130</th>
      <td>Revolutionary Road</td>
      <td>959337</td>
      <td>Revolutionary Road</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMTI2MzY2...</td>
      <td>2008</td>
      <td>revolutionary_road</td>
      <td>6.7</td>
      <td>194.0</td>
      <td>133.0</td>
      <td>61.0</td>
      <td>68.0</td>
      <td>6.9</td>
      <td>36.0</td>
      <td>25.0</td>
      <td>11.0</td>
      <td>69.0</td>
      <td>3.5</td>
      <td>46044.0</td>
      <td>70.0</td>
      <td>http://content8.flixster.com/movie/10/88/40/10...</td>
    </tr>
    <tr>
      <th>65133</th>
      <td>Blackadder Back &amp; Forth</td>
      <td>212579</td>
      <td>Blackadder Back &amp; Forth</td>
      <td>http://ia.media-imdb.com/images/M/MV5BMjA5MjU4...</td>
      <td>1999</td>
      <td>blackadder-back-forth</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>http://content7.flixster.com/movie/34/10/69/34...</td>
    </tr>
  </tbody>
</table>
<p>10197 rows × 20 columns</p>
</div></div></div>
</div>
<p>So we’ll set the index, pick a couple columns, and join with movie stats:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)[[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">movie_stats</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>year</th>
      <th>MeanRating</th>
      <th>RatingCount</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Toy story</td>
      <td>1995</td>
      <td>3.735154</td>
      <td>1263.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jumanji</td>
      <td>1995</td>
      <td>2.976471</td>
      <td>765.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Grumpy Old Men</td>
      <td>1993</td>
      <td>2.873016</td>
      <td>252.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Waiting to Exhale</td>
      <td>1995</td>
      <td>2.577778</td>
      <td>45.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Father of the Bride Part II</td>
      <td>1995</td>
      <td>2.753333</td>
      <td>225.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>65088</th>
      <td>Bedtime Stories</td>
      <td>2008</td>
      <td>3.500000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>65091</th>
      <td>Manhattan Melodrama</td>
      <td>1934</td>
      <td>4.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>65126</th>
      <td>Choke</td>
      <td>2008</td>
      <td>3.250000</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>65130</th>
      <td>Revolutionary Road</td>
      <td>2008</td>
      <td>2.500000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>65133</th>
      <td>Blackadder Back &amp; Forth</td>
      <td>1999</td>
      <td>4.000000</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
<p>10197 rows × 4 columns</p>
</div></div></div>
</div>
<p>This has the same result.</p>
</div>
<div class="section" id="join-types">
<h3>Join Types<a class="headerlink" href="#join-types" title="Permalink to this headline">¶</a></h3>
<p>There are multiple types of joins.  The types of Pandas joins correspond to SQL join types, if you are familiar with those.</p>
<p>We refer to the frames as <em>left</em> and <em>right</em>.  These correspond to positions in the functions as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pd.merge(left, right)
left.join(right)
</pre></div>
</div>
<ul class="simple">
<li><p>An <strong>inner join</strong> requires a match to appear in both frames.  If there is a row in one frame whose join column value has no match in the other frame, the row is excluded.  This applies to both frames.</p></li>
<li><p>A <strong>left join</strong> includes every row in the left-hand frame at least once; if there is a left-hand row with no match in the right-hand frame, one copy is included with missing values for all of the right-hand columns.  Right-hand rows with no matches in the left frame are excluded.</p></li>
<li><p>A <strong>right join</strong> is the reverse of a left join: it includes every value in the right-hand frame at least once.</p></li>
<li><p>An <strong>outer join</strong> includes every row from both frames at least once.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">pd.merge</span></code> defaults to an inner join, and <code class="docutils literal notranslate"><span class="pre">left.join(right)</span></code> defaults to a left join.  Both take a <code class="docutils literal notranslate"><span class="pre">how=</span></code> option to change the merge type.</p>
</div>
<div class="section" id="join-tips">
<h3>Join Tips<a class="headerlink" href="#join-tips" title="Permalink to this headline">¶</a></h3>
<p>The join I find myself using most frequently is a column-index join.  I also usually join on a single column, although multiple-column joins are very well-supported.</p>
</div>
</div>
<div class="section" id="tall-and-wide">
<h2>Tall and Wide<a class="headerlink" href="#tall-and-wide" title="Permalink to this headline">¶</a></h2>
<p>As discussed in the video, data comes in <em>tall</em> and <em>wide</em> formats.  If we observations of multiple variables for something, it can be in either format:</p>
<ul class="simple">
<li><p>In <strong>wide</strong> format, each variable is a column</p></li>
<li><p>In <strong>tall</strong> (or <strong>long</strong>) format, each variable produces a new row; there is a column for the variable name and another for the value</p></li>
</ul>
<p>We can convert back and forth between them.</p>
<div class="section" id="tall-to-wide">
<h3>Tall to Wide<a class="headerlink" href="#tall-to-wide" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">pivot</span></code> function converts tall data to wide data.</p>
<p>First, let’s make some tall data.  The movie-tags table has the tags that apply to each movie, along with their <em>weight</em>: how important that tag is.  Let’s look (joining to <code class="docutils literal notranslate"><span class="pre">tag</span></code> to get the tag names):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movie_tags</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tags</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;tagID&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movieID</th>
      <th>tagID</th>
      <th>tagWeight</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>7</td>
      <td>1</td>
      <td>funny</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>13</td>
      <td>3</td>
      <td>time travel</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>25</td>
      <td>3</td>
      <td>tim allen</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>55</td>
      <td>3</td>
      <td>comedy</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>60</td>
      <td>1</td>
      <td>fun</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>51790</th>
      <td>65037</td>
      <td>792</td>
      <td>1</td>
      <td>autism</td>
    </tr>
    <tr>
      <th>51791</th>
      <td>65037</td>
      <td>2214</td>
      <td>1</td>
      <td>internet</td>
    </tr>
    <tr>
      <th>51792</th>
      <td>65126</td>
      <td>5281</td>
      <td>1</td>
      <td>based on book</td>
    </tr>
    <tr>
      <th>51793</th>
      <td>65126</td>
      <td>13168</td>
      <td>1</td>
      <td>chuck palahniuk</td>
    </tr>
    <tr>
      <th>51794</th>
      <td>65130</td>
      <td>2924</td>
      <td>1</td>
      <td>toplist08</td>
    </tr>
  </tbody>
</table>
<p>51795 rows × 4 columns</p>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">value</span></code> is a funny name, and once we have name we don’t need tag ID, so let’s clean up these columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movie_tag_weights</span> <span class="o">=</span> <span class="n">movie_tags</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tags</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;tagID&#39;</span><span class="p">)</span>
<span class="n">movie_tag_weights</span> <span class="o">=</span> <span class="n">movie_tag_weights</span><span class="p">[[</span><span class="s1">&#39;movieID&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;tagWeight&#39;</span><span class="p">]]</span>
<span class="n">movie_tag_weights</span> <span class="o">=</span> <span class="n">movie_tag_weights</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;tag&#39;</span><span class="p">,</span>
    <span class="s1">&#39;tagWeight&#39;</span><span class="p">:</span> <span class="s1">&#39;weight&#39;</span>
<span class="p">})</span>
<span class="n">movie_tag_weights</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movieID</th>
      <th>tag</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>funny</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>time travel</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>tim allen</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>comedy</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>fun</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>51790</th>
      <td>65037</td>
      <td>autism</td>
      <td>1</td>
    </tr>
    <tr>
      <th>51791</th>
      <td>65037</td>
      <td>internet</td>
      <td>1</td>
    </tr>
    <tr>
      <th>51792</th>
      <td>65126</td>
      <td>based on book</td>
      <td>1</td>
    </tr>
    <tr>
      <th>51793</th>
      <td>65126</td>
      <td>chuck palahniuk</td>
      <td>1</td>
    </tr>
    <tr>
      <th>51794</th>
      <td>65130</td>
      <td>toplist08</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>51795 rows × 3 columns</p>
</div></div></div>
</div>
<p>This is in <strong>tall</strong> format: for each movie, we have a row for each tag with its weight.</p>
<p>If we want to turn this into a (very!) <strong>wide</strong> table, with a column for each tag, we can use <code class="docutils literal notranslate"><span class="pre">pivot</span></code>.</p>
<p><strong>If we have:</strong> a data frame in tall format (one column has variable names, and another their values)<br />
<strong>And we want:</strong> the same data in wide format (variables split out into columns)<br />
<strong>Then we can:</strong> use <code class="docutils literal notranslate"><span class="pre">pivot</span></code> to pivot the wide data into tall format:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mtw_wide</span> <span class="o">=</span> <span class="n">movie_tag_weights</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="s1">&#39;movieID&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">)</span>
<span class="n">mtw_wide</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>tag</th>
      <th>(s)vcd</th>
      <th>007 (series)</th>
      <th>15th century</th>
      <th>16mm</th>
      <th>16th century</th>
      <th>17th century</th>
      <th>1800s</th>
      <th>1890s</th>
      <th>18th century</th>
      <th>1900s</th>
      <th>...</th>
      <th>zeppelin</th>
      <th>zero mostel</th>
      <th>zibri studio</th>
      <th>zim</th>
      <th>ziyi zhang</th>
      <th>zombie</th>
      <th>zombie movie</th>
      <th>zombies</th>
      <th>zoo</th>
      <th>zooey deschanel</th>
    </tr>
    <tr>
      <th>movieID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>64993</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>65006</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>65037</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>65126</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>65130</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>7155 rows × 5297 columns</p>
</div></div></div>
</div>
<p>We see a lot of missing values (NaN).  The <code class="docutils literal notranslate"><span class="pre">describe</span></code> method on a data frame will describe all the columns, which will include counting the values.  Let’s see it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mtw_desc</span> <span class="o">=</span> <span class="n">mtw_wide</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">mtw_desc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>tag</th>
      <th>(s)vcd</th>
      <th>007 (series)</th>
      <th>15th century</th>
      <th>16mm</th>
      <th>16th century</th>
      <th>17th century</th>
      <th>1800s</th>
      <th>1890s</th>
      <th>18th century</th>
      <th>1900s</th>
      <th>...</th>
      <th>zeppelin</th>
      <th>zero mostel</th>
      <th>zibri studio</th>
      <th>zim</th>
      <th>ziyi zhang</th>
      <th>zombie</th>
      <th>zombie movie</th>
      <th>zombies</th>
      <th>zoo</th>
      <th>zooey deschanel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>31.000000</td>
      <td>23.000000</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>10.000000</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>12.000000</td>
      <td>7.000000</td>
      <td>...</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>9.000000</td>
      <td>7.0</td>
      <td>2.0</td>
      <td>25.00000</td>
      <td>3.0</td>
      <td>43.000000</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.032258</td>
      <td>1.043478</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.300000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.583333</td>
      <td>1.142857</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.111111</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.52000</td>
      <td>2.0</td>
      <td>3.465116</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.179605</td>
      <td>0.208514</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.483046</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.996205</td>
      <td>0.377964</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.333333</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.87178</td>
      <td>1.0</td>
      <td>3.607854</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.00000</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.00000</td>
      <td>1.5</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.00000</td>
      <td>2.0</td>
      <td>2.000000</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.750000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.00000</td>
      <td>2.5</td>
      <td>5.000000</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>4.000000</td>
      <td>2.000000</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>4.00000</td>
      <td>3.0</td>
      <td>19.000000</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 5297 columns</p>
</div></div></div>
</div>
<p>That might look better if we switch columns and rows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mtw_desc</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>tag</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(s)vcd</th>
      <td>31.0</td>
      <td>1.032258</td>
      <td>0.179605</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>007 (series)</th>
      <td>23.0</td>
      <td>1.043478</td>
      <td>0.208514</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>15th century</th>
      <td>2.0</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>16mm</th>
      <td>5.0</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>16th century</th>
      <td>6.0</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>zombie</th>
      <td>25.0</td>
      <td>1.520000</td>
      <td>0.871780</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>zombie movie</th>
      <td>3.0</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.5</td>
      <td>2.0</td>
      <td>2.5</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>zombies</th>
      <td>43.0</td>
      <td>3.465116</td>
      <td>3.607854</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>zoo</th>
      <td>2.0</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>zooey deschanel</th>
      <td>2.0</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>5297 rows × 8 columns</p>
</div></div></div>
</div>
<p>Ok isn’t that kinda cool?</p>
</div>
</div>
<div class="section" id="stacking-frames">
<h2>Stacking Frames<a class="headerlink" href="#stacking-frames" title="Permalink to this headline">¶</a></h2>
<p>Joins let us combine by merging on values, but sometimes we want to stack data frames on top of each other.  The <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.concat.html"><code class="docutils literal notranslate"><span class="pre">concat</span></code></a> Pandas function concatenates a list (or other iterable) of data frames.  For example, to simulate a <code class="docutils literal notranslate"><span class="pre">melt</span></code> of the two critic rating columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movie_top_rates</span> <span class="o">=</span> <span class="n">movies</span><span class="p">[[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;rtTopCriticsRating&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;rtTopCriticsRating&#39;</span><span class="p">:</span> <span class="s1">&#39;rating&#39;</span><span class="p">})</span>
<span class="n">movie_top_rates</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Top Critics&#39;</span>
<span class="n">movie_all_rates</span> <span class="o">=</span> <span class="n">movies</span><span class="p">[[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;rtAllCriticsRating&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;rtAllCriticsRating&#39;</span><span class="p">:</span> <span class="s1">&#39;rating&#39;</span><span class="p">})</span>
<span class="n">movie_all_rates</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;All Critics&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movie_rates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">movie_top_rates</span><span class="p">,</span> <span class="n">movie_all_rates</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">movie_rates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>rating</th>
      <th>source</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>8.5</td>
      <td>Top Critics</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5.8</td>
      <td>Top Critics</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>7.0</td>
      <td>Top Critics</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>5.5</td>
      <td>Top Critics</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>5.4</td>
      <td>Top Critics</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>20389</th>
      <td>65088</td>
      <td>4.4</td>
      <td>All Critics</td>
    </tr>
    <tr>
      <th>20390</th>
      <td>65091</td>
      <td>7.0</td>
      <td>All Critics</td>
    </tr>
    <tr>
      <th>20391</th>
      <td>65126</td>
      <td>5.6</td>
      <td>All Critics</td>
    </tr>
    <tr>
      <th>20392</th>
      <td>65130</td>
      <td>6.7</td>
      <td>All Critics</td>
    </tr>
    <tr>
      <th>20393</th>
      <td>65133</td>
      <td>0.0</td>
      <td>All Critics</td>
    </tr>
  </tbody>
</table>
<p>20394 rows × 3 columns</p>
</div></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ignore_index=True</span></code> option causes <code class="docutils literal notranslate"><span class="pre">pd.concat</span></code> to throw away the indexes and make a new <code class="docutils literal notranslate"><span class="pre">RangeIndex</span></code>.  This is fine because the indexes don’t contain any useful information.</p>
<p>We can also concatenate with the index; this is most useful when the frames have disjoint indexes, or when we want to add another index level containing the source.  We’ll discuss this in the indexing notebook.</p>
<div class="section" id="wide-to-tall">
<h3>Wide to Tall<a class="headerlink" href="#wide-to-tall" title="Permalink to this headline">¶</a></h3>
<p>What if we want to go the other way? That’s what <code class="docutils literal notranslate"><span class="pre">melt</span></code> is for.</p>
<p>Remember our movie stats by year?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year_scores</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>All Critics</th>
      <th>Top Critics</th>
      <th>Audience</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1903</th>
      <td>7.600000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1915</th>
      <td>8.000000</td>
      <td>0.000000</td>
      <td>3.300000</td>
    </tr>
    <tr>
      <th>1916</th>
      <td>7.800000</td>
      <td>0.000000</td>
      <td>3.800000</td>
    </tr>
    <tr>
      <th>1917</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1918</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2007</th>
      <td>5.141278</td>
      <td>4.769042</td>
      <td>3.062162</td>
    </tr>
    <tr>
      <th>2008</th>
      <td>4.699357</td>
      <td>4.383280</td>
      <td>2.853698</td>
    </tr>
    <tr>
      <th>2009</th>
      <td>4.850000</td>
      <td>4.700000</td>
      <td>3.192308</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2011</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>98 rows × 3 columns</p>
</div></div></div>
</div>
<p><strong>If we have:</strong> a data frame in wide format<br />
<strong>And we want:</strong> the same data in tall format<br />
<strong>Then we can:</strong> use the <code class="docutils literal notranslate"><span class="pre">melt</span></code> method or function.</p>
<p>We first have to reset the index, because melt destroys it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year_scores</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>All Critics</th>
      <th>Top Critics</th>
      <th>Audience</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1903</td>
      <td>7.600000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1915</td>
      <td>8.000000</td>
      <td>0.000000</td>
      <td>3.300000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1916</td>
      <td>7.800000</td>
      <td>0.000000</td>
      <td>3.800000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1917</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1918</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>93</th>
      <td>2007</td>
      <td>5.141278</td>
      <td>4.769042</td>
      <td>3.062162</td>
    </tr>
    <tr>
      <th>94</th>
      <td>2008</td>
      <td>4.699357</td>
      <td>4.383280</td>
      <td>2.853698</td>
    </tr>
    <tr>
      <th>95</th>
      <td>2009</td>
      <td>4.850000</td>
      <td>4.700000</td>
      <td>3.192308</td>
    </tr>
    <tr>
      <th>96</th>
      <td>2010</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>97</th>
      <td>2011</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>98 rows × 4 columns</p>
</div></div></div>
</div>
<p>That pops the year back out to being a column, so we can pass it as the <code class="docutils literal notranslate"><span class="pre">id_var</span></code> to <code class="docutils literal notranslate"><span class="pre">melt</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys_tall</span> <span class="o">=</span> <span class="n">year_scores</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">)</span>
<span class="n">ys_tall</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1903</td>
      <td>All Critics</td>
      <td>7.600000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1915</td>
      <td>All Critics</td>
      <td>8.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1916</td>
      <td>All Critics</td>
      <td>7.800000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1917</td>
      <td>All Critics</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1918</td>
      <td>All Critics</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>289</th>
      <td>2007</td>
      <td>Audience</td>
      <td>3.062162</td>
    </tr>
    <tr>
      <th>290</th>
      <td>2008</td>
      <td>Audience</td>
      <td>2.853698</td>
    </tr>
    <tr>
      <th>291</th>
      <td>2009</td>
      <td>Audience</td>
      <td>3.192308</td>
    </tr>
    <tr>
      <th>292</th>
      <td>2010</td>
      <td>Audience</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>293</th>
      <td>2011</td>
      <td>Audience</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>294 rows × 3 columns</p>
</div></div></div>
</div>
<p>We  can give better names to these things:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys_tall</span> <span class="o">=</span> <span class="n">year_scores</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;Source&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;MeanAvgScore&#39;</span><span class="p">)</span>
<span class="n">ys_tall</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>Source</th>
      <th>MeanAvgScore</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1903</td>
      <td>All Critics</td>
      <td>7.600000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1915</td>
      <td>All Critics</td>
      <td>8.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1916</td>
      <td>All Critics</td>
      <td>7.800000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1917</td>
      <td>All Critics</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1918</td>
      <td>All Critics</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>289</th>
      <td>2007</td>
      <td>Audience</td>
      <td>3.062162</td>
    </tr>
    <tr>
      <th>290</th>
      <td>2008</td>
      <td>Audience</td>
      <td>2.853698</td>
    </tr>
    <tr>
      <th>291</th>
      <td>2009</td>
      <td>Audience</td>
      <td>3.192308</td>
    </tr>
    <tr>
      <th>292</th>
      <td>2010</td>
      <td>Audience</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>293</th>
      <td>2011</td>
      <td>Audience</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>294 rows × 3 columns</p>
</div></div></div>
</div>
<p>This is useful for plotting - year is the <em>x</em> axis, score, the <em>y</em>, and source the color or hue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;MeanAvgScore&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Source&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ys_tall</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x270245c6460&gt;
</pre></div>
</div>
<img alt="../../../_images/Reshaping_83_1.png" src="../../../_images/Reshaping_83_1.png" />
</div>
</div>
<p>In practice, setting up plots is one of my most frequent use cases for <code class="docutils literal notranslate"><span class="pre">melt</span></code>.  The Pandas defaults we saw earlier are useful, but this give us much more control.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./resources\tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../Regressions/" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Regressions</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../SamplingDists/" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Sampling Distributions</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Michael D. Ekstrand<br/>
        
            &copy; <a href="../../../copyright/">Copyright</a> 2021.<br/>
          <div class="extra_footer">
            <script data-goatcounter="https://cs533.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>