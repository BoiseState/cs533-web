
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Week 11 — More Modeling (11/1–5) &#8212; CS 533 Fall 2021</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/fonts.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/tabinsert.js"></script>
    <script src="../_static/urlclean.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "mdekstrand/cs533-web");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"E": "\\mathrm{E}", "Field": "\\mathcal{F}", "P": "\\mathrm{P}", "Cov": "\\mathrm{Cov}", "Cor": "\\mathrm{Cor}", "Var": "\\mathrm{Var}", "log": "\\operatorname{log}", "Odds": "\\operatorname{Odds}", "OR": "\\operatorname{OR}", "IND": "\\mathbb{I}", "Reals": "\\mathbb{R}"}}, "HTML-CSS": {"fonts": ["TeX"]}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="copyright" title="Copyright" href="../copyright/" />
    <link rel="next" title="Week 12 — Text (11/8–12)" href="../week12/" />
    <link rel="prev" title="Week 10 — Classification (10/25–29)" href="../week10/" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../">
      
      
      
      <h1 class="site-logo" id="site-title">CS 533 Fall 2021</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search/" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../">
   CS 533 Homepage
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course Info
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../schedule/">
   Schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../glossary/">
   Glossary
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Content
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../week0/">
   Week 0 — Pre-Class Welcome
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week1/">
   Week 1 — Questions (8/23–27)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week1/DemoNotebook/">
     Demo Notebook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week1/1-7-types-operations/">
     Data Types and Operations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week2/">
   Week 2 — Description (8/30–9/3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/2-2-PandasBasics/">
     Introducing Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/2-4-AggregatesAndGroups/">
     Aggregates and Groups
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/2-6-DescribingDistributions/">
     Describing Distributions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week3/">
   Week 3 — Presentation (9/6–10)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week3/3-6-ChartsFromTheGroundUp/">
     Drawing Charts
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week4/">
   Week 4 — Inference (9/13–17)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week5/">
   Week 5 — Filling In (9/20–24)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week6/">
   Week 6 — Two Variables (Sep. 27–Oct. 1)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week7/">
   Week 7 — Getting Data (Oct. 4–8)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week8/">
   Week 8 — Regression (Oct. 11–15)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week9/">
   Week 9 — Models &amp; Prediction (Oct. 18–22)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week10/">
   Week 10 — Classification (10/25–29)
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Week 11 — More Modeling (11/1–5)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week12/">
   Week 12 — Text (11/8–12)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week13/">
   Week 13 — Unsupervised (11/15–19)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week14/">
   Week 14 — Workflow (11/29–12/3)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week15/">
   Week 15 — What Next? (12/6–10)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/">
   Rubric
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../assignments/A0/">
   Assignment 0
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../assignments/A0/A0-Notebook/">
     CS 533 Assignment 0
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/A1/">
   Assignment 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/A2/">
   Assignment 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/A3/">
   Assignment 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/A4/">
   Assignment 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/A5/">
   Assignment 5
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/A6/">
   Assignment 6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/A7/">
   Assignment 7
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/software/">
   Software and Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/documentation/">
   Documentation &amp; Reading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/data/">
   Data Sets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/notebook-checklist/">
   Notebook Checklist &amp; Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/probability/">
   Notes on Probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/problems/">
   Common Problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/onyx/">
   Remotely Using Onyx
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/git-resources/">
   Git Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/environments/">
   Software Environments
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../resources/tutorials/">
   Tutorials
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/AdvancedPipeline/">
     Advanced Pipeline Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/BooleanSeries/">
     Tricks with Boolean Series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/BuildingData/">
     Building Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/ChartFinishingTouches/">
     Finishing Touches
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/Charting/">
     Drawing Charts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/ClusteringExample/">
     Clustering Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/Correlation/">
     Correlation and Basic Linear Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/CriticScores/">
     Charting Movie Scores
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/Distributions/">
     Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/EmpiricalProbabilities/">
     Empirical Probabilities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/FetchCHIPapers/">
     Bibliography Fetch
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/FunWithNumbers/">
     Fun with Numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/Functions/">
     Writing Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/Indexing/">
     Indexing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/LogitRegressionDemo/">
     Logistic Regression Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/MLTimeSeries/">
     MovieLens Time Series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/MinimizeRegression/">
     Rebuilding Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/MissingData/">
     Missing Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/MovieDecomp/">
     Movie Matrix Decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/OneSample/">
     One Sample
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/OverfittingSimulation/">
     Overfitting Simulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/PCADemo/">
     PCA Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/PenguinSamples/">
     Sampling and Testing the Penguins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/Regressions/">
     Regressions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/Reshaping/">
     Reshaping Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/SamplingDists/">
     Sampling Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/SciKitLogistic/">
     SciKit Logistic Regression Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/SciKitPipeline/">
     SciKit Pipeline and Transform Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/SciKitRegression/">
     SciKit-Learn Linear Regression Demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/SciKitTransform/">
     SciKit Transformations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/Selection/">
     Selecting Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/Sessions/">
     Sessionization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/SpamFilter/">
     Spam Detector Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/TuningExample/">
     Tuning Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/tutorials/UsingTheCensus/">
     Using Census Data
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Site Details
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../copyright/">
   Copyright and License
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/week11/index.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/mdekstrand/cs533-web"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/mdekstrand/cs533-web/issues/new?title=Issue%20on%20page%20%2Fweek11/index.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/mdekstrand/cs533-web/edit/main/week11/index.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#content-overview">
   🧐 Content Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#intro-context">
   🎥 Intro &amp; Context
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#feature-transforms">
   🎥 Feature Transforms
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#workflow">
   🎥 Workflow
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scikit-pipelines">
   🎥 SciKit Pipelines
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scikit-learn-pipelines">
   📃 SciKit Learn Pipelines
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scikit-learn-preprocessing">
   📃 SciKit Learn Preprocessing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regularization">
   🎥 Regularization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pipeline-and-regularization">
   📓 Pipeline and Regularization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#advanced-pipelines">
   📓 Advanced Pipelines
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#models-and-depth">
   🎥 Models and Depth
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inference-and-ablation">
   🎥 Inference and Ablation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#statistical-significance-tests">
   📃 Statistical Significance Tests
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dates">
   🎥 Dates
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#links">
     Links
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quiz-11">
   🚩 Quiz 11
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#assignment-5">
   📩 Assignment 5
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="week-11-more-modeling-11-15">
<span id="week11"></span><h1>Week 11 — More Modeling (11/1–5)<a class="headerlink" href="#week-11-more-modeling-11-15" title="Permalink to this headline">¶</a></h1>
<p>In this week, we’re going to learn more about model building, that will be useful in Assignment 5:</p>
<ul class="simple">
<li><p>Feature engineering</p></li>
<li><p>SciKit-Learn pipelines and workflows</p></li>
<li><p>Regularization</p></li>
<li><p>Analyzing model results</p></li>
</ul>
<div class="section" id="content-overview">
<h2>🧐 Content Overview<a class="headerlink" href="#content-overview" title="Permalink to this headline">¶</a></h2>
<div class="module-content docutils">
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><strong>Element</strong></th>
<th class="head"><strong>Length</strong></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#40a41051-8c07-443c-b7d1-ac66002b3208"><span>🎥 Intro and Context</span></a></p></td>
<td><span>4m39s</span></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#80203946-b811-4ecb-b703-ac660033edd1"><span>🎥 Feature Transforms</span></a></p></td>
<td><span>21m3s</span></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#71b1aa35-8435-4eae-ae32-ac660033ee09"><span>🎥 Workflow</span></a></p></td>
<td><span>14m29s</span></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#f448da70-c2d2-4c1b-942b-ac66003656a1"><span>🎥 SciKit Pipelines</span></a></p></td>
<td><span>7m19s</span></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fa457314-7344-48cd-af1f-ac660039cbc4"><span>🎥 Regularization</span></a></p></td>
<td><span>15m4s</span></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#220a8acb-a901-49e7-bf9e-ac66003d7033"><span>🎥 Models and Depth</span></a></p></td>
<td><span>7m23s</span></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#589628b2-30ce-4c38-ba45-ac66003f5163"><span>🎥 Inference and Ablation</span></a></p></td>
<td><span>14m55s</span></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reading-Statistical-Significance-Tests-for-Comparing-Machine-Learning-Algorithms"><span>📃 Statistical Significance Tests for Comparing Machine Learning Algorithms</span></a></p></td>
<td><span>3400 words</span></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#db1dc799-8ed1-4a7b-960e-ac69001a590d"><span>🎥 Dates</span></a></p></td>
<td><span>8m34s</span></td>
</tr>
</tbody>
</table>
<p><span>This week has </span><strong>1h33m</strong><span> of video and </span><strong>3400 words</strong><span> of assigned readings.</span><span> This week’s videos are available in a </span><a class="panopto reference external" href="https://boisestate.hosted.panopto.com/Panopto/Pages/Sessions/List.aspx#folderID=%22d92a38f0-5764-4306-b97a-adc101859d2b%22"><span>Panopto folder</span></a><span> and as a </span><a class="panopto podcast reference external" href="https://boisestate.hosted.panopto.com/Panopto/Podcast/Podcast.ashx?courseid=d92a38f0-5764-4306-b97a-adc101859d2b&amp;type=mp4"><span>podcast</span></a><span>.</span></p>
</div>
</div>
<div class="section" id="intro-context">
<h2>🎥 Intro &amp; Context<a class="headerlink" href="#intro-context" title="Permalink to this headline">¶</a></h2>
<p>In this video, I review where we are at conceptually, and recap the ideas of estimating conditional probability and expectation.</p>
<div class="resource video docutils container" id="40a41051-8c07-443c-b7d1-ac66002b3208">
<div class="tabbed-set docutils">
<input checked="checked" id="45fee1fd-9d1e-42ab-84a2-bdf986f99cab" name="d9b380f9-26c5-40ff-a6d2-4621a7198a55" type="radio">
</input><label class="tabbed-label" for="45fee1fd-9d1e-42ab-84a2-bdf986f99cab">
Video (4m39s)</label><div class="tabbed-content player docutils">
<div class="video-container video-embed">
<iframe src="https://boisestate.hosted.panopto.com/Panopto/Pages/Embed.aspx?id=40a41051-8c07-443c-b7d1-ac66002b3208&autoplay=false&offerviewer=true&showtitle=true&showbrand=false&start=0&interactivity=all" height="405" width="720" style="border: 1px solid #464646;" allowfullscreen allow="autoplay"></iframe>
</div></div>
<input id="ca3b20b5-e237-4816-96f8-39e4016d65f4" name="d9b380f9-26c5-40ff-a6d2-4621a7198a55" type="radio">
</input><label class="tabbed-label" for="ca3b20b5-e237-4816-96f8-39e4016d65f4">
Slides</label><div class="tabbed-content slides docutils">
<div class=slide-container data-id="495979F9A431DDB0%2173320" data-key=AJXlvBsutNDBkoE>
</div></div>
</div>
<div class="slides text hidden docutils">
CS 533INTRO TO DATA SCIENCE
Michael Ekstrand
BUILDING AND EVALUATING MODELS
Learning Outcomes (Week)
Build and refine a predictive model
Construct features for a model
Apply regularization to control features and their interaction
Measure a model’s effectiveness and other behavior
Photo by Hannah Olinger on Unsplash
Where We’re At
Linear regression (continuous prediction)
Logistic regression (binary classification)
Optimizing objective functions
Minimize loss functions (e.g. squared error)
Maximize utility functions (e.g. log likelihood)
Conditional Estimates
Distinction: Model Probability vs. Make Decision
Trick: Probability and Expectation
Wrapping Up
We are building models that estimate conditional probability or expectation and use them to make classifications.

We’re going to see more about their inputs and outputs this week.
Photo by Klim Musalimov on Unsplash
</div>
<div class="captions text hidden docutils">
<ul class="simple">
<li>Oh, this video, I'm going to introduce our week's topic about building and evaluating models, talking more in detail about how we go about doing that,</li>
<li>learning outcomes for the week or for you to be able to build and refine a predictive model,</li>
<li>construct features for that model, apply regularization to control features and then her interaction and to give us models that</li>
<li>generalize better and to model measure of a model's effectiveness and its other behavior.</li>
<li>So where we're at right now, we've seen linear regression and we have seen continue to be able to do continuous prediction,</li>
<li>we want to predict a continuous outcome or target variable.</li>
<li>We've seen logistic regression that lets us take the concept of linear modeling and move it into the realm of binary classification,</li>
<li>where rather than having a continuous outcome variable, we have a binary outcome such as defaulted on the loan or is spam or fraud.</li>
<li>We've also seen the idea of minimize it, of optimizing objective functions, we might minimize a loss function such as the squared error.</li>
<li>We might maximize utility functions such as log likelihood. These are equivalent to each other.</li>
<li>And if you've got a utility function in the minimize or you can minimize the negative of the utility function.</li>
<li>We've also seen that we can think about what we're doing with modeling is doing conditional estimation.</li>
<li>So in a regression model, we're trying to estimate the conditional expectation, given a particular set of values for my input features X.</li>
<li>What's the expected value of Y? We might we might do some transformations to all these variables.</li>
<li>But we're trying to compute this conditional expectation function.</li>
<li>What's the expected value of Y condition done by feature values, X and classification?</li>
<li>We're trying to solve a conditional probability problem.</li>
<li>What's the probability of a particular outcome given that I have some particular feature values x.</li>
<li>Also so. There's another, though, thing in here that's useful to thinking about,</li>
<li>so that would just add regression at its heart is trying to model the probability of your data.</li>
<li>So what we've been doing is with stats, models.</li>
<li>We do model that predict and we get some scores and then we use the scores to make a decision because internally,</li>
<li>the logistic regression mathematically with solving this problem of maximizing the log likelihood.</li>
<li>Mathematically, what the logistic regression is doing is it's trying to build a probabilistic model of the data and the</li>
<li>parameters are estimated based on their ability to accurately model probabilities in your training data.</li>
<li>We then use these output probabilities to make decisions. So we'll say success if y had is greater than point five.</li>
<li>Saikat Learn uses the logistic regression to directly classify by using the threshold of point five.</li>
<li>But you can get those estimated probabilities out of it with decision, the decision function.</li>
<li>This is important to note.</li>
<li>So the log likelihood that you get out of a logistic regression is not based on its actual actual decisions that it's making.</li>
<li>It's based on its ability to model probabilistically what the labels look like in your training data.</li>
<li>And it's the more it's the probability that it assigns to those labels with the final fitted versions of the parameters.</li>
<li>I want to mention briefly again, a trick that I mentioned, I believe, last week where.</li>
<li>Expected value and probability are closely related. The expected value is the integral or the somewhere of values weighted by their probabilities.</li>
<li>But also if we have an indicator function, ie, which is one if.</li>
<li>X is in the set and and zero, if it is not with what one?</li>
<li>Basically, given a value, it decides whether or not it's in the set. If that said as an event, it says whether or not the event happened,</li>
<li>the probability and the expected value of the indicator function are the same thing.</li>
<li>So we can think about estimating conditional expectation probable, but we can think about everything is estimated conditional expectation.</li>
<li>When we're estimating a probability, we're estimating the conditional expectation of the characteristic or indicator function.</li>
<li>So to wrap up, we're building models that estimate conditional probability and expectation.</li>
<li>We've been doing this in a variety of ways. We use these models to make decisions.</li>
<li>This week we're gonna see more. So we've got the idea of doing the modeling. This week, we're looking more at how do we build inputs for these models?</li>
<li>And how do we evaluate the outputs that we get out of them?</li>
</ul>
</div>
</div>
</div>
<div class="section" id="feature-transforms">
<h2>🎥 Feature Transforms<a class="headerlink" href="#feature-transforms" title="Permalink to this headline">¶</a></h2>
<p>What are some useful techniques for engineering features in an application?</p>
<div class="resource video docutils container" id="80203946-b811-4ecb-b703-ac660033edd1">
<div class="tabbed-set docutils">
<input checked="checked" id="fdac422c-f8aa-43a4-b12f-d028d338460e" name="bda71dd1-3397-487e-bf7c-4980723a3cf3" type="radio">
</input><label class="tabbed-label" for="fdac422c-f8aa-43a4-b12f-d028d338460e">
Video (21m3s)</label><div class="tabbed-content player docutils">
<div class="video-container video-embed">
<iframe src="https://boisestate.hosted.panopto.com/Panopto/Pages/Embed.aspx?id=80203946-b811-4ecb-b703-ac660033edd1&autoplay=false&offerviewer=true&showtitle=true&showbrand=false&start=0&interactivity=all" height="405" width="720" style="border: 1px solid #464646;" allowfullscreen allow="autoplay"></iframe>
</div></div>
<input id="3a7cfc13-c867-406e-be38-f7e5e6213827" name="bda71dd1-3397-487e-bf7c-4980723a3cf3" type="radio">
</input><label class="tabbed-label" for="3a7cfc13-c867-406e-be38-f7e5e6213827">
Slides</label><div class="tabbed-content slides docutils">
<div class=slide-container data-id="495979F9A431DDB0%2173322" data-key=ABC9rmLnxkHsstY>
</div></div>
</div>
<div class="slides text hidden docutils">
CS 533INTRO TO DATA SCIENCE
Michael Ekstrand
FEATURE TRANSFORMS
Learning Outcomes
Transform individual features
Derive features
Combine features

This applies to both regression and classification models
Photo by Clay Banks on Unsplash
Discrete Feature Transforms
Recode
Rename codes (for interpretability)
Merge codes (some distinctions irrelevant)
Convert to logical or 0/1 numeric
‘is value’
&gt;= value (for ordinal) (e.g.: ‘rated positively’ for &gt;3 stars)
Dummy-code

Individual Continuous Feature Transforms
Log
Square root
Square (or higher-order polynomial)
Standardize and center
Discretize (convert to bins)
When to Transform?
Feature has nonlinear relationship to outcome
Transformation can make it linear
Feature is not normally distributed
Not inherently a problem
But close-to-normally-distributed features can work better + be linear
Example: Standardizing
Example: Log Transform
Heavily skewed data
Large values -&gt; large swings (or small coefficients)
Log transform: less skew, smaller range
Example: Discretizing
Sometimes from outside knowledge
Term &gt;= 240 months ⇒ real estate loan (A5)
&gt; 3 stars ⇒ “liked” (can reduce noise in ratings!)

Nonlinear response with sharp change at “is high”
&gt;= median (or mean)
Inflection point

Discretization can have subtle effects — be careful
Advanced Transforms
Box-Cox or Power transformations
Make anything (almost) normal
Spline functions
Learn complex functions of a single variable
Multi-Feature Normalizations
Interaction: Product
Interaction: Ratio or Fraction
Other Combinations
Developing Features
It takes practice and creativity

Look for normality
Look for linear relationships
Look for hard jumps (discretization useful)
Read people writing about their features

Do feature exploration &amp; design on training data.
Wrapping Up
Transforming and expanding features is a powerful part of model building.

The model can only work with the features you give it.
Photo by Max Bender on Unsplash
</div>
<div class="captions text hidden docutils">
<ul class="simple">
<li>This video I want to talk with you about, transforming features,</li>
<li>learning outcomes are for you to be able to transform individual features and also derive new features and combine features.</li>
<li>What we're talking about here applies to both classification and regression models.</li>
<li>So. We've seen a few different things we can do with features already.</li>
<li>Just a little bit. Such as dealing with categorical features by dummy coating them.</li>
<li>But I'm going to start by refreshing on some discrete feature transference if we have one feature and it's a discrete feature.</li>
<li>There's a few things we can do with it. This is not an exhaustive list. But we can we can recode it.</li>
<li>We can rename coats. It might be that we've got the code. Just the names aren't very useful, so we want to rename them.</li>
<li>It might be that we want to merge codes. So some distinctions are irrelevant.</li>
<li>So, for example, on one of my datasets for completeness and being able to track coverage across each stage of the data integration pipeline,</li>
<li>there are four or five different ways a value can be unknown.</li>
<li>But when it comes to doing my final computations, I just care if it's unknown.</li>
<li>So I merge all of those codes into one unknown code. So that's one thing you might want to do is,</li>
<li>is merge some codes that your model doesn't have as many different codes to</li>
<li>work with because you don't care about the distinctions between some of them.</li>
<li>You may want to convert a value to a logical or a zero one numeric so that maybe it's you just want you're doing your recoding</li>
<li>where you pick one value and it's got to be one or two values that are going to be true and everything else is gonna be false.</li>
<li>You may also want to threshold values. For example, if you've gotten ordinal,</li>
<li>maybe you have some ratings and you want to say you want to collapse that into a category or a logical feature of rated positively,</li>
<li>where if they gave it more than three out of five stars, you say it was rated positively.</li>
<li>This can be really useful because people are really noisy and their inputs, like some people will say.</li>
<li>For some people say a five and you can reduce some of that noise by saying, you know,</li>
<li>we don't care how good they said the movie was, we just care if they said it was good.</li>
<li>This is kind of what Rotten Tomatoes is doing with its percent Frasch.</li>
<li>They take each rating and they convert it into did the you did the person say rate it positively or not.</li>
<li>And they look at the fraction of users or of critics who rated the movie positively and that becomes that becomes a feature.</li>
<li>So you can also dummy code your values. If you've got a categorical value with more than two levels,</li>
<li>then you can expand that out of the multiple features, that dummy code, your variable or one hot in code.</li>
<li>You can also do a number of things, the continuous features. You can take a log. You can take a square root.</li>
<li>Both of these are useful for reducing SKU. Sometimes you might want to take a square or a higher order polynomial in order</li>
<li>to a higher order power or higher order polynomial building out more features.</li>
<li>You've got a feature and it's square and it's cube that lets you learn more complex, nonlinear functions using a linear model.</li>
<li>You can also standardize various standardized and center variables. So they're mean what they call what we call mean centered.</li>
<li>If you take the mean of a feature and you subtract it from all the feature values,</li>
<li>the resulting mean is zero and the data is now means centered and you can also democratize it.</li>
<li>So you can convert it to either to more than one bean or you can threshold it to convert it to a binary value that's positive or negative.</li>
<li>There is a binary value based on whether it's above or below a threshold. So but how do you think about when you want to do this?</li>
<li>There's a couple of things that particularly drive when we might want to transform features.</li>
<li>One is when the feature has a non linear relationship to our outcome.</li>
<li>Variable transformation of the feature and or the outcome variable can make the relationship linear.</li>
<li>And now all of our linear modeling techniques work again. Also that the feature is not normally distributed.</li>
<li>This isn't inherently a problem, but close to normally distributed features often work better.</li>
<li>There's often more likely going to be linear.</li>
<li>So if we have a feature that's really that's very not normal and there's a simple transformation that can make it normal,</li>
<li>that's often going to make it work better as a feature that's input into particularly a linear model.</li>
<li>But other kinds of models as well. So, for one example,</li>
<li>if we want to standardize variables where we want to do is we want to subtract the</li>
<li>main feature value that's going to make the new mean on the training data zero.</li>
<li>And then what this means is so if if you've got this means centered variable and you use it as a feature, a linear model.</li>
<li>Then when the value is average, you're just going to have the intercept or the intercept,</li>
<li>plus the other features and the coefficient describes the change in the re outcome.</li>
<li>As the variable bill goes above or below average, rather than as it goes just with respect to zero, it's its natural value.</li>
<li>Mean Centerin can also result in more interpretable intercepts.</li>
<li>Because. If all of your features are mean centered, then your intercept of your linear model is the average value.</li>
<li>If your features aren't, many aren't mean centered than the the intercept is average,</li>
<li>but corrected for the averages of your different features so it can make the model more interpretable.</li>
<li>It can make it make the meet means enter.</li>
<li>It makes the model far more interpretable.</li>
<li>It's also useful for dealing with sparse data because if you mean center your values, then it's a lot more reasonable to treat missing values as zero.</li>
<li>It's still a form of a mutation, but if you mean center your values and you have something come in that doesn't have a value,</li>
<li>you can say, well, we don't know anything about it, so we're gonna assume at zero or we're going to zoom it's average.</li>
<li>Since you've means centered, the value average means the coefficient on that feature plays no role in the outcome prediction.</li>
<li>That's also very important. So mean centering really gives you this way to allow missing data to not have an effect</li>
<li>in your model because you're going sue its average average has a zero coefficient.</li>
<li>Its outcome is going to be based completely on the values of the other features and the observation.</li>
<li>It's not a perfect solution for all systems. You can't just blindly assume it's going to work, but it is a really useful technique.</li>
<li>The other thing we do in standard is a full standardization is we divide by the standard deviation and so the resulting value of F X.</li>
<li>We have a value X AI that's in our input feature. We subtract the main divide by the standard deviation and we get this transformed value x sabai.</li>
<li>Now the coefficients on this in a linear model are going to be a units of standard deviations.</li>
<li>So if f x changes by one standard deviation, how much does that change the output?</li>
<li>One. And this also makes if we standardize it, this makes our coefficients more directly comparable.</li>
<li>Because if all of our features are standardized or all of our numeric features are standardized,</li>
<li>then all of the coefficients are in terms of standard deviation.</li>
<li>You can say if this feature moves by one standard deviation,</li>
<li>if that feature moves by one standard deviation and you don't have to deal with all this was in millimeters and this one's in Gramp's,</li>
<li>how do we think about the relative impact of these two features? You can't if they're in their natural units, you can.</li>
<li>If they're in terms of standard, it's much easier if they're in terms of standard deviations.</li>
<li>And this applies to both inference and predictive modeling.</li>
<li>Now, it's important to note that the the parameters here, the mean that we're going to shift by.</li>
<li>And the scaling factor are parameters that we learned from the training data.</li>
<li>And when we want to transform the test data, we need to transform them by the training data's parameters,</li>
<li>because effectively what you do is part of the training process. You learn.</li>
<li>Okay, I've got I've got my coefficients, but also I normalize this feature by subtracting seven and dividing by three.</li>
<li>Well, that's going to change a little bit with different training data.</li>
<li>So you treat these as parameters and use the same values for transforming your test data.</li>
<li>I want to show you an example of why you might want to do a log transform even for binary outcome.</li>
<li>So here what I've done. Here's our outcome variable.</li>
<li>And I've been and I've shown a Bloks box plot of our input variable as it changes for the two versions, the output variable.</li>
<li>So we've got some much larger values here. And what's going to happen with these larger value?</li>
<li>One of the things that's gonna happen with these larger values.</li>
<li>Yes, it's useful that yes, it's useful that the values, the mean or the median is higher.</li>
<li>So it's going to. Yes. If for higher values, it's more likely to be a one on the outcome.</li>
<li>But we have a very, very large values. And you get. OK.</li>
<li>So you get some these a little bit lower. But you can. OK. We're gonna get one of these values its way up here at fifty.</li>
<li>You put that in your linear model. If on the off chance, that might be a zero.</li>
<li>It's going to jack the. It's going to push the numbers so far. Or the model output so far,</li>
<li>it's impossible for any other features to do anything to allow these extreme that these larger values to just completely dominate your computation.</li>
<li>So if you log transform, what you're gonna do is you're going to significantly decrease the skew.</li>
<li>It's not going to make our poor distributions perfectly symmetric. But the skew is going to be there's going to be substantially less skew.</li>
<li>There's going to be substantially smaller range. These values are a lot more comparable to each other.</li>
<li>And so the log we are looking at a difference of two here rather than about eight.</li>
<li>And we don't have the massively large values like the the top value here is only as large as four.</li>
<li>And so it really is going to make the values a lot a lot better distributed.</li>
<li>If you've got heavily skewed data, it's worth trying both a log transform and a square root transform,</li>
<li>just depending on how precisely the data is skewed. One might work better than another, but you decrease the skew, you decrease the range.</li>
<li>The values are a lot more contained. You don't the extreme values are still being collapsed down to a much more manageable range.</li>
<li>And this is. But we haven't lost the fact that a difference in this value is going to correlate with a difference in outcome.</li>
<li>We haven't lost the ability to use it to distinguish. We've just compressed, condensed that ability down into a more reasonable range of values.</li>
<li>So the resulting mathematical model is going to be better behaved. Another example is descript haisong.</li>
<li>So sometimes this might come from outside knowledge.</li>
<li>So one of the hints I've given you in the assignment is that you might want to disk critize term</li>
<li>so that greater than or equal to two hundred and forty months is considered a real estate loan.</li>
<li>We know that's a reasonable thing to do from the reading that came with the data set and explain what happens with the real estate loans.</li>
<li>You might also, as I said earlier, talk about going from greater than three stars to I liked it.</li>
<li>It can reduce the noise in the rating data. One sign that you might want to discuss ties.</li>
<li>If there's a non-linear response with a sharp change, it might be that you want rather than.</li>
<li>Trying to fit a continuous model may be the OK. There's this really sharp jump, a really sharp change at a particular point.</li>
<li>Let's let's turn that into a binary feature. One way you can think and sometimes what you might want to do is just split the data in half.</li>
<li>So your median becomes your threshold. You might want to look for an inflection point, increase in the response curve of some other variable to it.</li>
<li>One thing to note, though, is that discrimination can have very subtle effects on your model performance.</li>
<li>You have to be careful with it. If you're measuring all the things you're measuring about your model,</li>
<li>make sure you measure them after you change your disparate causation to see what happens as the results change.</li>
<li>So there's other transformations you can do to a box.</li>
<li>Cox or a power transformation learns a monotonic function of data to transform all your points quite a bit into something that's close to normal.</li>
<li>And effectively, you've learned the parameters of this transformation to optimize like with the objective function.</li>
<li>That is that back that minimizes its distance from normality and the distribution of the resulting form of the resulting data.</li>
<li>Psychic learned gives you methods for doing boxcutter, for doing power transformations, splain functions,</li>
<li>allow you to learn complex functions that don't have to be monotonic of a single variable.</li>
<li>We're not going to touch on them. I just want you to know that they exist.</li>
<li>But also sometimes we're going to need to deal with multi feature normalization. So we have a group of related features.</li>
<li>These might be we've got some of our features are accounts of different tack.</li>
<li>Like how often users have tagged the ah item with different tags.</li>
<li>And sometimes it's going to be useful to normalize those together that either some to one or they form a unit vector.</li>
<li>The sum of squares is equal to one. And this. This for the unit vector one,</li>
<li>it puts makes its that all of them are on a unit hyper sphere and so like you can compute similarities between them easily.</li>
<li>Distances become more normalized if it's word counts or tag count.</li>
<li>So if you if your features are how many times you've say you've got ten different tags and you allow users to tag it</li>
<li>with those tags or you have the Facebook emoji responses and users can respond with five or six different emojis,</li>
<li>and your features are how often they've responded to each of these emojis?</li>
<li>Well, there's two components of each of those features.</li>
<li>The two in the two components are how many people have interacted with this because if a million people interact with a message.</li>
<li>And five and a thousand people interact with a message or 10 people interact with the message.</li>
<li>They're going to have and the same fraction of them use the wow emoji.</li>
<li>You're going to have the feature values are going to be dominated by the popularity, not by the wow.</li>
<li>How much it's wow versus how much it's care or how much it's t.</li>
<li>It's cry.</li>
<li>And so if you make them some to one or if you turn them into a unit vector, then you make it to these features are no longer proxies for popularity.</li>
<li>But they are specifically. What fraction of the interactions are wow or cry or heart or care?</li>
<li>And if you all you probably also want to keep a popularity and there you.</li>
<li>There's a good chance you want to take take the log of it. But it really treant changes the meaning of the feature.</li>
<li>How many caires is a different feature from what fraction of responses work hair.</li>
<li>And depending on your modeling task, one of those might be a more useful model than the other.</li>
<li>And so you can get this multi feature normalization that you want to do together.</li>
<li>Another thing you can do with multiple features is an eye interaction term that we've seen a product.</li>
<li>You can combine the effects of two features by multiplying them together. And if they're numeric, then it's the product of them.</li>
<li>If one of them is logical or it's the dummy for a categorical, then effectively what it does is it turns on or off the other feature.</li>
<li>It gives you an F in your linear model.</li>
<li>And so B one two is the influence of if if X one is logical and B one, two is the influence of X two when X one is equal to one.</li>
<li>But if one is equal to zero, it just uses the default term.</li>
<li>B two X two. Now the effects are additive. So one X one is one.</li>
<li>The result is B two times. So if, if we have B two X two and we have B one two x one.</li>
<li>X two. And X is equal to one or X, one is equal to one, then the total coefficient.</li>
<li>On X two is Beda two plus beta one to.</li>
<li>And that's how you'd interpret it. You're going to go interpret the coefficients.</li>
<li>But this is a really useful way to allow a feature to have additional effect for some of the.</li>
<li>Additional linear effect for some of your of your data point and not for others.</li>
<li>Another one you can do as you can, computer ratio or a fraction.</li>
<li>And one example of this, if we're trying to model something that happens when students are in a class, again, this is a useful thing to do.</li>
<li>And you've got something that's dominated by popularity. You have to be careful with counts.</li>
<li>Counts from user activity often become really heavily skewed.</li>
<li>And if you've got anything that's a count of something, you really it's going to be dominated by popularity.</li>
<li>And it often times it's going to be more effective to separate popularity as its own feature</li>
<li>from how much of that popularity is being allocated to different things in your model.</li>
<li>So if a an x ray is the number of students in a class and X F is the number of first year students in a class,</li>
<li>and we want to understand like something about the B,</li>
<li>the impact of a class or the dynamics of a class based on what frat based on how many first years are taking it?</li>
<li>Well, a small class is going to a small number of first years and it's going to have a small number of students.</li>
<li>So we might take a ratio or proportion.</li>
<li>And so we might take the X, F, F for a fraction first year, which is the first year divided by the total students.</li>
<li>And that's going to give us the fraction of students for first year. And that allows us to build a model that rather than being.</li>
<li>I have two proxies for popularity. Number of students, a number of first years.</li>
<li>It allows us to separate. OK. What is the influence of having a lot of students in the class as a separate component of our predictive</li>
<li>modeling from what is the influence of having a large portion of the class being first year students?</li>
<li>And it also reduces our clinic already because X, say, at X, F are going to be quite highly correlated.</li>
<li>But X say an X, F, F probably won't or won't be.</li>
<li>At least they likely won't be unless larger classes are more likely to have more first year for a higher fraction of first years.</li>
<li>So it's another piece of the toolbag, an assignment five.</li>
<li>I give you a suggestion to possibly consider computing a ratio or a fraction feature.</li>
<li>There are other combinations we can do too, such as the difference. So if you take if you have a list of of actions, say,</li>
<li>forum posts or account transactions and you take the activity date minus the accounts creation date,</li>
<li>then what you get is the account age at the time of activity. And if you're trying to classify something that you're trying to understand.</li>
<li>OK, what is this more happened with new accounts. It allows you to make the feature rather than being when did the thing happen?</li>
<li>It allows the feature to be how established was the account when it was the account when it happened.</li>
<li>You then might want to describe disparities. It is this account at least a year old,</li>
<li>because it might be that established accounts of that established accounts are going to have different behavior than new accounts.</li>
<li>You might also want to some you want to combine with.</li>
<li>You can also combine with single feature transforms so you can do a product where one of the features is logged or square rooted or whatever.</li>
<li>So you can combine these things in arbitrary ways to get the final set of features that you need.</li>
<li>Actually, figuring out what are these you need to do takes practice and creativity.</li>
<li>I've given you a few hints. Look, to try to make things normal. Look to try to build linear relationships.</li>
<li>Look for hard jumps. Like if you if you haven't if you plot an X value and you plot a Y response, you see this jump at some point.</li>
<li>That suggests democratization might be useful. One thing that's super useful, though, is to read read other data.</li>
<li>Scientists working in Europe, brain working in other domains. If you're doing research, you should be reading papers.</li>
<li>Pay attention to what they do in their feature engineering. What features do they pick?</li>
<li>Why do they pick them? That can give you a lot of good ideas for what to go do when you're doing your own projects.</li>
<li>Also, it's important to note that you do all this feature exploration and design on the training data.</li>
<li>You don't get to look at your testing data while you're doing your feature exploration and development.</li>
<li>So to wrap up transforming and building features is a really important and powerful part of model building.</li>
<li>The model can only accept. So one of the things some deep learning models can do is do some of their own feature engineering,</li>
<li>like they can work with raw features and learn sophisticated functions of them on somewhat on their own.</li>
<li>That works well, very well for some domains, but for a lot simpler models.</li>
<li>The model can only work with the features you give it.</li>
<li>We're gonna see some techniques for automatic feature selection, but though they can't generate new features, they can.</li>
<li>If you if you give them a product, they can decide whether or not it's actually helping the model.</li>
<li>But they can't create the product. If you didn't give them product feature to start with.</li>
<li>So it's important to get your features right and to give your model a good set of features to work with.</li>
<li>Even when you're doing automated feature selection.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="workflow">
<h2>🎥 Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h2>
<p>How do you do feature engineering and model selection in a machine learning workflow?
What is the iterative process involved?</p>
<div class="resource video docutils container" id="71b1aa35-8435-4eae-ae32-ac660033ee09">
<div class="tabbed-set docutils">
<input checked="checked" id="39d27ce4-f76d-41c2-83f6-e3134d142a7a" name="8276524f-2a81-4605-94b2-84288493058a" type="radio">
</input><label class="tabbed-label" for="39d27ce4-f76d-41c2-83f6-e3134d142a7a">
Video (14m29s)</label><div class="tabbed-content player docutils">
<div class="video-container video-embed">
<iframe src="https://boisestate.hosted.panopto.com/Panopto/Pages/Embed.aspx?id=71b1aa35-8435-4eae-ae32-ac660033ee09&autoplay=false&offerviewer=true&showtitle=true&showbrand=false&start=0&interactivity=all" height="405" width="720" style="border: 1px solid #464646;" allowfullscreen allow="autoplay"></iframe>
</div></div>
<input id="16b41c2d-4643-4730-a353-e24e29b716a1" name="8276524f-2a81-4605-94b2-84288493058a" type="radio">
</input><label class="tabbed-label" for="16b41c2d-4643-4730-a353-e24e29b716a1">
Slides</label><div class="tabbed-content slides docutils">
<div class=slide-container data-id="495979F9A431DDB0%2173324" data-key=AGk8GhY4fx1Mnm8>
</div></div>
</div>
</div>
</div>
<div class="section" id="scikit-pipelines">
<h2>🎥 SciKit Pipelines<a class="headerlink" href="#scikit-pipelines" title="Permalink to this headline">¶</a></h2>
<p>In this video, I introduce SciKit <em>pipelines</em> that put multiple transformations together.</p>
<div class="resource video docutils container" id="f448da70-c2d2-4c1b-942b-ac66003656a1">
<div class="tabbed-set docutils">
<input checked="checked" id="a49dbbd0-94f8-4035-9dc2-ca01422279fa" name="5085a0a0-431e-4c0c-8310-0d6ccc047b44" type="radio">
</input><label class="tabbed-label" for="a49dbbd0-94f8-4035-9dc2-ca01422279fa">
Video (7m19s)</label><div class="tabbed-content player docutils">
<div class="video-container video-embed">
<iframe src="https://boisestate.hosted.panopto.com/Panopto/Pages/Embed.aspx?id=f448da70-c2d2-4c1b-942b-ac66003656a1&autoplay=false&offerviewer=true&showtitle=true&showbrand=false&start=0&interactivity=all" height="405" width="720" style="border: 1px solid #464646;" allowfullscreen allow="autoplay"></iframe>
</div></div>
<input id="70a8e69e-32d6-48ea-8f96-c1f4dc8cbcc7" name="5085a0a0-431e-4c0c-8310-0d6ccc047b44" type="radio">
</input><label class="tabbed-label" for="70a8e69e-32d6-48ea-8f96-c1f4dc8cbcc7">
Slides</label><div class="tabbed-content slides docutils">
<div class=slide-container data-id="495979F9A431DDB0%2173328" data-key=ACahS4jRCAE3ueU>
</div></div>
</div>
</div>
</div>
<div class="section" id="scikit-learn-pipelines">
<h2>📃 SciKit Learn Pipelines<a class="headerlink" href="#scikit-learn-pipelines" title="Permalink to this headline">¶</a></h2>
<p>Read the <a class="reference external" href="https://scikit-learn.org/stable/modules/compose.html">SciKit-Learn User Guide chapter on pipelines</a>.</p>
</div>
<div class="section" id="scikit-learn-preprocessing">
<h2>📃 SciKit Learn Preprocessing<a class="headerlink" href="#scikit-learn-preprocessing" title="Permalink to this headline">¶</a></h2>
<p>Read the <a class="reference external" href="https://scikit-learn.org/stable/modules/preprocessing.html">SciKit-Learn User Guide chapter on pre-processing</a>.</p>
</div>
<div class="section" id="regularization">
<h2>🎥 Regularization<a class="headerlink" href="#regularization" title="Permalink to this headline">¶</a></h2>
<p>This video introduces regularization: ridge regression, lasso regression, and the elasticnet.
Lasso regression can help with (semi-)automatic feature selection.</p>
<div class="resource video docutils container" id="fa457314-7344-48cd-af1f-ac660039cbc4">
<div class="tabbed-set docutils">
<input checked="checked" id="46655c86-5375-4cc3-8e57-56e3a1fad948" name="3f71cc27-f186-47b4-8baf-98f7e1128e2a" type="radio">
</input><label class="tabbed-label" for="46655c86-5375-4cc3-8e57-56e3a1fad948">
Video (15m4s)</label><div class="tabbed-content player docutils">
<div class="video-container video-embed">
<iframe src="https://boisestate.hosted.panopto.com/Panopto/Pages/Embed.aspx?id=fa457314-7344-48cd-af1f-ac660039cbc4&autoplay=false&offerviewer=true&showtitle=true&showbrand=false&start=0&interactivity=all" height="405" width="720" style="border: 1px solid #464646;" allowfullscreen allow="autoplay"></iframe>
</div></div>
<input id="a104dfa0-e458-47b0-8875-6e2d3e902344" name="3f71cc27-f186-47b4-8baf-98f7e1128e2a" type="radio">
</input><label class="tabbed-label" for="a104dfa0-e458-47b0-8875-6e2d3e902344">
Slides</label><div class="tabbed-content slides docutils">
<div class=slide-container data-id="495979F9A431DDB0%2173326" data-key=APzIM2g9IcVX0XQ>
</div></div>
</div>
<div class="slides text hidden docutils">
CS 533INTRO TO DATA SCIENCE
Michael Ekstrand
REGULARIZATION
Learning Outcomes
Understand the function of a regularization term in a loss function
Apply regularization to logistic regression models
Tune regularization parameters
Photo by Joshua Hoehne on Unsplash
Multicollinearity
Correlated predictors cause poor model fit
X1
X2
Y
Loss and Regularization
Vector Norms
Understanding Regularization
How do you increase loss?
Increase a coefficient
How does that happen?
Strong relationship
More of the common factor on one than another
Balancing
Regularization Factor
Lasso Regression
The Elastic Net
Applying Regularization
Standardize numeric first
Coefficient strengths are comparable
0 is neutral, coefficient magnitude is strength of relationship
Select hyperparameters based on performance on tuning data
Scikit-Learn CV classes help with this
See notebook for example
Wrapping Up
Regularization penalizes large values of coefficients.

This controls model structure and, combined with standardization, requires “strong” beliefs in relationships to be justified by reducing training error.
Photo by Jasper Garratt on Unsplash
</div>
<div class="captions text hidden docutils">
<ul class="simple">
<li>But now it's time for a topic that I've mentioned a few times, when we're actually going to learn what it is, regularization.</li>
<li>So the goal here is for you to understand the function of regularization,</li>
<li>terminal lost function and apply regularization to your logistic regression models and then finally tune regularization parameters.</li>
<li>I want to start by reviewing MultiKulti Darity. So remember that if we have correlated predictors that can cause poor model fit.</li>
<li>So if we've got X1 and x2 and they cause why we've got this correlation between them.</li>
<li>We don't know particularly where the common affects, so we can have a look.</li>
<li>So we can factor this out as X one two plus X one plus X two.</li>
<li>Except we don't actually have X one to. It's hidden behind the wall.</li>
<li>Where does it. Where does its its value go when the coefficients?</li>
<li>Does it go on X one, does it go next to you split it between them?</li>
<li>The linear model itself has no way to determine where the common component should actually be allocated.</li>
<li>And so one way we can deal with this and several other problems is by introducing what we call a regularization.</li>
<li>So rather than just solving the problem, minimize lost function.</li>
<li>And so if this is a linear regression, this might be squared loss or suspect B squared error.</li>
<li>This might be negative log likelihood. Log likelihood is a utility function, a negative log likelihood to be a positive value,</li>
<li>because the log likelihood they're negative is a lost function. You want to minimize your negative log likelihood.</li>
<li>And what we do is we add to that another term, which is we call the regularization term.</li>
<li>And all it is, is it is a parameter of the regularization strength times,</li>
<li>the magnitude of our parameters lost function now as two terms, the error and the and the magnitude of the coefficients.</li>
<li>When we're doing the squared magnitude here, we call it the ridge regression.</li>
<li>So quick detour on some of the notation. I'm using a norm as a measure of the magnitude of a vector.</li>
<li>So when we say X, we say the L2 norm, which is indicated with the subscript two, there's called it L2 Norma Euclidean norm.</li>
<li>What it is, is it's the square root of the sum of the squares that the elements of the vector.</li>
<li>If you take the L2 norm of Y minus Z, that's the Euclidean distance between Y and Axis.</li>
<li>If they're two dimensional vectors, it's the straight line distance between them.</li>
<li>So if you've got Y. And you've got X, Y, Z.</li>
<li>It's the straight line distance between them, the.</li>
<li>And then we can square it. So subscripts two means L2 Naum superscript, two means square.</li>
<li>And that's the sum of the squares of the element. So we get rid of this square root and we get the some of the squares useful, really useful.</li>
<li>It it simplifies the computation just a little bit. And it's how the retrogression normalization is defined or regularization is to find the L1 norm.</li>
<li>Subscript one is the sum of the absolute values and we call this the Manhattan or taxicab distance</li>
<li>because it's the distance you would have to travel if you could only travel in straight lines.</li>
<li>So if you want to go from X to Y, it's the it's the total length of that path.</li>
<li>So but it's also it's also useful, some of absolute values.</li>
<li>I'll want to some of absolute values. L2 is the sum as the square root of the sum of the squares.</li>
<li>You can generalize to get other norms as well. But this is what this notation means.</li>
<li>The magnitude of the vector. And so when we build up this rig, we build up our regularized model the way we increase.</li>
<li>The. The way we increase this component, the loss.</li>
<li>Remember the way we want to think about it. One of the tools we want to use for understanding a metric is how do you how do you make them change?</li>
<li>How do you increase them or decrease them? And the way you increase or decrease this part of the lost function is you.</li>
<li>You increase the coefficient and that can happen where having a strong relationship</li>
<li>that can happen by putting more the common factor on one than another. So when you have this multiple linearity,</li>
<li>one thing the retrogression regression is going to do is it's going to encourage the</li>
<li>model to distribute the influence of the common factor between the different sub factors.</li>
<li>Because if I put it all on one, that would increase the square more than if it divides it evenly between the two,</li>
<li>the way you minimize the squares as you divide the common the common components evenly between the two features.</li>
<li>It's it's a part of and it gives us a solution. So a multi linearity our system is under determined.</li>
<li>We don't have enough information to know where the coefficient is by adding regularization to our to our lost function.</li>
<li>We introduce this additional this additional loss that.</li>
<li>Tells it where to put it. By making the least expensive solution be the one where it's evenly distributed between all of the correlated features.</li>
<li>So where do we have this lost function, we have our our error loss plus our coefficient strength.</li>
<li>We can minimize this in two ways. We can minimize it by decreasing our error and we can minimize it by having small coefficients.</li>
<li>And what effectively, though, what that means is in order for a coefficient value to be large, it has to earn its keep and it has to earn its keep.</li>
<li>By decreasing training error. If if if if you've got a minimum, if you if you've got a particular value,</li>
<li>we're going to try to try to increase the coefficient and increase the coefficient.</li>
<li>That might give us a lower error. We only get a lower total loss if it decreases the error by more than it increases</li>
<li>the coefficient after take into account square and our regularization strength term.</li>
<li>And it gives this it encourages the coefficients to be small values unless a large value contribute significantly</li>
<li>to decreasing the models error on the training data squared error or increasing its log likelihood.</li>
<li>We're talking about a logistic regression.</li>
<li>The regularization parameter lambda is what we call a hyper parameter because we don't learn lambda from the data in general,</li>
<li>like within a single linear model. We don't learn lambda from the data.</li>
<li>We have to come in from outside the exact impact. The value depends somewhat implementation details such as how difficult one thing is,</li>
<li>the loss function itself, a mean or a some different psychic models actually make it.</li>
<li>You can't just take a regularization term for once I get model and use it for another,</li>
<li>even if they're both doing L2, because other details of lost function mean the value doesn't transfer,</li>
<li>because if it's using a sum of squared error,</li>
<li>then the regularization strength needs to depend on the data side because for the same amount, for the same amount of average error.</li>
<li>The sum of squared error is going to be larger just for having more data.</li>
<li>If it's a mean, then it's going to then you're right, Visitacion term is not going to depend on your data size.</li>
<li>Some Saikat models also use a concentration parameter C, which is one over Lambda Lambda,</li>
<li>and it's multiplied by the error instead of being multiplied by the by the, the coefficients.</li>
<li>Because the strict parameters. So an increased value of lambda or a decreased value of C results in stronger regularization,</li>
<li>a coefficient has to contribute more to the model performance to earn the keep for for a large value than it does with weaker regularization.</li>
<li>Now one good way to learn to write a good value for Lambda is to optimize with the training and tuning split of the training data.</li>
<li>Saikat learned. We'll do this automatically if you use.</li>
<li>So a lot of the repressors also of a CVO class logistic regression c.v you're going to have REJ CV.</li>
<li>Quite a few others have a CV variant.</li>
<li>And what happens with the CV variant is it will learn values for one or more hyper parameters by doing Krait when you call fit with training data.</li>
<li>It will cross validate on the training data to learn and you can give it a range of Perama,</li>
<li>a range of hyper parameter values to consider a list of them.</li>
<li>It will do. It will do the cross validation to automatically learn good values, the best values it can for these regularization parameters.</li>
<li>There is also a class grid search CV that allows you to do hyper cross validation to search for good hyper parameter values,</li>
<li>for any parameter, for any hyper parameter for a psychic. Learn model.</li>
<li>I encourage you to go play with that at some point. But logistic regression CV will do that automatically just in the fit call within</li>
<li>itself's with all it'll find a good and a good regularization strength value.</li>
<li>So the lasso regression. This looks very, very similar, except every place, that square at L2, nor in the sum of squares.</li>
<li>With the L1 norm, we're now looking at some of the absolute values and so the Elst, the square, the L2 norm allows it encourages values to be small.</li>
<li>But if the value is close to zero, it doesn't like it's close to zero. Fine.</li>
<li>What the oh one naum one of the effects it has is it doesn't like small noun's zero values.</li>
<li>If a coexistent value was small as L1, Naum is going to push it to zero.</li>
<li>And what this does is it makes the coefficient spot what we call sparse, sparse data is data with a lot of zeros.</li>
<li>And so. If a coefficient is not contributing very much to classification, it's going to go to zero.</li>
<li>And you can use that to see which class, which features are actually being used in the classification.</li>
<li>And it effectively becomes an automatic feature selection technique because it's going to push the it's going to push the.</li>
<li>Coefficients for features that don't contribute very much to decreasing your training error to zero.</li>
<li>You can then put them together in what's called the elastic net, which combines L1 and L2 regularization.</li>
<li>And you have an overall regularization strength lambda that controls your regularization or Seage was one over lambdas.</li>
<li>What's going to multiply the loss function by sea? And then we have L1 regularization and L2 regularization.</li>
<li>And they're balanced and they're balanced with this parameter ro.</li>
<li>And so you could parameter Ryze. It's you just have your L1 strengthen your L2 strength.</li>
<li>But most elastic net implementations have a regularization strength.</li>
<li>Your out your lambda area C. And some of the psychic docs that use Alpha for this.</li>
<li>And then you have a balance that says how much of the regularization to put on a one?</li>
<li>And how much to put on L2 and these parameters both need to be chosen by cross-validation.</li>
<li>That's really the only way to find good values if you use logistic regression.</li>
<li>So logistic regression and logistic regression CVA can do elastic net.</li>
<li>There's also an elastic net and elastic net CV classes. And by default, if you use logistic regression CV, it's only going to use.</li>
<li>It's only going to search for the it's going to default L2 regularization and search for the regularization strength.</li>
<li>If you want elastic net, you change the penalty option.</li>
<li>You also have to change the solver because only one of the logistic regression can you several solvers to learn the logistic regression parameters.</li>
<li>Only one of them supports elastic net. And then you're going to need some additional options in order to tell it to also search for for that L1 ratio.</li>
<li>But it can do all of that for you.</li>
<li>I refer you to the documentation for though, with logistic regression, logistic regression, CV classes to see how to do that.</li>
<li>You're gonna find it useful in assignment five. I'm also gonna be giving you an example in the synchronous session that is dealing with some of this.</li>
<li>So some notes on applying regularization, though.</li>
<li>Regularization really works best when you're numeric variables are standardized because the coefficients.</li>
<li>It's it's looking at the total magnitude of your coefficient vector.</li>
<li>And if one of your coey if one of your features is in units of millimeters and one of your features is in units of KG's,</li>
<li>the coefficient values have nothing to do with each other. And so looking at the total magnitude, treating them as elements of a vector,</li>
<li>it becomes really difficult and it's going to penalize one just for having to have a larger range because of the underlying units.</li>
<li>If you standardize your numeric variables, then each one is in terms of standard deviation.</li>
<li>The coefficients become a lot more directly comparable with each other and your regression is going to be better be your your regularization</li>
<li>is going to be better behaved than you want to select your hyper parameters based on performance and the tuning getter and the CV classes,</li>
<li>as I said, get help with this. I'm giving you an example and one of the notebooks that does so give you an example,</li>
<li>a notebook that does uses logistic regression CV to do hyper parameter search for L2 regularization.</li>
<li>So you can see that in action with a simple example. So to conclude.</li>
<li>So to conclude regularization. Imposes costs on the model for large coefficient values, either large squared values, the large, absolute values.</li>
<li>Squared costs, which we call Rig Ridge Regularization, encourages values to be small.</li>
<li>Absolute value loss, so to call L1 or lasso regularization encourages small values to be zero.</li>
<li>If you put those together, it encourages values to be either zero or large enough to be meaningful, but not super large.</li>
<li>L2 regularization or Vage regularization is useful for controlling the effects of multicam linearity.</li>
<li>And together they're useful for decreasing your moral complexity. Allow making coefficient values to earn their keep.</li>
<li>Another way.</li>
<li>So another thing that they do is if everything's standardized or at least means centered, then small coefficients results in small effects.</li>
<li>And effectively what it means is assume everything's average. Unless we have enough evidence,</li>
<li>enough data to justify stronger beliefs and beliefs and stronger relationships that</li>
<li>are justified in terms of their ability to reduce our error on the training data.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="pipeline-and-regularization">
<h2>📓 Pipeline and Regularization<a class="headerlink" href="#pipeline-and-regularization" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../resources/tutorials/SciKitPipeline/"><span class="doc std std-doc">This notebook</span></a> demonstrates pipelines and <span class="math notranslate nohighlight">\(L_2\)</span> regression, and performs a significance test of classifier improvement.</p>
<p>It also shows a training of a decision tree (next video).</p>
</div>
<div class="section" id="advanced-pipelines">
<h2>📓 Advanced Pipelines<a class="headerlink" href="#advanced-pipelines" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../resources/tutorials/AdvancedPipeline/"><span class="doc std std-doc">Advanced Pipelines notebook</span></a> demonstrates a much more advanced SciKit-Learn pipeline.</p>
</div>
<div class="section" id="models-and-depth">
<h2>🎥 Models and Depth<a class="headerlink" href="#models-and-depth" title="Permalink to this headline">¶</a></h2>
<p>What does the world look like beyond logistic regression?
Can a model output be a feature?</p>
<div class="resource video docutils container" id="220a8acb-a901-49e7-bf9e-ac66003d7033">
<div class="tabbed-set docutils">
<input checked="checked" id="40e3281a-e99b-46b0-a65d-57c5a751c728" name="4ee9bfcc-219a-4c16-a042-df7954e1e35b" type="radio">
</input><label class="tabbed-label" for="40e3281a-e99b-46b0-a65d-57c5a751c728">
Video (7m23s)</label><div class="tabbed-content player docutils">
<div class="video-container video-embed">
<iframe src="https://boisestate.hosted.panopto.com/Panopto/Pages/Embed.aspx?id=220a8acb-a901-49e7-bf9e-ac66003d7033&autoplay=false&offerviewer=true&showtitle=true&showbrand=false&start=0&interactivity=all" height="405" width="720" style="border: 1px solid #464646;" allowfullscreen allow="autoplay"></iframe>
</div></div>
<input id="9b25feef-b977-44b9-8b6e-70fac679af41" name="4ee9bfcc-219a-4c16-a042-df7954e1e35b" type="radio">
</input><label class="tabbed-label" for="9b25feef-b977-44b9-8b6e-70fac679af41">
Slides</label><div class="tabbed-content slides docutils">
<div class=slide-container data-id="495979F9A431DDB0%2173330" data-key=APtXIrllUsY0_vY>
</div></div>
</div>
<div class="slides text hidden docutils">
CS 533INTRO TO DATA SCIENCE
Michael Ekstrand
MODELS AND DEPTH
Learning Outcomes
Introduce models beyond linear and logistic models
Introduce the idea of a model output as a feature
Photo by Tim Mossholder on Unsplash
More Models
Decision Tree
Tree of nodes
Each node is a decision point
Result when you reach the bottom

Can learn complex interaction effects on their own
Random Forest
Decision trees can have high variance – they can memorize a lot of the model

Random forest:
Take (partial) bootstrap samples of the training data
Fit decision trees
Predict by taking vote from trees
Models as Features
Feature outputs don’t have to come directly from data
Transformation models (e.g. principal component analysis)
Prediction models for other tasks

Example: LinkedIn job ad recommender
Logistic regression
Features from text, job description, user, etc.
One feature: transition probability estimate
Many Models
Linear (GLM, GAM, etc.)
Support vector machines
Naïve Bayes classifiers (we’ll see those later)
Neural nets
Often play the logistic regression game – logit function to convert model scores to probabilities

Wrapping Up
There are many models for classification (and regression).

Model outputs can also be features for other (often linear) models.
Photo by Michal Janek on Unsplash
</div>
<div class="captions text hidden docutils">
<ul class="simple">
<li>Bo and this video, I want to move beyond logistic regression to talk about some additional classification</li>
<li>models and also introduce the idea of putting models in features for other models.</li>
<li>So learning outcomes are to do exactly what I just said.</li>
<li>So so far, we've been estimating the probability of Y equals one by using a linear linear model, a Y hat equals actually would logistic.</li>
<li>Of this. And we can use any estimate of this probability or we can just use models that output decisions,</li>
<li>these may be based on scores, the scores that aren't estimated probabilities.</li>
<li>For example, a support vector machine uses distance from either plane as its score.</li>
<li>But we're not limited to just using a logistic regression, of course.</li>
<li>So for one model, a decision tree is a tree of nodes where each node is a decision point.</li>
<li>So I made a little decision tree here for the grad student admissions example.</li>
<li>And at the first node, it's going to check if the GPA is less than or equal to three point four three five.</li>
<li>And if it's less, it's gonna go to the left hand side. And there's extra nodes here, but it's going to deny admission.</li>
<li>And if it's greater than three point four, three, five, it's then going to look at their class rank,</li>
<li>their school rank, and if their school rank is less than one point five, it's going to do.</li>
<li>It's going to admit. And if it's greater than one point five, it's going to deny.</li>
<li>Really simple model. It would be absolutely terrible to actually use this model for regression, for admissions decisions, but for predicting the.</li>
<li>But here we aren't. We aren't trying to build a model that will admit we're trying to build a model</li>
<li>is gonna predict whether someone is going to get admitted it might work. But this illustrates how the decision tree actually works.</li>
<li>They can learn complex interaction effects on their own because you can have the threshold.</li>
<li>And what happens with the features changes as you go down to the node? Now, one of the problems, though, they have high variance,</li>
<li>they can effectively memory memorize all of the training data by building themselves a lookup table that looks up the outcomes for training data.</li>
<li>By the by the feature values, you can get extremely good training, accuracy.</li>
<li>I trained one on this data with with unlimited feet, feature depth and I got training accuracy of over 99 percent.</li>
<li>And I got tested accuracy of point five to.</li>
<li>But a random forest, what a random forest does is it takes bootstrap samples by default psych, it learns random for us.</li>
<li>We'll take complete bootstrap samples. You can tell it to take smaller ones.</li>
<li>It's not actually a bootstrap sample, but it's a subsample of the dataset. And it fits a decision tree to that sample.</li>
<li>And then it does that 100 times or however many times to get a bunch, you get one hundred decision trees.</li>
<li>And then for a final classification, when you tell it to predict what it's going to do is it asks all of the decision, trees to vote.</li>
<li>It's building up this random forest of happy trees. They're happy because they have a functioning democracy.</li>
<li>They all get to vote on the final outcome. And the random forest takes the vote and returns the majority of the classification.</li>
<li>Or if the if the individual values are producing scores, that it then it might average the scores and use that as an output.</li>
<li>So but you build up, you decrease your variance.</li>
<li>That you would get from training, it is, isn't she, on one set of data training decisions and another set of data by train?</li>
<li>The decision tree on a bunch of sets of data by sub sampling your training data and then averaging over that in order to produce your final output.</li>
<li>Brandon Forest is one of the classifiers that I want you to use in your assignment.</li>
<li>Another thing, though, that I want to introduce is that feature output features don't have to directly come from data.</li>
<li>So a lot of our features are going to come from data.</li>
<li>But sometimes they're when they come from other models, sometimes they're a transformation model, some kind of what we call unsupervised learning,</li>
<li>where it's computing things,</li>
<li>but it doesn't have an output class that it's that's known that it's trying to predict or prediction models for other tasks.</li>
<li>For example, in link to end their job ad recommender, the last I knew just a few years ago, it was it was at a high level.</li>
<li>It was a logistic regression. You're going to LinkedIn. It says, here's a job ad for you.</li>
<li>Well, that's coming from a logistic regression.</li>
<li>But that logistic regression has very complex features, some of which are the outputs of other machine learning models.</li>
<li>And so you're gonna get features from the job text, the job description features in the user's profile.</li>
<li>One particularly interesting feature they use is a transition probability estimate.</li>
<li>So they have a model. This is another. This is a statistical model that tries to predict.</li>
<li>So if you are currently working and Boise as a data scientist,</li>
<li>what's the likelihood that you would transition to a job title of senior data scientist in Salt Lake City?</li>
<li>And so it takes into account job transitions like data.</li>
<li>Scientists might leave the senior data scientists, software engineers to staff, software engineers or principal software engineers.</li>
<li>It takes into account current migration patterns in the industry and various things like that to get this.</li>
<li>How likely are you to even go move someone at a staff?</li>
<li>Software engineering position is unlikely to take a job that where the title is Junior Software Engineer.</li>
<li>And the output of this transition probability model is one of the input features to their logistic regression that's computed.</li>
<li>That's estimating. Would you like to see this job ad for a senior data scientist in Salt Lake City?</li>
<li>Also, you also get things where you might have might come from some kind of a deep learning thing,</li>
<li>a deep learning object detection mechanism, a deep learning image similarity mechanism.</li>
<li>So Pinterest gets a lot of mileage out of doing nearest neighbor calculations where the the neighbor nearest</li>
<li>is defined by a deep learning model for assessing whether two images that are being pinned or similar.</li>
<li>So we can there are many different models that we can look at.</li>
<li>Linear models with their extensions, a generalized linear model and the logistic regression that we've been seeing, generalized adaptive models.</li>
<li>There's also thing the support vector machine, which is another linear model, but it's not a regression model.</li>
<li>The naive, naive Bayes classifier, we're going to see those later, a neural net.</li>
<li>Whether shallow or deep, a lot of models, pretty like a lot of neural nets.</li>
<li>They do a similar thing in logistic regression. They're computing a score and then you pass it through a logistic function or some other sigmoid in</li>
<li>order to convert the model score to probabilities for making your final classification decisions.</li>
<li>So wrap up. There are many different models for classification and for regression.</li>
<li>I'm just the my goal in this class is to teach you what regression and</li>
<li>classification are and how to get started with applying them and evaluating them,</li>
<li>not to teach you a bunch of models in depth.</li>
<li>The machine learning class is going to go into a lot more about how these different models work and how to get them to work.</li>
<li>Well, model outputs also, though, can be features used as input features for other models, often linear.</li>
<li>Not always, though. And so you can get models that build on top of other models.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="inference-and-ablation">
<h2>🎥 Inference and Ablation<a class="headerlink" href="#inference-and-ablation" title="Permalink to this headline">¶</a></h2>
<p>How do we understand, <em>robustly</em>, the performance of our system?
What contributes to its performance?</p>
<div class="resource video docutils container" id="589628b2-30ce-4c38-ba45-ac66003f5163">
<div class="tabbed-set docutils">
<input checked="checked" id="67f35df5-d8cf-4a1a-9d38-b55ae2fe6d3e" name="520afd7a-c0e9-41d7-8f9e-0241fab9477b" type="radio">
</input><label class="tabbed-label" for="67f35df5-d8cf-4a1a-9d38-b55ae2fe6d3e">
Video (14m55s)</label><div class="tabbed-content player docutils">
<div class="video-container video-embed">
<iframe src="https://boisestate.hosted.panopto.com/Panopto/Pages/Embed.aspx?id=589628b2-30ce-4c38-ba45-ac66003f5163&autoplay=false&offerviewer=true&showtitle=true&showbrand=false&start=0&interactivity=all" height="405" width="720" style="border: 1px solid #464646;" allowfullscreen allow="autoplay"></iframe>
</div></div>
<input id="936921b0-f39f-4f6f-897f-63a3bd312931" name="520afd7a-c0e9-41d7-8f9e-0241fab9477b" type="radio">
</input><label class="tabbed-label" for="936921b0-f39f-4f6f-897f-63a3bd312931">
Slides</label><div class="tabbed-content slides docutils">
<div class=slide-container data-id="495979F9A431DDB0%2173331" data-key=%21AAlNEpWRX05DM90>
</div></div>
</div>
<div class="slides text hidden docutils">
CS 533INTRO TO DATA SCIENCE
Michael Ekstrand
INFERENCE AND ABLATION
Learning Outcomes
Make inferences about model accuracy
Understand interplay of cross-validation and inference
Use ablation studies to make inferences about feature or sub-model importance
Photo by Siora Photography on Unsplash
Train/Test Split
The Data
Training Data
Testing Data
One Way
Train model
Experiment with different model designs
Experiment with different features
Select hyperparameters
Evaluate Effectiveness

Significant?
Testing Effectiveness
For test data, we have:
Individual classifications, right or wrong
Single metric value (accuracy, precision, etc.) for each classifier

Can’t significance test a single value!



Testing Objectives
Does my classifier perform better than benchmark value?
What is the precision of my estimated classifier accuracy?
Confidence interval
Does classifier A perform better than B?
P-value
Confidence interval for the difference
Test Samples: Confidence Intervals
Solution 1: treat each test item as a binary measurement

If metric denominator from test data: Wilcox confidence interval
statsmodels: proportion_confint (with method=‘wilson’)
Works for accuracy, FPR, FNR, recall, specificity

Any metric:
Bootstrap the test samples
Compute metric from bootstrap samples
P-Value for Accuracy
Testing Regression
For regression, each sample is a continuous measurement of the model’s prediction error.

Use paired t-test or appropriate bootstrap
Repeated Testing
With repeated cross-validation, we can compute a t-statistic
Run 5 times
Each time, do 2-fold cross-validation

See reading.

Simple cross-validation not great– too much non-independence
Repeated test sampling unreliable – too much non-independence
Cross-Validation and Train/Test Split
Cross-validation sometimes used for final eval

Allows data leakage – what did you do your model &amp; feature selection on?

Good for:
Limited engineering – just see how well the model works
Model and feature design – when done on training data
Understanding Performance &amp; Behavior
Suppose you are detecting spam with:
Text features
Metadata features
URL features
URL reputation model
Sender reputation model

What makes it work?
Ablation Studies
An ablation study examines impact of individual components
Turn each off in turn
Measure classification performance

Lets you see how much each component contributes
Do use results for production decisions, future work
Do not use results to revisit model design (in this trial)
Wrapping Up
Inference for classifier performance is not immediately straightforward.

Several techniques helpful.

Be careful about data leakage. Sometimes tradeoffs are needed.
Photo by Bianca Ackermann on Unsplash
</div>
<div class="captions text hidden docutils">
<ul class="simple">
<li>Oh, in this video, I want to talk with you about inference from auto effectiveness and introduced the idea of an inflation study.</li>
<li>So our goals are for you to be able to make inferences about model accuracy and underpin</li>
<li>understand a little bit better the interplay of cross validation and inference,</li>
<li>remembering that we can't be perfect. The goal is to do a good and an incredible job.</li>
<li>And then also to be able to use an ablation study to make inferences about the particular</li>
<li>contributions and value of different features or subsets of your subcomponents of your model.</li>
<li>So remember, we've got this train test split training.</li>
<li>We have the training data. We're doing all of our iterative process.</li>
<li>It's a big, loopy thing. And then we've got we evaluate our effectiveness.</li>
<li>One thing we haven't talked about yet is, is the is the effectiveness significant?</li>
<li>To go and wait for our test data, we have a few outputs.</li>
<li>We have the individual classifications of predictions and four classifications we have, whether they're right or wrong for predictions,</li>
<li>we have the error and then we have a metric value, accuracy, precision, etc. for each classifier.</li>
<li>One of the challenges is, though, for the classifier and the test data, we just have accuracy is point nine nine or precision is point four.</li>
<li>We can't significance test that value.</li>
<li>But I want to talk in order to set up how we can significance test, I'm first going to or otherwise do inference, I should say, because significant,</li>
<li>significant testing, as we discussed earlier, a lot of times we might actually care about like an effect size estimate with confidence intervals.</li>
<li>A lot more than we care about significance test.</li>
<li>But there's a few questions that we want to answer as the results of an evaluation. What does my classifier perform better than some benchmark value?</li>
<li>Well, you might have a value we want to beat, say, a value we know was good enough.</li>
<li>And we want to know if my classifier performs better than that value.</li>
<li>We might want to get an estimate of our classifiers, accuracy or precision or recall our pick our metric that has a confidence interval on it.</li>
<li>So we know how precise ice this estimated performance measure is.</li>
<li>And then we may also want to answer the question, is classifier A perform better than B?</li>
<li>Maybe B is our current system, or B is the existing known state of the art.</li>
<li>And we want to know if A does better. We might want to p value.</li>
<li>We might want a confidence interval for the improvement or the difference in performance between A and B.</li>
<li>So. To get started one way, we can compute a confidence interval.</li>
<li>We can treat each item as a binary measurement. So you are each test item.</li>
<li>So you've got hundred thousand test items because you've got a very large dataset.</li>
<li>And hundred thousand to 20 percent split. Or it's a 10 percent split.</li>
<li>You've got a million data points, one 100000 test points for each of these.</li>
<li>You have the true value. Yes or no. You have prediction. Yes or no.</li>
<li>If the metric denominator comes from the test data accuracy, it definitely does, because the denominate because accuracy is correct overall.</li>
<li>You can also do this for false positive ratio, false negative ratio.</li>
<li>Recall specificity, anything where the denominator is completely determined by the test data, not by the classifier results.</li>
<li>You can use a Willcocks confit or a Wilson confidence interval.</li>
<li>Stats models does this with proportion confident and a Wilson confidence interval is a confidence interval for a proportion.</li>
<li>Any metric you can bootstrap that you can take your to your test samples, you can do.</li>
<li>You can take bootstrap samples of them and then you can compute your classifier metric over your bootstrap samples.</li>
<li>Now, you have to be careful when you're doing your bootstrap samples to make sure that</li>
<li>when you're sample you're when you're doing the bootstrap and you keep the labels, the ground truth labels and the classifier outputs together.</li>
<li>And if you're doing multiple classifiers, you have to keep all the classifier outputs together as you're computing these bootstrap samples.</li>
<li>You can bootstrap from your test data and get a confidence interval for any of your classifier performance metrics.</li>
<li>You can also do a computer P-value for the accuracy metric. This specific technique only works for accuracy.</li>
<li>It does not work for any of our other classifier metrics. But you can get a P value for the null hypothesis that the two classifiers have the same</li>
<li>accuracy by using what's called a contingency table and a contingency table for this purpose.</li>
<li>You have you go from reclassifications to whether or not it was right or wrong.</li>
<li>So. Here we have the number of times both classifiers were right in here, the number of times they were both wrong.</li>
<li>And here we have where classifier one was right and classifier two was wrong.</li>
<li>How often did that happen? We can do the same the other way around.</li>
<li>And then we compute. What we do what's called a McNee ma test, and it uses these values and NY n is the value and one is wrong.</li>
<li>And two is right. And then why is. One excuse excuse me.</li>
<li>And this is. So here we have an.</li>
<li>And why? And here we have. And why an.</li>
<li>And so we take the squared difference and the their wrongness is and divide it by the sum of their wrongness is and this gives us a statistic.</li>
<li>And my test statistic and under H zero under the null hypothesis and follows what's called</li>
<li>a chi squared distribution with one degree of freedom to probability distribution,</li>
<li>you can get CGF from stat's models or from sci fi.</li>
<li>And you can use that to compute a P value. What's the probability of having an MS statistic, at least this large?</li>
<li>And it's it's you don't have to deal with absolute values on it because it's it's a non-negative statistic in a non-negative distribution.</li>
<li>We can't just. There is something called a proportion test, but proportion test is for independent proportions and independent samples.</li>
<li>But we don't have independent samples. We have one sample of our test data.</li>
<li>And for each test point, we have two measurements, class of a classifier one and classifier two.</li>
<li>So we can't use a proportion test.</li>
<li>But the Mackney MA test basically that says do this paired proportion test kind of thing and allows us to get a P value for whether this classifier,</li>
<li>whether the classifiers have the same accuracy or not.</li>
<li>And this one, the P value, does not allow us to reject the null hypothesis that they have the same accuracy.</li>
<li>The P value is about one. So.</li>
<li>We can also test regression. So each sample is a continuous measurement of the model's prediction error.</li>
<li>So we have Y minus Y hat Y.</li>
<li>I from C one for CROSSFIRE a. And we have Y minus Y.</li>
<li>Hat I. From Classifier B. And those are two different measurements,</li>
<li>we can use a paired t test or we can use an appropriate bootstrapping mechanism in order to assess the accuracy of a regression model.</li>
<li>Now, when we have when we do a cross validation, so one technique, the sun, sometimes you do cross validation, say 10 tenfold cross validation.</li>
<li>That gives you 10 accuracy's for each classifier and you can compute paired t test.</li>
<li>So each of your each of your folds and your cross validation is a sample.</li>
<li>Is one data point in your sample. So you've got N equals 10.</li>
<li>You can do a T test that actually doesn't work very well because your your samples are not independent.</li>
<li>If you're doing capable cross validation.</li>
<li>Also if you just repeatedly draw a 10 percent sample and draw a 10 percent sample and do that, say, 30 times,</li>
<li>you also have the same problem of the same data points are going to show up and you're sent to monitor your samples.</li>
<li>Also, your training data classifiers are being trained in the same data too much.</li>
<li>And the ideal is to be able to draw, say, 30 completely independent training and testing sets from your big population.</li>
<li>But yeah, but if you can't do that, you're trying to simulate with cross validation,</li>
<li>you wind up with the non independence just causes the resulting come statistical test to not be reliable.</li>
<li>One thing you can do is you can do repeated cross validation where five times you do a two fold cross validation.</li>
<li>I'm going to refer you to one of the readings I put in the notes for a lot more details on this.</li>
<li>Just wanted to bring it up so that, you know, it's there. Cross-validation is sometimes used for final evaluation.</li>
<li>You'll find this in papers sometimes.</li>
<li>One of the problems, though, is this allows data leakage because you're testing on data that was available and you're trying it.</li>
<li>You're testing on all of the data data that was available in your training set.</li>
<li>This is a this can be a significant problem if we've got a large enough data</li>
<li>set that we can just use a single test split or maybe two or three test split.</li>
<li>That's going to allow us to much better simulate to avoid leakage, much better simulate what's going to happen.</li>
<li>We put the model in production. Cross validation is really useful for a couple of contexts.</li>
<li>One where you're not doing much model design or feature engineering. You just want to take you have data.</li>
<li>Want to take a model. Apply it, see how it works. Cross-validation is great for that.</li>
<li>You're not. You don't have the iterative process of how am I really getting this model to work?</li>
<li>You can cross validate if you've got hyper parameter search,</li>
<li>do a hyper parameter search separately for each needful, like make it part of your training process.</li>
<li>Logit like that logistic regression c.v kinds of things. Help with that.</li>
<li>But if you've got a model and just want to see how well it works in the data, cross-validation can work pretty well.</li>
<li>Also with when you are doing cross-validation on the training data to iteratively, do improve your model and feature design.</li>
<li>That can work really, really well as well. The problem arises when you're doing a lot of engineering on your model.</li>
<li>And you get access to the test data, which you effectively have on a cross validation setup.</li>
<li>Because even if you've got it's your say you do 10 cross-validation, do you pick one of them that's gonna be your.</li>
<li>That's gonna be what you're really doing, your development? Well, all of your other test data is in this.</li>
<li>This initial development part.</li>
<li>So it's part of how you're effectively you're using the test data as part of your tuning process for your hyper parameter selection,</li>
<li>as part of your exploratory data analysis. And that that is a cause of leakage.</li>
<li>Again, though, I guess. We're can never be perfect, but it's important to be aware of as a cause of leakage.</li>
<li>I really recommend having the designated test set that you hold out.</li>
<li>You don't touch. That's the basis of your evaluation. Even if it makes the statistical inference a little bit harder.</li>
<li>Now, another thing, though, I want to talk about is suppose.</li>
<li>So let's suppose you've got a complex model and we've got we're detecting spam where we're working for, say, a.</li>
<li>Telecommunications company were detecting text message spam or were detecting an e-mail spam for any mail company.</li>
<li>We have text features. We've got made a day to features when they're sending you are else.</li>
<li>You've got features of the you are all itself. Maybe we even hit the server.</li>
<li>Let's say we've got another couple of sophisticated models that do that score.</li>
<li>You are else by their reputation and they're sent and also score senders by theirs,</li>
<li>by a reputation score that large e-mail search spam, antispam efforts such as the one built in the GMAT.</li>
<li>I'll do this. I'm not just making that up. It's a part of of antispam at scale is building reputations for you are else and centers.</li>
<li>And we've got let's say art, let's say our spam detector works well. Precision of ninety nine point five or ninety nine point nine.</li>
<li>Recall of 80 percent. But what makes it work?</li>
<li>Which of these features is contributing, how much to its success?</li>
<li>The answer is to do what's called an oblation study and an oblation study takes our model.</li>
<li>We take our whole model. We see how accurate it is, but then we turn off individual features of it.</li>
<li>So we might turn off the sender reputation. How what how exactly you turn off depends on the model design.</li>
<li>It might be if it's an honor. You just take that part out of your neuron, that graph syllogistic model, you know, everything's well standardized.</li>
<li>You can put it zeroes for the feature and not retrain or even just take that term out of the model,</li>
<li>trying to on your training data and try to predict your testing data. And what this lets you see and you probably want to do that just in case.</li>
<li>Just to make sure the parameters are being tuned without the peace. What does that seat you see, though, is how much each component contributes?</li>
<li>You can say, OK, my model gets ninety nine percent precision on spams and it gets 98 percent precision if I turn off the sender reputation.</li>
<li>Well, that lets you see, OK, the sender reputation is responsible for one percent of my precision.</li>
<li>Now, it's important to be careful how you use this, because you can use this for production decisions and for future work.</li>
<li>You do this oblation study, you discover, OK, the center reputations only contributing 98 or one percent,</li>
<li>or maybe it's contributing point one percent. And it's really expensive in terms of compute time and engineer time to maintain maybe stop using it.</li>
<li>You could also use it for your future research work. What you can't do, particularly within the scope of one study,</li>
<li>is use the results of your oblation study to go back and revisit your model design that gets you your leakage again.</li>
<li>As again, as I said in the academic setting,</li>
<li>we're doing multiple studies in the same data that we do get some leakage and we carry it forward to the next study.</li>
<li>We again, we can't be perfect, but.</li>
<li>There's a difference between the oblation study and the feature engineering, the feature engineering, I'm trying a bunch of things that keep things.</li>
<li>I'm not going to keep things up doing it with this tuning data. Things are going back. I'm not being keeping my careful firewalls.</li>
<li>In the oblation study, I have my top line performance monitor. Here's my model, I ran it.</li>
<li>It got 99 percent precision and then. I'm trying to understand.</li>
<li>Well, what are the drivers of that? I'm not putting it iteratively back into my life.</li>
<li>Going back and rerunning my my stuff in my training data with it, I'm just using it to get knowledge to carry forward.</li>
<li>That doesn't cause leakage within the context of the specific study we're talking about.</li>
<li>And it is of acceptable practice.</li>
<li>And it's a very, very useful practice for understanding the contributing factors to the performance of a complex model.</li>
<li>So wrap up inference for classified performance is not immediately straightforward.</li>
<li>There are several helpful techniques that pointed you here at pointing to you two in the readings and be careful about data leakage.</li>
<li>But again, sometimes tradeoffs are.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="statistical-significance-tests">
<h2>📃 Statistical Significance Tests<a class="headerlink" href="#statistical-significance-tests" title="Permalink to this headline">¶</a></h2>
<p id="reading-Statistical-Significance-Tests-for-Comparing-Machine-Learning-Algorithms">Read <a class="reference external" href="https://machinelearningmastery.com/statistical-significance-tests-for-comparing-machine-learning-algorithms/">Statistical Significance Tests for Comparing Machine Learning Algorithms</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the Week 9 activity, we used the paired <em>t</em>-test for comparing the output of two regression models.
Our use of this test did <strong>not</strong> violate the guidance in this reading — why is that?</p>
</div>
<p>For further reading, you can also see <a class="reference external" href="http://dx.doi.org/10.1162/089976698300017197">Approximate Statistical Tests</a>.</p>
</div>
<div class="section" id="dates">
<h2>🎥 Dates<a class="headerlink" href="#dates" title="Permalink to this headline">¶</a></h2>
<p>This video discusses how to use work with dates in Pandas.</p>
<div class="resource video docutils container" id="db1dc799-8ed1-4a7b-960e-ac69001a590d">
<div class="tabbed-set docutils">
<input checked="checked" id="473fcc41-676a-4008-97f4-878935589c2a" name="429149ac-5bc0-49a0-b8b5-fb78c5a240dc" type="radio">
</input><label class="tabbed-label" for="473fcc41-676a-4008-97f4-878935589c2a">
Video (8m34s)</label><div class="tabbed-content player docutils">
<div class="video-container video-embed">
<iframe src="https://boisestate.hosted.panopto.com/Panopto/Pages/Embed.aspx?id=db1dc799-8ed1-4a7b-960e-ac69001a590d&autoplay=false&offerviewer=true&showtitle=true&showbrand=false&start=0&interactivity=all" height="405" width="720" style="border: 1px solid #464646;" allowfullscreen allow="autoplay"></iframe>
</div></div>
<input id="0af02c26-6a74-4570-89d2-8045bb443876" name="429149ac-5bc0-49a0-b8b5-fb78c5a240dc" type="radio">
</input><label class="tabbed-label" for="0af02c26-6a74-4570-89d2-8045bb443876">
Slides</label><div class="tabbed-content slides docutils">
<div class=slide-container data-id="495979F9A431DDB0%2173338" data-key=ALt4_zuupKaPObs>
</div></div>
</div>
<div class="slides text hidden docutils">
CS 533INTRO TO DATA SCIENCE
Michael Ekstrand
DATES
Learning Outcomes
Parse and transform dates
Adjust dates using date offsets
Photo by J. on Unsplash
Dates and Representations
Time moves forward at a constant rate (generally…)
How we record it changes
Daylight savings time – the same hour happens twice

Key insight: time is different from representation
Typically: store time in monotonic form, translate for presentation
Numeric Representations
Unix timestamps — time since (or before) midnight Jan 1, 1970
Seconds, milliseconds, nanoseconds
Reference point is UTC
Julian day numbers
Days since January 1, 4713 BC
Floating point stores time as fraction of a day
“1900 system” (Excel): days since Jan. 1, 1900
String Representations
ISO: 2020-11-03
Alphabetic sorts by date (for AD, until 10000)
Localized numeric
US: 11/03/2020
EU: 03/11/2020
Longer
November 3, 2020
datetime64
The Pandas datetime64 type stores dates (and times).
Construct from:
Number, units, and epoch
pd.to_datetime(230481083, unit='s') — seconds since Unix epoch
pd.to_datetime(3810401, unit='D', origin='julian') — days since Julian epoch
String and format
pd.to_datetime('2020-11-03') — convert from ISO
pd.to_datetime('Nov 3 2020', format='%b %d %Y')
timedelta
The Pandas timedelta type stores time offsets
Create from number + units or string
‘1 day 00:30:22’ – one day, 30 minutes, and 22 seconds
Mark advances in linear time
DateOffset
DateOffset type stores date offsets to adjust calendar days
Create from number + units
pd.DateOffset(months=240)
Correctly offset dates, even with underlying nonlinearities
Months don’t have the same length
DST, leap years, leap seconds
Not directly supported by Series
Can use in ‘apply’:month_series.apply(lambda m: pd.DateOffset(months=m))
Date Arithmetic
datetime + timedelta = datetime
datetime + DateOffset = datetime
DateOffset * num = DateOffset
Comparisons
DateTime supports comparison operators (==, &lt;, etc.)
Need to create DateTimes on both sides
Wrapping Up
Dates and times are typically stored internally using offsets from an origin.

Pandas provides several date and time features, including datetime, timedelta, and DateOffset.
Photo by Bundo Kim on Unsplash
</div>
<div class="captions text hidden docutils">
<ul class="simple">
<li>So in this video, I want to talk with you about dates,</li>
<li>learning outcomes are for you to be able to pass and transform dates and adjust dates using date offsets.</li>
<li>So first, I want to talk just briefly about the difference between a date as we say it, like.</li>
<li>OK. It's November the 3rd, 2020 and underlying time.</li>
<li>So dates to all kinds of funny things. When we change to or from Daylight Savings Time, we skip an hour or we repeat an hour.</li>
<li>But the underlying time stream doesn't repeat.</li>
<li>It's just that our way of mapping that to the way we write it down repeats.</li>
<li>So we can think of underlying time as moving forward at a constant rate.</li>
<li>Generally, there's relativity and all of those things.</li>
<li>But the time is moving forward and how we record it changes and is complex and subject to a lot of rules.</li>
<li>The key thing is like with text being different, like the text content is different from its encoding.</li>
<li>Time is different from its representation.</li>
<li>Well, one of the implications this says, is that we typically store time in more of its monotonic form, like seconds since a particular date, UTC.</li>
<li>And then we translate for presentation. And so you'll see your store the time it offset UTC and then you will you'll translate</li>
<li>that to the local time zone with all of the daylight savings rules and everything,</li>
<li>we are going to go actually display it.</li>
<li>So internally, there are a few ways we can represent time numerically, and sometimes you'll need to do this yourself.</li>
<li>So one one is Unix timestamps, which is time since or before that can be negative.</li>
<li>Midnight, UTC, January 1st, 1970. Often this is stored in seconds.</li>
<li>Pythons like not in pandas or not pie, but Python, the Pathfinder standard library tends to do time and second floating point seconds since midnight.</li>
<li>The reference point, as I said, the reference point for this is UTC. You can also store at milliseconds or nanoseconds since that time.</li>
<li>If you have a data, if you have a data file that has a file, a column that's labeled as a timestamp and it's an end.</li>
<li>It's a number. There's a very good chance it's a Unix timestamp. That's very common way to store dates and times.</li>
<li>We can also store Julian Day numbers, which are days since January 1st.</li>
<li>Forty seven 13 B.C. And you can you you can store a time by using a floating point numbers,</li>
<li>it might be twenty two million, three hundred and seventy five point eight days.</li>
<li>There's also other origins. You can use a lot of different origins. Pandas actually lets you specify arbitrary origins.</li>
<li>But the nineteen hundred system that's used by Excel and other spreadsheets stores days since January 1st.</li>
<li>Nineteen hundred. So we can also store data strings, so the ISO format is year, month, day.</li>
<li>This has the nice advantage that at least until the year ten thousand.</li>
<li>It sorts by date. If you sorted Alphabet Alpha numerically, it's it's going to sort the resulting dates by date.</li>
<li>So if you're going to name files after dates, this with dates at the beginning of the file name.</li>
<li>This is super useful.</li>
<li>There's also localized numeric forms such as eleven three, twenty twenty, which is how we write the dates in the United States, Europe and the UK.</li>
<li>Right. Generally right at day, month, year three. Eleven, twenty, twenty.</li>
<li>So if you see a date that's two digits, two digits year, that's not enough information to know when we're talking about.</li>
<li>Are we talking about November 3rd or are we talking about March 11th?</li>
<li>You need to know the country locale in which the date came from to know how to correctly interpret it.</li>
<li>Sometimes you can infer it by looking for, say, November twenty eighth,</li>
<li>because 28 isn't a valid month number that I'll let you figure out which one you're dealing with.</li>
<li>But this localized form, just if you get a date, it's often ambiguous.</li>
<li>You could also have longer string forms like you did right out November 3rd.</li>
<li>Twenty Twenty Panels provides a function called Date Time 64 that allows you to store dates and times.</li>
<li>And even if you just have a date, you usually store it. It's a date time with midnight.</li>
<li>At least that's how you work with it. And pan those pandas doesn't have a time free date type.</li>
<li>You can create a date time from number and units as an origin.</li>
<li>So you can say we want. We want two hundred and thirty million.</li>
<li>Seconds since the Unix epoch, we want three point eight million second days since the Julian Origin D Funk.</li>
<li>This function also supports the number can be a series or an array in addition to a single numbers.</li>
<li>You can create a series or an array of pand date time objects.</li>
<li>You can also convert it from a string. This also can be up a series or array of strings.</li>
<li>So in an assignment, if you've got it, if you've got a column that string dates,</li>
<li>you can convert that to a column of date times by using these functions.</li>
<li>And by default, it's going to pass the time for my S.O.</li>
<li>But you can also tell it to pass other time, but providing a format string that describes how the time is laid out.</li>
<li>And there's a link in the pandas documentation to the way these format strings work can also be provided.</li>
<li>That link in the notes that go with this video. Then so we've got daytime's pandas has also had an object called a Time Delta,</li>
<li>which stores of a difference between two times, if you subtract one date time from another,</li>
<li>what you're going to get as a time delta,</li>
<li>you can create one from a number of plus units or a string that describes that like I can create the the the time delta one day,</li>
<li>thirty minutes and twenty two seconds. The time Delta marks advances in linear times.</li>
<li>You can't create a time delta for example, of one month. The date offset is what you use to get one month.</li>
<li>So it's you can create it from a number and units and it correctly offsets the dates,</li>
<li>even if you it knows it can know whether it needs to extend by 30 days or thirty one or twenty eight.</li>
<li>It handles Daylight Savings Time, a Hannahs leap year, a handle's leap seconds and deals with being able to offset dates properly.</li>
<li>Date Offset does not natively support series, so date times and time deltas, both native pandas natively supports them in series.</li>
<li>You can't, however, create a series of an object series that contains data offsets.</li>
<li>So if Month series is a series of numeric series that contains numbers of months, then we can use apply.</li>
<li>And it's it's it's a little slow because it's doing a python loop effectively.</li>
<li>But we can use apply to convert these data, offset these numbers of month into data, offset objects.</li>
<li>We get a series of those which we can then say add to add to a series of date times in order to produce offset date times.</li>
<li>For example, to add if we've got a column that has the term the number of months on loan is for and when the loan was issued,</li>
<li>we can add we can convert the month to a date offset. Add it to the issue date and we can find when the loan is due.</li>
<li>When you're doing arithmetic with dates, if you add a date time and the time Delta,</li>
<li>you're going to get a date time, date time plus a tight offset is also a date time. You could subtract as well as add.</li>
<li>As I said, if you subtract two date times, you're gonna get a time Delta.</li>
<li>You can also multiply a date offset by a number and it's going to give you another date offset that's multiplied.</li>
<li>So you can if you've got two months, you can multiply it by five and you'll get 10 months.</li>
<li>You can also compare you can compare date times using comparison operators.</li>
<li>You do need to create date times on both sides. If you've got something that say strings, you need to convert it to a date time object.</li>
<li>So then you can do the comparison. So in conclusion, dates and times are typically stored internally using offsets from an origin.</li>
<li>Usually store. Usually we store them in UTC and then we translate them to local time.</li>
<li>When we go on display. PANDAS provides a number of functions and types for working with dates and times.</li>
<li>In addition, NUM Pi provides some of its own. I generally work with pandas, but not PI does provide time.</li>
<li>Delta date time objects at work just a little bit differently. Python also does it its standard library for our purposes.</li>
<li>I recommend generally sticking with the pandas ones.</li>
</ul>
</div>
</div>
<div class="section" id="links">
<h3>Links<a class="headerlink" href="#links" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><span class="xref myst">Date operations notebook</span></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html">Pandas time series / date functionality</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timedeltas.html">Pandas time deltas</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/offset_frequency.html">DateOffset</a></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior">Format codes</a></p></li>
</ul>
</div>
</div>
<div class="section" id="quiz-11">
<h2>🚩 Quiz 11<a class="headerlink" href="#quiz-11" title="Permalink to this headline">¶</a></h2>
<p>Quiz 11 is in Canvas.</p>
</div>
<div class="section" id="assignment-5">
<h2>📩 Assignment 5<a class="headerlink" href="#assignment-5" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../assignments/A5/"><span class="doc std std-doc">Assignment 5</span></a> is due <strong>November 7</strong>.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./week11"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../week10/" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Week 10 — Classification (10/25–29)</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../week12/" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Week 12 — Text (11/8–12)</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Michael D. Ekstrand<br/>
        
            &copy; <a href="../copyright/">Copyright</a> 2021.<br/>
          <div class="extra_footer">
            <script data-goatcounter="https://cs533.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>